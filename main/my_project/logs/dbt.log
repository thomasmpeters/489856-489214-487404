

============================== 2023-04-07 17:21:40.322889 | 1bce9a7a-c95e-4b31-9d7f-ee3432b0d1b5 ==============================
[0m17:21:40.322889 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:21:40.324932 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m17:21:40.325327 [debug] [MainThread]: Tracking: tracking
[0m17:21:40.352744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62a69d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62a6a1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62a69de90>]}
[0m17:21:40.488496 [debug] [MainThread]: Executing "git --help"
[0m17:21:40.523140 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:21:40.524454 [debug] [MainThread]: STDERR: "b''"
[0m17:21:40.536734 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:21:40.537603 [debug] [MainThread]: Using postgres connection "debug"
[0m17:21:40.538066 [debug] [MainThread]: On debug: select 1 as id
[0m17:21:40.538777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:40.628152 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "commodities2" does not exist

[0m17:21:40.637128 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m17:21:40.637547 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:21:40.637978 [debug] [MainThread]: On debug: No close available on handle
[0m17:21:40.638982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62a7bc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62a7bc990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62a757850>]}
[0m17:21:40.639713 [debug] [MainThread]: Flushing usage events
[0m17:21:41.317816 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-04-07 17:23:09.150816 | 7e9142e8-0eed-4713-ae7e-7c6973edbbc9 ==============================
[0m17:23:09.150816 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:23:09.152996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m17:23:09.153467 [debug] [MainThread]: Tracking: tracking
[0m17:23:09.182145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4eef5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4c654850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4eef5b50>]}
[0m17:23:09.314926 [debug] [MainThread]: Executing "git --help"
[0m17:23:09.343523 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:23:09.344362 [debug] [MainThread]: STDERR: "b''"
[0m17:23:09.352534 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:23:09.353832 [debug] [MainThread]: Using postgres connection "debug"
[0m17:23:09.354457 [debug] [MainThread]: On debug: select 1 as id
[0m17:23:09.354930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:09.416225 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:23:09.418096 [debug] [MainThread]: On debug: Close
[0m17:23:09.419060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4f007810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4f007d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf4f007f10>]}
[0m17:23:09.419759 [debug] [MainThread]: Flushing usage events
[0m17:23:09.850186 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-04-07 17:24:05.503154 | 30ea90bc-06b2-4fa0-9544-48f19d501869 ==============================
[0m17:24:05.503154 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:24:05.505064 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m17:24:05.505517 [debug] [MainThread]: Tracking: tracking
[0m17:24:05.527851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a7cfb5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a7cfb5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a7cfb5d10>]}
[0m17:24:05.650173 [debug] [MainThread]: Executing "git --help"
[0m17:24:05.671564 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:24:05.672437 [debug] [MainThread]: STDERR: "b''"
[0m17:24:05.680794 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:24:05.681865 [debug] [MainThread]: Using postgres connection "debug"
[0m17:24:05.682556 [debug] [MainThread]: On debug: select 1 as id
[0m17:24:05.683612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:05.740293 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:24:05.742030 [debug] [MainThread]: On debug: Close
[0m17:24:05.742765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a7cfb9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a7d07c5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a7d0e1050>]}
[0m17:24:05.743704 [debug] [MainThread]: Flushing usage events
[0m17:24:05.974147 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-04-07 17:24:19.312613 | e80001a1-51be-4ef4-bbd5-7b0569248d99 ==============================
[0m17:24:19.312613 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:24:19.316038 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:24:19.316511 [debug] [MainThread]: Tracking: tracking
[0m17:24:19.339358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae04fe0510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae04c3f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae04fe07d0>]}
[0m17:24:19.358961 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:24:19.359967 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:24:19.360667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e80001a1-51be-4ef4-bbd5-7b0569248d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae04ff7fd0>]}
[0m17:24:20.315899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m17:24:20.324447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e80001a1-51be-4ef4-bbd5-7b0569248d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0504dd50>]}
[0m17:24:20.333756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e80001a1-51be-4ef4-bbd5-7b0569248d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae04fb7690>]}
[0m17:24:20.334462 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:24:20.335592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e80001a1-51be-4ef4-bbd5-7b0569248d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae04fb7690>]}
[0m17:24:20.337637 [info ] [MainThread]: 
[0m17:24:20.338834 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:24:20.339726 [debug] [MainThread]: Command end result
[0m17:24:20.346441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae04fbc150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae049d6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0504d450>]}
[0m17:24:20.346992 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 17:25:30.268191 | 26769c90-359b-4c2a-b897-9716bdfb4492 ==============================
[0m17:25:30.268191 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:25:30.270817 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:25:30.271336 [debug] [MainThread]: Tracking: tracking
[0m17:25:30.298132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20090d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20090db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20090d8d0>]}
[0m17:25:30.316641 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:25:30.380185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:25:30.380906 [debug] [MainThread]: Partial parsing: added file: my_project://models/model1.sql
[0m17:25:30.403293 [debug] [MainThread]: 1699: static parser successfully parsed model1.sql
[0m17:25:30.428790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m17:25:30.443875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26769c90-359b-4c2a-b897-9716bdfb4492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20095d850>]}
[0m17:25:30.451640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26769c90-359b-4c2a-b897-9716bdfb4492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa200988a50>]}
[0m17:25:30.452193 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:25:30.452773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26769c90-359b-4c2a-b897-9716bdfb4492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa200988b50>]}
[0m17:25:30.455318 [info ] [MainThread]: 
[0m17:25:30.458222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:30.460410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:25:30.477856 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:25:30.478483 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:25:30.479256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:30.551861 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m17:25:30.553932 [debug] [ThreadPool]: On list_postgres: Close
[0m17:25:30.555407 [debug] [ThreadPool]: Acquiring new postgres connection 'create_postgres_dbt'
[0m17:25:30.556499 [debug] [ThreadPool]: Acquiring new postgres connection 'create_postgres_dbt'
[0m17:25:30.557201 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='postgres', schema='dbt', identifier=None)"
[0m17:25:30.565743 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbt"
[0m17:25:30.566335 [debug] [ThreadPool]: On create_postgres_dbt: BEGIN
[0m17:25:30.566689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:30.577289 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:25:30.577782 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbt"
[0m17:25:30.578120 [debug] [ThreadPool]: On create_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "create_postgres_dbt"} */
create schema if not exists "dbt"
[0m17:25:30.588911 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0 seconds
[0m17:25:30.590354 [debug] [ThreadPool]: On create_postgres_dbt: COMMIT
[0m17:25:30.590815 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbt"
[0m17:25:30.591161 [debug] [ThreadPool]: On create_postgres_dbt: COMMIT
[0m17:25:30.593086 [debug] [ThreadPool]: SQL status: COMMIT in 0 seconds
[0m17:25:30.593558 [debug] [ThreadPool]: On create_postgres_dbt: Close
[0m17:25:30.595569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:25:30.604675 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:25:30.605121 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:25:30.605492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:30.615029 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:25:30.615599 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:25:30.615997 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:25:30.636946 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m17:25:30.638673 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:25:30.639427 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:25:30.644904 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:30.645304 [debug] [MainThread]: On master: BEGIN
[0m17:25:30.645622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:30.654316 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:25:30.654844 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:30.655208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:25:30.675019 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m17:25:30.676989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26769c90-359b-4c2a-b897-9716bdfb4492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2008f73d0>]}
[0m17:25:30.677838 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:30.678852 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:30.679343 [debug] [MainThread]: On master: BEGIN
[0m17:25:30.680079 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:25:30.680538 [debug] [MainThread]: On master: COMMIT
[0m17:25:30.680926 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:30.681251 [debug] [MainThread]: On master: COMMIT
[0m17:25:30.681829 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:25:30.682203 [debug] [MainThread]: On master: Close
[0m17:25:30.682975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:30.683506 [info ] [MainThread]: 
[0m17:25:30.686432 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m17:25:30.687036 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.model1 ......................................... [RUN]
[0m17:25:30.688084 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m17:25:30.688552 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m17:25:30.690544 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m17:25:30.692101 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 17:25:30.688851 => 2023-04-07 17:25:30.691905
[0m17:25:30.692901 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m17:25:30.753503 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m17:25:30.754495 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:25:30.754832 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m17:25:30.755099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:30.765789 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:25:30.766196 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:25:30.766532 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m17:25:30.779925 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:25:30.789290 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:25:30.789722 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m17:25:30.791769 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:25:30.815388 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m17:25:30.815837 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:25:30.816170 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m17:25:30.817294 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:25:30.824274 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:25:30.824698 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m17:25:30.826604 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:25:30.828413 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 17:25:30.693733 => 2023-04-07 17:25:30.828342
[0m17:25:30.829033 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m17:25:30.830563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26769c90-359b-4c2a-b897-9716bdfb4492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa200c26650>]}
[0m17:25:30.831649 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.14s]
[0m17:25:30.833895 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m17:25:30.895860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:30.896445 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:30.897063 [debug] [MainThread]: On master: BEGIN
[0m17:25:30.897727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:30.907605 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:25:30.908093 [debug] [MainThread]: On master: COMMIT
[0m17:25:30.908422 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:30.908734 [debug] [MainThread]: On master: COMMIT
[0m17:25:30.909314 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:25:30.909631 [debug] [MainThread]: On master: Close
[0m17:25:30.910491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:30.910838 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m17:25:30.911212 [info ] [MainThread]: 
[0m17:25:30.911887 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m17:25:30.912734 [debug] [MainThread]: Command end result
[0m17:25:30.919810 [info ] [MainThread]: 
[0m17:25:30.920957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:30.921583 [info ] [MainThread]: 
[0m17:25:30.922524 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:30.923226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa200a8c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa200c525d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa200c1af10>]}
[0m17:25:30.923723 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 17:31:03.428533 | 84c9262b-d8e4-4adb-8854-a887662b35e5 ==============================
[0m17:31:03.428533 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:31:03.432000 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:31:03.432439 [debug] [MainThread]: Tracking: tracking
[0m17:31:03.457202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee62fcc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee62fcc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee62fcc8d0>]}
[0m17:31:03.476418 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:31:03.534419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:03.534829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:03.535662 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m17:31:03.545692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84c9262b-d8e4-4adb-8854-a887662b35e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee6312d1d0>]}
[0m17:31:03.555573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84c9262b-d8e4-4adb-8854-a887662b35e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee630489d0>]}
[0m17:31:03.556192 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:31:03.556888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84c9262b-d8e4-4adb-8854-a887662b35e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63048c50>]}
[0m17:31:03.558747 [info ] [MainThread]: 
[0m17:31:03.559675 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:31:03.560841 [debug] [MainThread]: Command end result
[0m17:31:03.566777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee620280d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee60643d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee63048610>]}
[0m17:31:03.567465 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 17:32:23.310842 | d5f1ee2f-308a-4d9d-85d0-0a15c8a8d83b ==============================
[0m17:32:23.310842 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:32:23.314254 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m17:32:23.314766 [debug] [MainThread]: Tracking: tracking
[0m17:32:23.341122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff71dfe15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff71dfe1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff71dfe1750>]}
[0m17:32:23.360251 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:32:23.417124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:32:23.417786 [debug] [MainThread]: Partial parsing: added file: my_project://models/test_commodities.yml
[0m17:32:23.432686 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'commodities' in the 'models' section of file 'models/test_commodities.yml'
[0m17:32:23.502108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff71dff7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff71e13f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff71e13fa10>]}
[0m17:32:23.502589 [debug] [MainThread]: Flushing usage events
[0m17:32:24.186086 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_commodities_month__eq__01_01_2021__02_01_2021__03_01_2021__04_01_2021__05_01_2021__06_01_2021__07_01_2021__08_01_2021__09_01_2021__10_01_2021__11_01_2021__12_01_2021 (models/test_commodities.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'relation'


============================== 2023-04-07 17:39:36.476094 | 34a83fbd-2934-474c-9cf4-1a7f449871d2 ==============================
[0m17:39:36.476094 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:39:36.479327 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:39:36.479793 [debug] [MainThread]: Tracking: tracking
[0m17:39:36.503804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba137cb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba137cb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba137cb910>]}
[0m17:39:36.522159 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:39:36.533214 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:39:36.533890 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:39:36.534424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34a83fbd-2934-474c-9cf4-1a7f449871d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba138a9710>]}
[0m17:39:36.540439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba137783d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba138a3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba138a3c50>]}
[0m17:39:36.540936 [debug] [MainThread]: Flushing usage events
[0m17:39:37.330939 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_commodities.yml - Runtime Error
    Syntax error near line 75
    ------------------------------
    72 |               relation: eq
    73 | 
    74 | source
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 74, column 1
    could not find expected ':'
      in "<unicode string>", line 75, column 1


============================== 2023-04-07 17:39:57.109072 | 9d346eb0-bd8e-4f91-805c-d8839e022eaa ==============================
[0m17:39:57.109072 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:39:57.111982 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:39:57.112487 [debug] [MainThread]: Tracking: tracking
[0m17:39:57.137079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1881f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1881f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1881f950>]}
[0m17:39:57.155201 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:39:57.166441 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:39:57.167144 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:39:57.167903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d346eb0-bd8e-4f91-805c-d8839e022eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb188ead90>]}
[0m17:39:57.174645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb188f3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb188f3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb188f3f50>]}
[0m17:39:57.175355 [debug] [MainThread]: Flushing usage events
[0m17:39:57.451268 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_commodities.yml - Runtime Error
    Syntax error near line 75
    ------------------------------
    72 |               relation: eq
    73 | 
    74 | source
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 74, column 1
    could not find expected ':'
      in "<unicode string>", line 75, column 1


============================== 2023-04-07 17:39:59.725854 | 9b792ba3-1722-46f7-a460-2454ef098057 ==============================
[0m17:39:59.725854 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:39:59.728145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:39:59.728526 [debug] [MainThread]: Tracking: tracking
[0m17:39:59.750468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9967fd72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9967fd7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9967fd7510>]}
[0m17:39:59.766012 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:39:59.775148 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:39:59.776062 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:39:59.776694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b792ba3-1722-46f7-a460-2454ef098057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99680aae10>]}
[0m17:39:59.783336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99680b2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99680b2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99680b2110>]}
[0m17:39:59.784044 [debug] [MainThread]: Flushing usage events
[0m17:40:00.049274 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_commodities.yml - Runtime Error
    Syntax error near line 75
    ------------------------------
    72 |               relation: eq
    73 | 
    74 | source
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 74, column 1
    could not find expected ':'
      in "<unicode string>", line 75, column 1


============================== 2023-04-07 17:40:05.287014 | 402cfcb6-4aa8-4315-8ac5-373a59770565 ==============================
[0m17:40:05.287014 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:40:05.289401 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:40:05.289820 [debug] [MainThread]: Tracking: tracking
[0m17:40:05.310509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0797d5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0797d54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0797d5550>]}
[0m17:40:05.325919 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:40:05.335327 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:40:05.335959 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:40:05.336569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '402cfcb6-4aa8-4315-8ac5-373a59770565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0799a9d90>]}
[0m17:40:05.341898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc076e43dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0799a9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0799a9c10>]}
[0m17:40:05.342465 [debug] [MainThread]: Flushing usage events
[0m17:40:05.792935 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_commodities.yml - Runtime Error
    Syntax error near line 75
    ------------------------------
    72 |               relation: eq
    73 | 
    74 | source
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 74, column 1
    could not find expected ':'
      in "<unicode string>", line 75, column 1


============================== 2023-04-07 17:40:25.392334 | 824635b2-87e3-4597-b615-cda9c6ec2961 ==============================
[0m17:40:25.392334 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:40:25.395050 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:40:25.395487 [debug] [MainThread]: Tracking: tracking
[0m17:40:25.414974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0330f2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0330f2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0330f24d0>]}
[0m17:40:25.430515 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:40:25.440019 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:40:25.440745 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:40:25.441372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '824635b2-87e3-4597-b615-cda9c6ec2961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02fec0890>]}
[0m17:40:25.447980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03308e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0330d67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0331bf150>]}
[0m17:40:25.448443 [debug] [MainThread]: Flushing usage events
[0m17:40:25.697413 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models/sources.yml is invalid because its 'version:' tag is set to 1.  Only 2 is supported. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2023-04-07 17:40:40.892404 | 2143795f-d366-4a83-823d-8a099fc914f6 ==============================
[0m17:40:40.892404 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:40:40.895269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:40:40.895702 [debug] [MainThread]: Tracking: tracking
[0m17:40:40.916767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6f91a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6f91a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6f91a550>]}
[0m17:40:40.934834 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:40:40.943827 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:40:40.944426 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:40:40.945102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2143795f-d366-4a83-823d-8a099fc914f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6f9e9d10>]}
[0m17:40:41.695191 [debug] [MainThread]: 1603: static parser failed on model1.sql
[0m17:40:41.711010 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model1.sql
[0m17:40:41.736929 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'commodities' in the 'models' section of file 'models/test_commodities.yml'
[0m17:40:41.776237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6fa8f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6f935510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6fa03910>]}
[0m17:40:41.776833 [debug] [MainThread]: Flushing usage events
[0m17:40:41.983734 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_commodities_month__eq__01_01_2021__02_01_2021__03_01_2021__04_01_2021__05_01_2021__06_01_2021__07_01_2021__08_01_2021__09_01_2021__10_01_2021__11_01_2021__12_01_2021 (models/test_commodities.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'relation'


============================== 2023-04-07 17:42:51.266796 | 33c6cccf-adc6-47c5-9958-45fb9a4e4d59 ==============================
[0m17:42:51.266796 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:42:51.270317 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:42:51.270720 [debug] [MainThread]: Tracking: tracking
[0m17:42:51.292357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0701b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0701b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b0701b5d0>]}
[0m17:42:51.307061 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:42:51.318142 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:42:51.318826 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:42:51.319437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33c6cccf-adc6-47c5-9958-45fb9a4e4d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b070e9d10>]}
[0m17:42:52.075557 [debug] [MainThread]: 1603: static parser failed on model1.sql
[0m17:42:52.090851 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model1.sql
[0m17:42:52.115686 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'commodities' in the 'models' section of file 'models/test_commodities.yml'
[0m17:42:52.149711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b071937d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b07191410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b07191250>]}
[0m17:42:52.150368 [debug] [MainThread]: Flushing usage events
[0m17:42:52.606719 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_commodities_month__eq__01_01_2021 (models/test_commodities.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'relation'


============================== 2023-04-07 17:43:49.900433 | 9c276645-3115-4f05-9845-b5bece87dd65 ==============================
[0m17:43:49.900433 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:43:49.903326 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:43:49.903719 [debug] [MainThread]: Tracking: tracking
[0m17:43:49.929458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977f820610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977f7ab210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977f820450>]}
[0m17:43:49.948960 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:43:49.961134 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:43:49.962545 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:43:49.963242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c276645-3115-4f05-9845-b5bece87dd65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977fa26d10>]}
[0m17:43:49.968633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977f813f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977f7b3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977f7b3c90>]}
[0m17:43:49.969164 [debug] [MainThread]: Flushing usage events
[0m17:43:50.235542 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_commodities.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |       - name: id
    6  |         tests:
    7  |           - unique
    8  | - name: month
    9  |   tests:
    10 |     - not_null
    11 |     - accepted_values:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 8, column 1


============================== 2023-04-07 17:44:05.032749 | 4e620db8-d9a0-4c6a-8128-d3dc541188f8 ==============================
[0m17:44:05.032749 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:44:05.035596 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:44:05.036010 [debug] [MainThread]: Tracking: tracking
[0m17:44:05.058389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc11b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadbedd650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc11b4d0>]}
[0m17:44:05.074918 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:44:05.084697 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:44:05.085311 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:44:05.085850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e620db8-d9a0-4c6a-8128-d3dc541188f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc1e9c90>]}
[0m17:44:05.091463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadbf9c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadbf81a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadbf81ad0>]}
[0m17:44:05.091925 [debug] [MainThread]: Flushing usage events
[0m17:44:05.518639 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_commodities.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |             - '01-01-2021'
    14 |             - '02-01-2021'
    15 |             - '03-01-2021'
    16 |               relation: eq
    17 |       - name: commodityName
    18 |         tests:
    19 |           - not_null
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 13, column 13
    did not find expected '-' indicator
      in "<unicode string>", line 16, column 15


============================== 2023-04-07 17:44:13.258497 | 1d6dbe85-3930-49d2-95e5-b3d33b06f150 ==============================
[0m17:44:13.258497 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:44:13.260808 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:44:13.261225 [debug] [MainThread]: Tracking: tracking
[0m17:44:13.280887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1687ec150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd168790650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1687ec6d0>]}
[0m17:44:13.296998 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:44:13.306110 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:44:13.306772 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:44:13.307411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1d6dbe85-3930-49d2-95e5-b3d33b06f150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1659e65d0>]}
[0m17:44:14.323199 [debug] [MainThread]: 1603: static parser failed on model1.sql
[0m17:44:14.342733 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model1.sql
[0m17:44:14.376599 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'commodities' in the 'models' section of file 'models/test_commodities.yml'
[0m17:44:14.424763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd168962bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16896a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd16896a050>]}
[0m17:44:14.425828 [debug] [MainThread]: Flushing usage events
[0m17:44:14.757004 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_commodities_month__eq__01_01_2021 (models/test_commodities.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'relation'


============================== 2023-04-07 17:44:54.951761 | 070ad0ea-88a8-4367-a386-f59443e1730b ==============================
[0m17:44:54.951761 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:44:54.954592 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:44:54.955043 [debug] [MainThread]: Tracking: tracking
[0m17:44:54.975861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fb6c6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fb6c6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fb6c6590>]}
[0m17:44:54.992244 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:44:55.002985 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:44:55.003644 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:44:55.004271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '070ad0ea-88a8-4367-a386-f59443e1730b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fb6cd890>]}
[0m17:44:55.733020 [debug] [MainThread]: 1603: static parser failed on model1.sql
[0m17:44:55.748294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model1.sql
[0m17:44:55.772401 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'commodities' in the 'models' section of file 'models/test_commodities.yml'
[0m17:44:55.807044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fba965d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fba96b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fb941050>]}
[0m17:44:55.807603 [debug] [MainThread]: Flushing usage events
[0m17:44:56.240701 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_commodities_month__eq__01_01_2021 (models/test_commodities.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'relation'


============================== 2023-04-07 17:45:31.170161 | 40178562-cf79-4ff7-8921-51fe57146331 ==============================
[0m17:45:31.170161 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:45:31.173378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:45:31.173797 [debug] [MainThread]: Tracking: tracking
[0m17:45:31.198060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788100d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788100d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788100d250>]}
[0m17:45:31.214815 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:45:31.226737 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:45:31.227394 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:45:31.227967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40178562-cf79-4ff7-8921-51fe57146331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78810e8e10>]}
[0m17:45:31.975641 [debug] [MainThread]: 1603: static parser failed on model1.sql
[0m17:45:31.992944 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model1.sql
[0m17:45:32.017138 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'commodities' in the 'models' section of file 'models/test_commodities.yml'
[0m17:45:32.066529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78811965d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f788104a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7881328bd0>]}
[0m17:45:32.067060 [debug] [MainThread]: Flushing usage events
[0m17:45:32.583996 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_commodities_commodityName__eq__Corn__Wheat__Rice__Soybeans (models/test_commodities.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'relation'


============================== 2023-04-07 17:45:45.593218 | 4dfec7ad-9836-4e0d-816e-e2ed2fd8210a ==============================
[0m17:45:45.593218 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:45:45.596165 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:45:45.596673 [debug] [MainThread]: Tracking: tracking
[0m17:45:45.623455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b9fca310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b9fca990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b9fca850>]}
[0m17:45:45.638791 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:45:45.648451 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:45:45.649166 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:45:45.649805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4dfec7ad-9836-4e0d-816e-e2ed2fd8210a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0b765af50>]}
[0m17:45:46.412905 [debug] [MainThread]: 1603: static parser failed on model1.sql
[0m17:45:46.428732 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model1.sql
[0m17:45:46.453793 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'commodities' in the 'models' section of file 'models/test_commodities.yml'
[0m17:45:46.548211 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.unique_commodities_id.3439e8d9fc' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.549141 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_month.19f23d5543' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.550088 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_month__01_01_2021.4c744c2095' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.550861 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_commodityName.85dad39fda' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.551775 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_commodityName__Corn__Wheat__Rice__Soybeans.1d22aeed5f' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.552641 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_price.b51bd58eed' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.553417 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_price__10_0__20_0__30_0__40_0__50_0__60_0__70_0__80_0__90_0__100_0__110_0__120_0.a40d2114fe' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.554216 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_currency.4fb3ef9271' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.555053 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_currency__USD__CAD__EUR.32efde9753' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.555734 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_symbol.c2ed5d4843' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.556485 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_symbol__CO__WH__RI__SB.63bb4bc120' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m17:45:46.588059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m17:45:46.596485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dfec7ad-9836-4e0d-816e-e2ed2fd8210a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ba19abd0>]}
[0m17:45:46.610158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dfec7ad-9836-4e0d-816e-e2ed2fd8210a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ba147190>]}
[0m17:45:46.610854 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m17:45:46.611974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dfec7ad-9836-4e0d-816e-e2ed2fd8210a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ba147190>]}
[0m17:45:46.614491 [info ] [MainThread]: 
[0m17:45:46.616984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:46.618459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:45:46.636532 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:45:46.637092 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:45:46.637531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:46.718341 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m17:45:46.720082 [debug] [ThreadPool]: On list_postgres: Close
[0m17:45:46.722125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:45:46.729871 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:45:46.730346 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:45:46.730646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:46.739397 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:45:46.739860 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:45:46.740214 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:45:46.747145 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m17:45:46.748663 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:45:46.749385 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:45:46.756042 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:46.756529 [debug] [MainThread]: On master: BEGIN
[0m17:45:46.756840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:46.765323 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:45:46.765812 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:46.766145 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:46.777004 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:45:46.778598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dfec7ad-9836-4e0d-816e-e2ed2fd8210a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ba0bfb90>]}
[0m17:45:46.779393 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:46.780251 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:46.780678 [debug] [MainThread]: On master: BEGIN
[0m17:45:46.781470 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:45:46.782098 [debug] [MainThread]: On master: COMMIT
[0m17:45:46.782467 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:46.782870 [debug] [MainThread]: On master: COMMIT
[0m17:45:46.783553 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:45:46.784007 [debug] [MainThread]: On master: Close
[0m17:45:46.784736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:46.785322 [info ] [MainThread]: 
[0m17:45:46.788249 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m17:45:46.788863 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.model1 ......................................... [RUN]
[0m17:45:46.790127 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m17:45:46.790646 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m17:45:46.796565 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 17:45:46.790988 => 2023-04-07 17:45:46.796403
[0m17:45:46.808991 [debug] [Thread-1  ]: Compilation Error in model model1 (models/model1.sql)
  'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:45:46.809684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfec7ad-9836-4e0d-816e-e2ed2fd8210a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ba49e6d0>]}
[0m17:45:46.810654 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.model1 ................................ [[31mERROR[0m in 0.02s]
[0m17:45:46.812726 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m17:45:46.894816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:46.895999 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:46.896810 [debug] [MainThread]: On master: BEGIN
[0m17:45:46.897627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:46.914344 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:45:46.915266 [debug] [MainThread]: On master: COMMIT
[0m17:45:46.915948 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:46.916604 [debug] [MainThread]: On master: COMMIT
[0m17:45:46.917439 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:45:46.918122 [debug] [MainThread]: On master: Close
[0m17:45:46.919400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:46.920010 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m17:45:46.920555 [info ] [MainThread]: 
[0m17:45:46.921481 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m17:45:46.922606 [debug] [MainThread]: Command end result
[0m17:45:46.934241 [info ] [MainThread]: 
[0m17:45:46.935236 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:45:46.936301 [info ] [MainThread]: 
[0m17:45:46.937129 [error] [MainThread]: [33mCompilation Error in model model1 (models/model1.sql)[0m
[0m17:45:46.937947 [error] [MainThread]:   'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:45:46.938760 [info ] [MainThread]: 
[0m17:45:46.939632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:45:46.940558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ba033b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ba48a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ba49e0d0>]}
[0m17:45:46.941213 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 17:49:11.888137 | 7edeb2d0-9104-4ddb-b78b-bbd961bf08f5 ==============================
[0m17:49:11.888137 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:49:11.891869 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:49:11.892276 [debug] [MainThread]: Tracking: tracking
[0m17:49:11.927401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958c8df3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958c8df850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958c8df350>]}
[0m17:49:11.942731 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:49:12.011346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:49:12.012000 [debug] [MainThread]: Partial parsing: added file: my_project://models/exposure.yml
[0m17:49:12.022267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958ca6fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958ca6fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958ca72f90>]}
[0m17:49:12.022749 [debug] [MainThread]: Flushing usage events
[0m17:49:12.259217 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='exposure.yml', modification_time=1680889745.803437, project_root='/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project') @ exposures: {'name': 'model1', 'label': 'first model', 'type': 'dashboard', 'maturity': 'high', 'depends_on': ['source(commodities)']} - at path []: 'owner' is a required property


============================== 2023-04-07 17:49:50.421631 | 7323381e-9c4c-4df8-9972-c29f8752b73a ==============================
[0m17:49:50.421631 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:49:50.427691 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:49:50.428201 [debug] [MainThread]: Tracking: tracking
[0m17:49:50.457247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894a11d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894a11d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894a11d490>]}
[0m17:49:50.475970 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:49:50.539762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:49:50.540453 [debug] [MainThread]: Partial parsing: added file: my_project://models/exposure.yml
[0m17:49:50.554005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894a0dc510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894a2aee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894a2b3090>]}
[0m17:49:50.555033 [debug] [MainThread]: Flushing usage events
[0m17:49:50.980391 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='exposure.yml', modification_time=1680889783.5460708, project_root='/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project') @ exposures: {'name': 'model1', 'label': 'first model', 'type': 'dashboard', 'maturity': 'high', 'depends_on': ['source(commodities)'], 'owner': {'name': 'Jon Werthman'}} - at path ['owner']: 'email' is a required property


============================== 2023-04-07 17:50:25.439125 | ee3f5a9d-4dbc-4bd7-a479-2728565d3e4b ==============================
[0m17:50:25.439125 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:50:25.441947 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:50:25.442353 [debug] [MainThread]: Tracking: tracking
[0m17:50:25.466234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb280dd950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb280dd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb280dd490>]}
[0m17:50:25.482486 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:50:25.551396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:50:25.552025 [debug] [MainThread]: Partial parsing: added file: my_project://models/exposure.yml
[0m17:50:25.566250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2826ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb28272ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb28272190>]}
[0m17:50:25.566710 [debug] [MainThread]: Flushing usage events
[0m17:50:25.964180 [error] [MainThread]: Encountered an error:
Compilation Error in exposure model1 (models/exposure.yml)
  source() takes exactly two arguments (1 given)


============================== 2023-04-07 17:54:47.689515 | 65d8b497-9afa-4e64-8e53-6058985ccee1 ==============================
[0m17:54:47.689515 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:54:47.693485 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:54:47.693938 [debug] [MainThread]: Tracking: tracking
[0m17:54:47.724464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d717d6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d717d6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d717d6590>]}
[0m17:54:47.743816 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:54:47.807723 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m17:54:47.816812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m17:54:47.825706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65d8b497-9afa-4e64-8e53-6058985ccee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d71a823d0>]}
[0m17:54:47.833264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65d8b497-9afa-4e64-8e53-6058985ccee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d717945d0>]}
[0m17:54:47.833837 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:54:47.834398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d8b497-9afa-4e64-8e53-6058985ccee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d71794290>]}
[0m17:54:47.836066 [info ] [MainThread]: 
[0m17:54:47.838242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:47.840669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:54:47.858133 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:54:47.858594 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:54:47.858932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:47.914388 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m17:54:47.916177 [debug] [ThreadPool]: On list_postgres: Close
[0m17:54:47.917884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:54:47.925384 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:54:47.925852 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:54:47.926201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:47.934297 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:54:47.934762 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:54:47.935104 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:54:47.940587 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m17:54:47.942199 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:54:47.942855 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:54:47.949122 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:47.949576 [debug] [MainThread]: On master: BEGIN
[0m17:54:47.949956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:47.958423 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:54:47.958998 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:47.959371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:47.969260 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:54:47.970965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d8b497-9afa-4e64-8e53-6058985ccee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d719d3b10>]}
[0m17:54:47.971658 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:47.972327 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:47.972715 [debug] [MainThread]: On master: BEGIN
[0m17:54:47.973434 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:54:47.973822 [debug] [MainThread]: On master: COMMIT
[0m17:54:47.974260 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:47.974600 [debug] [MainThread]: On master: COMMIT
[0m17:54:47.975161 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:54:47.975587 [debug] [MainThread]: On master: Close
[0m17:54:47.976302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:47.976830 [info ] [MainThread]: 
[0m17:54:47.980069 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m17:54:47.980758 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.model1 ......................................... [RUN]
[0m17:54:47.981920 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m17:54:47.982433 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m17:54:47.989122 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 17:54:47.982777 => 2023-04-07 17:54:47.988949
[0m17:54:48.001487 [debug] [Thread-1  ]: Compilation Error in model model1 (models/model1.sql)
  'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:54:48.002598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d8b497-9afa-4e64-8e53-6058985ccee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d71bec290>]}
[0m17:54:48.004229 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.model1 ................................ [[31mERROR[0m in 0.02s]
[0m17:54:48.006668 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m17:54:48.083803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:48.084415 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:48.084851 [debug] [MainThread]: On master: BEGIN
[0m17:54:48.085240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:48.094190 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:54:48.094615 [debug] [MainThread]: On master: COMMIT
[0m17:54:48.094981 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:48.095290 [debug] [MainThread]: On master: COMMIT
[0m17:54:48.095760 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:54:48.096158 [debug] [MainThread]: On master: Close
[0m17:54:48.096960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:48.097296 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m17:54:48.097635 [info ] [MainThread]: 
[0m17:54:48.098273 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:54:48.099633 [debug] [MainThread]: Command end result
[0m17:54:48.108408 [info ] [MainThread]: 
[0m17:54:48.109134 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:48.109699 [info ] [MainThread]: 
[0m17:54:48.110264 [error] [MainThread]: [33mCompilation Error in model model1 (models/model1.sql)[0m
[0m17:54:48.110826 [error] [MainThread]:   'sources' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:54:48.111348 [info ] [MainThread]: 
[0m17:54:48.111914 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:54:48.112709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d71bec2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d71bf8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d71bda6d0>]}
[0m17:54:48.113313 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 17:54:56.050394 | dea38e03-9ba8-41d7-b09f-f5de98bd35be ==============================
[0m17:54:56.050394 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:54:56.052710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:54:56.053182 [debug] [MainThread]: Tracking: tracking
[0m17:54:56.074937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991f7702d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991f7705d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991f7707d0>]}
[0m17:54:56.092074 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:54:56.148690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:56.149405 [debug] [MainThread]: Partial parsing: updated file: my_project://models/model1.sql
[0m17:54:56.169622 [debug] [MainThread]: 1699: static parser successfully parsed model1.sql
[0m17:54:56.192003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m17:54:56.199034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dea38e03-9ba8-41d7-b09f-f5de98bd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991f1028d0>]}
[0m17:54:56.207660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dea38e03-9ba8-41d7-b09f-f5de98bd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991f7cc690>]}
[0m17:54:56.208660 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:54:56.209320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dea38e03-9ba8-41d7-b09f-f5de98bd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991f7cc3d0>]}
[0m17:54:56.211057 [info ] [MainThread]: 
[0m17:54:56.213334 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:56.215008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:54:56.229934 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:54:56.231212 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:54:56.231752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:56.250835 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m17:54:56.252868 [debug] [ThreadPool]: On list_postgres: Close
[0m17:54:56.254524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:54:56.262274 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:54:56.262879 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:54:56.263508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:56.272082 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:54:56.272536 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:54:56.272881 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:54:56.278180 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m17:54:56.279834 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:54:56.280575 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:54:56.287315 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:56.287784 [debug] [MainThread]: On master: BEGIN
[0m17:54:56.288827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:56.297579 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:54:56.298109 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:56.298566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:56.304872 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m17:54:56.306553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dea38e03-9ba8-41d7-b09f-f5de98bd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991fb56b10>]}
[0m17:54:56.307273 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:56.307977 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:56.308400 [debug] [MainThread]: On master: BEGIN
[0m17:54:56.309197 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:54:56.309657 [debug] [MainThread]: On master: COMMIT
[0m17:54:56.309997 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:56.310283 [debug] [MainThread]: On master: COMMIT
[0m17:54:56.311000 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:54:56.311490 [debug] [MainThread]: On master: Close
[0m17:54:56.312383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:56.313003 [info ] [MainThread]: 
[0m17:54:56.315968 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m17:54:56.316623 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.model1 ......................................... [RUN]
[0m17:54:56.317766 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m17:54:56.318403 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m17:54:56.320664 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m17:54:56.324102 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 17:54:56.318805 => 2023-04-07 17:54:56.323941
[0m17:54:56.324716 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m17:54:56.383555 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m17:54:56.384556 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:54:56.384954 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m17:54:56.385270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:56.393749 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:54:56.394178 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:54:56.394555 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m17:54:56.408562 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:54:56.416627 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:54:56.417033 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m17:54:56.418140 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:54:56.421795 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:54:56.422207 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m17:54:56.422959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:54:56.447058 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m17:54:56.447483 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:54:56.447806 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m17:54:56.448588 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:54:56.455142 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m17:54:56.455556 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m17:54:56.465916 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:54:56.467519 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 17:54:56.325105 => 2023-04-07 17:54:56.467452
[0m17:54:56.467922 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m17:54:56.468771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dea38e03-9ba8-41d7-b09f-f5de98bd35be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991fd4c1d0>]}
[0m17:54:56.469449 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.15s]
[0m17:54:56.471331 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m17:54:56.522285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:56.522829 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:56.523337 [debug] [MainThread]: On master: BEGIN
[0m17:54:56.523697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:56.532693 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:54:56.533194 [debug] [MainThread]: On master: COMMIT
[0m17:54:56.533636 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:56.534025 [debug] [MainThread]: On master: COMMIT
[0m17:54:56.534653 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:54:56.535103 [debug] [MainThread]: On master: Close
[0m17:54:56.535849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:56.536288 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m17:54:56.536899 [info ] [MainThread]: 
[0m17:54:56.537788 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m17:54:56.538623 [debug] [MainThread]: Command end result
[0m17:54:56.546373 [info ] [MainThread]: 
[0m17:54:56.547718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:56.548542 [info ] [MainThread]: 
[0m17:54:56.549232 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:54:56.550138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991fc33a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991fc33fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f991f906410>]}
[0m17:54:56.550777 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:02:52.181873 | e0ca56df-7a5e-47c1-816b-d8b96b839bcc ==============================
[0m18:02:52.181873 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:02:52.185667 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:02:52.186262 [debug] [MainThread]: Tracking: tracking
[0m18:02:52.212975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7497d5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7497d5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7497d59d0>]}
[0m18:02:52.230702 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:02:52.305004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:02:52.305574 [debug] [MainThread]: Partial parsing: added file: my_project://models/5yearmodel.sql
[0m18:02:52.327924 [debug] [MainThread]: 1699: static parser successfully parsed 5yearmodel.sql
[0m18:02:52.353904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:02:52.361218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0ca56df-7a5e-47c1-816b-d8b96b839bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7496954d0>]}
[0m18:02:52.371192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0ca56df-7a5e-47c1-816b-d8b96b839bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7497b6050>]}
[0m18:02:52.371935 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:02:52.372686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ca56df-7a5e-47c1-816b-d8b96b839bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7497b6b90>]}
[0m18:02:52.375034 [info ] [MainThread]: 
[0m18:02:52.377230 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:02:52.378635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:02:52.394076 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:02:52.394508 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:02:52.394843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:52.462081 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:02:52.463869 [debug] [ThreadPool]: On list_postgres: Close
[0m18:02:52.465773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:02:52.472845 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:02:52.473246 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:02:52.473552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:52.482295 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:02:52.482834 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:02:52.483155 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:02:52.489623 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m18:02:52.491055 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:02:52.491650 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:02:52.497671 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:52.498088 [debug] [MainThread]: On master: BEGIN
[0m18:02:52.498572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:52.507357 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:02:52.507927 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:52.508244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:02:52.516927 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:02:52.518290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ca56df-7a5e-47c1-816b-d8b96b839bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7497944d0>]}
[0m18:02:52.518822 [debug] [MainThread]: On master: ROLLBACK
[0m18:02:52.519463 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:52.519847 [debug] [MainThread]: On master: BEGIN
[0m18:02:52.520569 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:02:52.520919 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.521283 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:52.521573 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.522078 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:02:52.522391 [debug] [MainThread]: On master: Close
[0m18:02:52.523086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:52.523634 [info ] [MainThread]: 
[0m18:02:52.527651 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:02:52.528250 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:02:52.529530 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:02:52.530161 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:02:52.533390 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:02:52.535099 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:02:52.530611 => 2023-04-07 18:02:52.534854
[0m18:02:52.536094 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:02:52.589194 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:02:52.590183 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:02:52.590508 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:02:52.590845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:02:52.600056 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:02:52.600509 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:02:52.601019 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM postgres
FROM commodities2
WHERE date >= DATE_TRUNC('year', 2023 - 5 '5 year')

ORDER BY date DESC
  );
[0m18:02:52.602752 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 5: FROM commodities2
        ^

[0m18:02:52.603289 [debug] [Thread-1  ]: On model.my_project.5yearmodel: ROLLBACK
[0m18:02:52.604282 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:02:52.536584 => 2023-04-07 18:02:52.604187
[0m18:02:52.604628 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:02:52.618458 [debug] [Thread-1  ]: Database Error in model 5yearmodel (models/5yearmodel.sql)
  syntax error at or near "FROM"
  LINE 5: FROM commodities2
          ^
  compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:02:52.619122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ca56df-7a5e-47c1-816b-d8b96b839bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7497b67d0>]}
[0m18:02:52.619697 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbt.5yearmodel ............................ [[31mERROR[0m in 0.09s]
[0m18:02:52.621516 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:02:52.622049 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:02:52.622677 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.model1 ......................................... [RUN]
[0m18:02:52.623718 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:02:52.624194 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:02:52.626403 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:02:52.627797 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:02:52.624480 => 2023-04-07 18:02:52.627664
[0m18:02:52.628294 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:02:52.636590 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:02:52.637470 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:02:52.637828 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:02:52.638120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:02:52.646660 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:02:52.647233 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:02:52.647693 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:02:52.651956 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:02:52.660397 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:02:52.660813 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:02:52.661726 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:02:52.666678 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:02:52.667082 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:02:52.667982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:02:52.692533 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:02:52.692975 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:02:52.693281 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:02:52.694545 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:02:52.701781 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:02:52.702334 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:02:52.715165 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:02:52.716780 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:02:52.628556 => 2023-04-07 18:02:52.716722
[0m18:02:52.717132 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:02:52.717967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ca56df-7a5e-47c1-816b-d8b96b839bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe749997550>]}
[0m18:02:52.718553 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:02:52.719294 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:02:52.739205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:02:52.739746 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:52.740294 [debug] [MainThread]: On master: BEGIN
[0m18:02:52.740655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:52.750381 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:02:52.750988 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.751559 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:52.751937 [debug] [MainThread]: On master: COMMIT
[0m18:02:52.752506 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:02:52.752831 [debug] [MainThread]: On master: Close
[0m18:02:52.753521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:52.753812 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m18:02:52.754124 [info ] [MainThread]: 
[0m18:02:52.754651 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m18:02:52.755457 [debug] [MainThread]: Command end result
[0m18:02:52.763382 [info ] [MainThread]: 
[0m18:02:52.764288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:52.765073 [info ] [MainThread]: 
[0m18:02:52.766025 [error] [MainThread]: [33mDatabase Error in model 5yearmodel (models/5yearmodel.sql)[0m
[0m18:02:52.766719 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:02:52.767618 [error] [MainThread]:   LINE 5: FROM commodities2
[0m18:02:52.768402 [error] [MainThread]:           ^
[0m18:02:52.769106 [error] [MainThread]:   compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:02:52.769939 [info ] [MainThread]: 
[0m18:02:52.770941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:02:52.771953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe746e80810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe749ccb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe749ccb250>]}
[0m18:02:52.772631 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:03:28.512405 | 2e338586-5214-423c-975a-2af78ddff2a5 ==============================
[0m18:03:28.512405 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:03:28.515300 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:03:28.515814 [debug] [MainThread]: Tracking: tracking
[0m18:03:28.538423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71001e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70b66d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70ff4d5d0>]}
[0m18:03:28.554011 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:03:28.621096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:28.621782 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5yearmodel.sql
[0m18:03:28.641002 [debug] [MainThread]: 1699: static parser successfully parsed 5yearmodel.sql
[0m18:03:28.665287 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:03:28.673124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e338586-5214-423c-975a-2af78ddff2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7101c5210>]}
[0m18:03:28.681860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e338586-5214-423c-975a-2af78ddff2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70fff6810>]}
[0m18:03:28.682369 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:03:28.682970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e338586-5214-423c-975a-2af78ddff2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc70fff6e10>]}
[0m18:03:28.684864 [info ] [MainThread]: 
[0m18:03:28.687031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:03:28.688342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:03:28.703718 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:03:28.704253 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:03:28.704629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:28.770026 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:03:28.772413 [debug] [ThreadPool]: On list_postgres: Close
[0m18:03:28.774277 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:03:28.781520 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:03:28.781941 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:03:28.782265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:28.791204 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:03:28.791775 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:03:28.792141 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:03:28.795759 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m18:03:28.797282 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:03:28.798033 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:03:28.804060 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:28.804471 [debug] [MainThread]: On master: BEGIN
[0m18:03:28.804804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:28.813459 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:03:28.814036 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:28.814341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:03:28.819546 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:03:28.820900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e338586-5214-423c-975a-2af78ddff2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71019e250>]}
[0m18:03:28.821379 [debug] [MainThread]: On master: ROLLBACK
[0m18:03:28.821974 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:28.822293 [debug] [MainThread]: On master: BEGIN
[0m18:03:28.822979 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:03:28.823321 [debug] [MainThread]: On master: COMMIT
[0m18:03:28.823632 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:28.823961 [debug] [MainThread]: On master: COMMIT
[0m18:03:28.824420 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:03:28.824729 [debug] [MainThread]: On master: Close
[0m18:03:28.825448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:28.825972 [info ] [MainThread]: 
[0m18:03:28.829768 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:03:28.830521 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:03:28.831593 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:03:28.832038 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:03:28.834847 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:03:28.836210 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:03:28.832358 => 2023-04-07 18:03:28.835922
[0m18:03:28.837259 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:03:28.888295 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:03:28.889135 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:03:28.889585 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:03:28.889883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:03:28.898519 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:03:28.898937 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:03:28.899245 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE date >= DATE_TRUNC('year', 2023 - 5 '5 year')

ORDER BY date DESC
  );
[0m18:03:28.900053 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "'5 year'"
LINE 4: ...odities2 WHERE date >= DATE_TRUNC('year', 2023 - 5 '5 year')
                                                              ^

[0m18:03:28.900425 [debug] [Thread-1  ]: On model.my_project.5yearmodel: ROLLBACK
[0m18:03:28.901120 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:03:28.837702 => 2023-04-07 18:03:28.901057
[0m18:03:28.901423 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:03:28.914089 [debug] [Thread-1  ]: Database Error in model 5yearmodel (models/5yearmodel.sql)
  syntax error at or near "'5 year'"
  LINE 4: ...odities2 WHERE date >= DATE_TRUNC('year', 2023 - 5 '5 year')
                                                                ^
  compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:03:28.914726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e338586-5214-423c-975a-2af78ddff2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc710056cd0>]}
[0m18:03:28.915497 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbt.5yearmodel ............................ [[31mERROR[0m in 0.08s]
[0m18:03:28.917156 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:03:28.917653 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:03:28.918390 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.model1 ......................................... [RUN]
[0m18:03:28.919656 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:03:28.920172 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:03:28.922765 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:03:28.923529 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:03:28.920766 => 2023-04-07 18:03:28.923450
[0m18:03:28.923992 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:03:28.932120 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:03:28.933219 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:03:28.933605 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:03:28.933997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:03:28.943479 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:03:28.943865 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:03:28.944179 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:03:28.947282 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:03:28.955531 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:03:28.955989 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:03:28.957136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:03:28.961129 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:03:28.961544 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:03:28.962446 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:03:28.986997 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:03:28.987421 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:03:28.987771 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:03:28.989324 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:03:28.996973 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:03:28.997368 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:03:28.998868 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:03:29.000800 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:03:28.924287 => 2023-04-07 18:03:29.000737
[0m18:03:29.001399 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:03:29.002358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e338586-5214-423c-975a-2af78ddff2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc710336950>]}
[0m18:03:29.002994 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:03:29.003673 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:03:29.038012 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:03:29.038575 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:29.038955 [debug] [MainThread]: On master: BEGIN
[0m18:03:29.039313 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:29.048837 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:03:29.049295 [debug] [MainThread]: On master: COMMIT
[0m18:03:29.049618 [debug] [MainThread]: Using postgres connection "master"
[0m18:03:29.049948 [debug] [MainThread]: On master: COMMIT
[0m18:03:29.050456 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:03:29.050774 [debug] [MainThread]: On master: Close
[0m18:03:29.051459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:29.051807 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m18:03:29.052182 [info ] [MainThread]: 
[0m18:03:29.052808 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:03:29.053896 [debug] [MainThread]: Command end result
[0m18:03:29.063229 [info ] [MainThread]: 
[0m18:03:29.064348 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:29.065056 [info ] [MainThread]: 
[0m18:03:29.065863 [error] [MainThread]: [33mDatabase Error in model 5yearmodel (models/5yearmodel.sql)[0m
[0m18:03:29.066439 [error] [MainThread]:   syntax error at or near "'5 year'"
[0m18:03:29.066976 [error] [MainThread]:   LINE 4: ...odities2 WHERE date >= DATE_TRUNC('year', 2023 - 5 '5 year')
[0m18:03:29.067536 [error] [MainThread]:                                                                 ^
[0m18:03:29.068124 [error] [MainThread]:   compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:03:29.068871 [info ] [MainThread]: 
[0m18:03:29.069631 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:03:29.070370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc710405d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc710405650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc710405710>]}
[0m18:03:29.071006 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:04:17.979831 | c76c1163-e0c0-4e7c-b6f2-f472984cb73b ==============================
[0m18:04:17.979831 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:04:17.983123 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:04:17.983558 [debug] [MainThread]: Tracking: tracking
[0m18:04:18.005586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a377e0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a377e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a377e0790>]}
[0m18:04:18.023943 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:04:18.091724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:18.092480 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5yearmodel.sql
[0m18:04:18.110367 [debug] [MainThread]: 1699: static parser successfully parsed 5yearmodel.sql
[0m18:04:18.131924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:04:18.140080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c76c1163-e0c0-4e7c-b6f2-f472984cb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a37792e10>]}
[0m18:04:18.148965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c76c1163-e0c0-4e7c-b6f2-f472984cb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a377b56d0>]}
[0m18:04:18.149517 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:04:18.150138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c76c1163-e0c0-4e7c-b6f2-f472984cb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a377b5d90>]}
[0m18:04:18.151816 [info ] [MainThread]: 
[0m18:04:18.154125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:18.155682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:04:18.171439 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:04:18.171967 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:04:18.172309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:18.218044 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:04:18.220075 [debug] [ThreadPool]: On list_postgres: Close
[0m18:04:18.221910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:04:18.229504 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:04:18.229945 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:04:18.230351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:18.239183 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:04:18.239735 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:04:18.240198 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:04:18.245030 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m18:04:18.246697 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:04:18.247556 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:04:18.253752 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.254166 [debug] [MainThread]: On master: BEGIN
[0m18:04:18.254722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:18.264488 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:04:18.265170 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.265495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:18.271738 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:04:18.273715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c76c1163-e0c0-4e7c-b6f2-f472984cb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a37a7eb50>]}
[0m18:04:18.274423 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:18.275108 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.275453 [debug] [MainThread]: On master: BEGIN
[0m18:04:18.276140 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:04:18.276491 [debug] [MainThread]: On master: COMMIT
[0m18:04:18.276800 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.277083 [debug] [MainThread]: On master: COMMIT
[0m18:04:18.277492 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:04:18.277824 [debug] [MainThread]: On master: Close
[0m18:04:18.278502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:18.279112 [info ] [MainThread]: 
[0m18:04:18.282512 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:04:18.283085 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:04:18.284074 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:04:18.284515 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:04:18.287383 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:04:18.288951 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:04:18.284809 => 2023-04-07 18:04:18.288750
[0m18:04:18.289583 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:04:18.348752 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:04:18.349660 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:04:18.349986 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:04:18.350306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:04:18.360729 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:04:18.361295 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:04:18.361783 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE date >= DATE_TRUNC('year', 2023 - INTERVAL '5 years')
ORDER BY date DESC
  );
[0m18:04:18.364028 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 4:     SELECT * FROM commodities2 WHERE date >= DATE_TRUNC('yea...
                                             ^

[0m18:04:18.364496 [debug] [Thread-1  ]: On model.my_project.5yearmodel: ROLLBACK
[0m18:04:18.365219 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:04:18.289947 => 2023-04-07 18:04:18.365141
[0m18:04:18.365588 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:04:18.377668 [debug] [Thread-1  ]: Database Error in model 5yearmodel (models/5yearmodel.sql)
  column "date" does not exist
  LINE 4:     SELECT * FROM commodities2 WHERE date >= DATE_TRUNC('yea...
                                               ^
  compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:04:18.378275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76c1163-e0c0-4e7c-b6f2-f472984cb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a37998f50>]}
[0m18:04:18.378866 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbt.5yearmodel ............................ [[31mERROR[0m in 0.09s]
[0m18:04:18.380440 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:04:18.380959 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:04:18.381597 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.model1 ......................................... [RUN]
[0m18:04:18.382521 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:04:18.382889 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:04:18.384972 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:04:18.385853 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:04:18.383134 => 2023-04-07 18:04:18.385761
[0m18:04:18.386256 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:04:18.391910 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:04:18.393057 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:04:18.393540 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:04:18.393989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:04:18.403360 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:04:18.404055 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:04:18.404391 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:04:18.407392 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:04:18.416767 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:04:18.417364 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:04:18.418301 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:04:18.421642 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:04:18.421987 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:04:18.422869 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:04:18.452119 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:04:18.452532 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:04:18.452830 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:04:18.453826 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:04:18.461435 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:04:18.461950 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:04:18.464218 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:04:18.466837 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:04:18.386515 => 2023-04-07 18:04:18.466738
[0m18:04:18.467245 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:04:18.468052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76c1163-e0c0-4e7c-b6f2-f472984cb73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a379610d0>]}
[0m18:04:18.468587 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:04:18.469255 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:04:18.497255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:18.498031 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.498453 [debug] [MainThread]: On master: BEGIN
[0m18:04:18.498846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:18.507664 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:04:18.508235 [debug] [MainThread]: On master: COMMIT
[0m18:04:18.508760 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.509237 [debug] [MainThread]: On master: COMMIT
[0m18:04:18.509884 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:04:18.510349 [debug] [MainThread]: On master: Close
[0m18:04:18.511199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:18.511533 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m18:04:18.511886 [info ] [MainThread]: 
[0m18:04:18.512421 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:04:18.513146 [debug] [MainThread]: Command end result
[0m18:04:18.520774 [info ] [MainThread]: 
[0m18:04:18.521435 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:04:18.522455 [info ] [MainThread]: 
[0m18:04:18.523366 [error] [MainThread]: [33mDatabase Error in model 5yearmodel (models/5yearmodel.sql)[0m
[0m18:04:18.524184 [error] [MainThread]:   column "date" does not exist
[0m18:04:18.524972 [error] [MainThread]:   LINE 4:     SELECT * FROM commodities2 WHERE date >= DATE_TRUNC('yea...
[0m18:04:18.525565 [error] [MainThread]:                                                ^
[0m18:04:18.526155 [error] [MainThread]:   compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:04:18.526760 [info ] [MainThread]: 
[0m18:04:18.527397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:04:18.528055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a37cd1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a37cd1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a37cd1dd0>]}
[0m18:04:18.528453 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:05:38.157082 | 34a5f709-0ef3-4287-8fe5-03b4c867ee97 ==============================
[0m18:05:38.157082 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:05:38.160223 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:05:38.160680 [debug] [MainThread]: Tracking: tracking
[0m18:05:38.188145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb56fcd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb56fcdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb56fcd790>]}
[0m18:05:38.204518 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:05:38.262691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:05:38.263463 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5yearmodel.sql
[0m18:05:38.285020 [debug] [MainThread]: 1699: static parser successfully parsed 5yearmodel.sql
[0m18:05:38.310558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:05:38.318176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34a5f709-0ef3-4287-8fe5-03b4c867ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb56f93890>]}
[0m18:05:38.325795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34a5f709-0ef3-4287-8fe5-03b4c867ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb56fb6650>]}
[0m18:05:38.326433 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:05:38.327154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a5f709-0ef3-4287-8fe5-03b4c867ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb56fb6e90>]}
[0m18:05:38.329234 [info ] [MainThread]: 
[0m18:05:38.332010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:38.334975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:05:38.355351 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:05:38.356008 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:05:38.356695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:38.420711 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:05:38.423033 [debug] [ThreadPool]: On list_postgres: Close
[0m18:05:38.424884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:05:38.432886 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:05:38.446690 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:05:38.447679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:38.456614 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:05:38.457100 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:05:38.457423 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:05:38.461631 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m18:05:38.463246 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:05:38.463945 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:05:38.470373 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:38.470915 [debug] [MainThread]: On master: BEGIN
[0m18:05:38.471258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:38.480344 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:38.480889 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:38.481254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:05:38.487445 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:05:38.488898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a5f709-0ef3-4287-8fe5-03b4c867ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb56fb6750>]}
[0m18:05:38.489507 [debug] [MainThread]: On master: ROLLBACK
[0m18:05:38.490165 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:38.490522 [debug] [MainThread]: On master: BEGIN
[0m18:05:38.491260 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:38.491635 [debug] [MainThread]: On master: COMMIT
[0m18:05:38.491985 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:38.492317 [debug] [MainThread]: On master: COMMIT
[0m18:05:38.492880 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:05:38.493276 [debug] [MainThread]: On master: Close
[0m18:05:38.494030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:38.494636 [info ] [MainThread]: 
[0m18:05:38.497344 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:05:38.497977 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:05:38.499235 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:05:38.499818 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:05:38.502658 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:05:38.503918 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:05:38.500188 => 2023-04-07 18:05:38.503727
[0m18:05:38.504765 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:05:38.562757 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:05:38.563782 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:05:38.564210 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:05:38.564571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:38.575284 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:05:38.575740 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:05:38.576079 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE date >= (2018-01-01)
ORDER BY date DESC
  );
[0m18:05:38.577349 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 4:     SELECT * FROM commodities2 WHERE date >= (2018-01-01)
                                             ^

[0m18:05:38.577871 [debug] [Thread-1  ]: On model.my_project.5yearmodel: ROLLBACK
[0m18:05:38.578648 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:05:38.505221 => 2023-04-07 18:05:38.578580
[0m18:05:38.578990 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:05:38.591002 [debug] [Thread-1  ]: Database Error in model 5yearmodel (models/5yearmodel.sql)
  column "date" does not exist
  LINE 4:     SELECT * FROM commodities2 WHERE date >= (2018-01-01)
                                               ^
  compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:05:38.591650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a5f709-0ef3-4287-8fe5-03b4c867ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb572880d0>]}
[0m18:05:38.592228 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbt.5yearmodel ............................ [[31mERROR[0m in 0.09s]
[0m18:05:38.594010 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:05:38.594594 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:05:38.595115 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.model1 ......................................... [RUN]
[0m18:05:38.596179 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:05:38.596655 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:05:38.598758 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:05:38.599650 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:05:38.596952 => 2023-04-07 18:05:38.599557
[0m18:05:38.600119 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:05:38.608035 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:05:38.609073 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:38.609459 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:05:38.610171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:38.620405 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:05:38.620836 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:38.621178 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:05:38.625601 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:05:38.634223 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:38.634663 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:05:38.635672 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:05:38.639798 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:38.640254 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:05:38.641190 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:05:38.668894 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:05:38.669371 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:38.669944 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:05:38.671871 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:05:38.680766 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:38.681214 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:05:38.686288 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:05:38.687959 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:05:38.600476 => 2023-04-07 18:05:38.687895
[0m18:05:38.688376 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:05:38.689234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a5f709-0ef3-4287-8fe5-03b4c867ee97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5716b050>]}
[0m18:05:38.689854 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:05:38.690556 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:05:38.711264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:38.718511 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:38.719063 [debug] [MainThread]: On master: BEGIN
[0m18:05:38.719509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:38.729991 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:38.730470 [debug] [MainThread]: On master: COMMIT
[0m18:05:38.730884 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:38.731248 [debug] [MainThread]: On master: COMMIT
[0m18:05:38.731965 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:05:38.732450 [debug] [MainThread]: On master: Close
[0m18:05:38.733266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:38.733656 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m18:05:38.734060 [info ] [MainThread]: 
[0m18:05:38.734683 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m18:05:38.735465 [debug] [MainThread]: Command end result
[0m18:05:38.744883 [info ] [MainThread]: 
[0m18:05:38.746319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:05:38.746954 [info ] [MainThread]: 
[0m18:05:38.747583 [error] [MainThread]: [33mDatabase Error in model 5yearmodel (models/5yearmodel.sql)[0m
[0m18:05:38.748285 [error] [MainThread]:   column "date" does not exist
[0m18:05:38.748929 [error] [MainThread]:   LINE 4:     SELECT * FROM commodities2 WHERE date >= (2018-01-01)
[0m18:05:38.749658 [error] [MainThread]:                                                ^
[0m18:05:38.750278 [error] [MainThread]:   compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:05:38.750876 [info ] [MainThread]: 
[0m18:05:38.751491 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:05:38.752210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5714ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb574d0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb574d0d10>]}
[0m18:05:38.752681 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:05:50.338289 | ce0b8572-3480-4279-90df-ddd84df93ec4 ==============================
[0m18:05:50.338289 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:05:50.340780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:05:50.341175 [debug] [MainThread]: Tracking: tracking
[0m18:05:50.364404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1937f7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1937f7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1937f76d0>]}
[0m18:05:50.379436 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:05:50.439789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:05:50.440481 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5yearmodel.sql
[0m18:05:50.460322 [debug] [MainThread]: 1699: static parser successfully parsed 5yearmodel.sql
[0m18:05:50.482034 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:05:50.489458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce0b8572-3480-4279-90df-ddd84df93ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1937aa5d0>]}
[0m18:05:50.500033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce0b8572-3480-4279-90df-ddd84df93ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1937cc850>]}
[0m18:05:50.500827 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:05:50.502070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce0b8572-3480-4279-90df-ddd84df93ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1937cce50>]}
[0m18:05:50.507022 [info ] [MainThread]: 
[0m18:05:50.510480 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:50.512254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:05:50.534243 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:05:50.534882 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:05:50.535354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:50.569512 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:05:50.571780 [debug] [ThreadPool]: On list_postgres: Close
[0m18:05:50.573888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:05:50.581562 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:05:50.582000 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:05:50.582323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:50.590955 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:05:50.591394 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:05:50.591722 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:05:50.595827 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m18:05:50.597260 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:05:50.597869 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:05:50.604059 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:50.604477 [debug] [MainThread]: On master: BEGIN
[0m18:05:50.604789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:50.614473 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:50.615056 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:50.615381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:05:50.621646 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:05:50.623093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce0b8572-3480-4279-90df-ddd84df93ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe19386cc10>]}
[0m18:05:50.623700 [debug] [MainThread]: On master: ROLLBACK
[0m18:05:50.624476 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:50.624896 [debug] [MainThread]: On master: BEGIN
[0m18:05:50.625778 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:50.626242 [debug] [MainThread]: On master: COMMIT
[0m18:05:50.626642 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:50.627057 [debug] [MainThread]: On master: COMMIT
[0m18:05:50.627724 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:05:50.628196 [debug] [MainThread]: On master: Close
[0m18:05:50.629049 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:50.629700 [info ] [MainThread]: 
[0m18:05:50.632611 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:05:50.633280 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:05:50.634327 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:05:50.634895 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:05:50.637575 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:05:50.638981 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:05:50.635245 => 2023-04-07 18:05:50.638776
[0m18:05:50.639589 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:05:50.697568 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:05:50.698491 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:05:50.698826 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:05:50.699092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:50.707590 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:05:50.708017 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:05:50.708344 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= (2018-01-01)
ORDER BY date DESC
  );
[0m18:05:50.714624 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: date >= integer
LINE 4:     SELECT * FROM commodities2 WHERE month >= (2018-01-01)
                                                   ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m18:05:50.715160 [debug] [Thread-1  ]: On model.my_project.5yearmodel: ROLLBACK
[0m18:05:50.716152 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:05:50.640056 => 2023-04-07 18:05:50.716059
[0m18:05:50.716621 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:05:50.725798 [debug] [Thread-1  ]: Database Error in model 5yearmodel (models/5yearmodel.sql)
  operator does not exist: date >= integer
  LINE 4:     SELECT * FROM commodities2 WHERE month >= (2018-01-01)
                                                     ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:05:50.726376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0b8572-3480-4279-90df-ddd84df93ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1937aab10>]}
[0m18:05:50.726964 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbt.5yearmodel ............................ [[31mERROR[0m in 0.09s]
[0m18:05:50.729100 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:05:50.729789 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:05:50.730384 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.model1 ......................................... [RUN]
[0m18:05:50.733107 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:05:50.733864 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:05:50.738035 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:05:50.738827 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:05:50.735399 => 2023-04-07 18:05:50.738740
[0m18:05:50.739295 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:05:50.746162 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:05:50.747554 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:50.747981 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:05:50.748267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:50.762761 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:05:50.763223 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:50.763736 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:05:50.770517 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:05:50.780629 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:50.781387 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:05:50.782821 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:05:50.787191 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:50.787631 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:05:50.788481 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:05:50.816141 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:05:50.816564 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:50.816882 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:05:50.818064 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:05:50.825218 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:05:50.825621 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:05:50.827180 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:05:50.829204 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:05:50.740129 => 2023-04-07 18:05:50.829024
[0m18:05:50.829680 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:05:50.830592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0b8572-3480-4279-90df-ddd84df93ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe193b08f90>]}
[0m18:05:50.831205 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:05:50.831925 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:05:50.841590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:05:50.842508 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:50.843027 [debug] [MainThread]: On master: BEGIN
[0m18:05:50.843386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:50.855469 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:05:50.856122 [debug] [MainThread]: On master: COMMIT
[0m18:05:50.856577 [debug] [MainThread]: Using postgres connection "master"
[0m18:05:50.857110 [debug] [MainThread]: On master: COMMIT
[0m18:05:50.857906 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:05:50.858334 [debug] [MainThread]: On master: Close
[0m18:05:50.859069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:50.859405 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m18:05:50.859765 [info ] [MainThread]: 
[0m18:05:50.860449 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:05:50.861320 [debug] [MainThread]: Command end result
[0m18:05:50.870813 [info ] [MainThread]: 
[0m18:05:50.871599 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:05:50.872219 [info ] [MainThread]: 
[0m18:05:50.872898 [error] [MainThread]: [33mDatabase Error in model 5yearmodel (models/5yearmodel.sql)[0m
[0m18:05:50.873556 [error] [MainThread]:   operator does not exist: date >= integer
[0m18:05:50.874301 [error] [MainThread]:   LINE 4:     SELECT * FROM commodities2 WHERE month >= (2018-01-01)
[0m18:05:50.874888 [error] [MainThread]:                                                      ^
[0m18:05:50.875486 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m18:05:50.876073 [error] [MainThread]:   compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:05:50.876819 [info ] [MainThread]: 
[0m18:05:50.877523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:05:50.878302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe19377f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe193be11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe193be1190>]}
[0m18:05:50.878837 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:06:25.711345 | bd597c86-3302-4097-aceb-9516029ab267 ==============================
[0m18:06:25.711345 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:06:25.714283 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:06:25.714674 [debug] [MainThread]: Tracking: tracking
[0m18:06:25.739342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4e7dc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4e7dc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4e7dc450>]}
[0m18:06:25.755617 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:06:25.821465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:25.822205 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5yearmodel.sql
[0m18:06:25.844671 [debug] [MainThread]: 1699: static parser successfully parsed 5yearmodel.sql
[0m18:06:25.875095 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:06:25.883465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd597c86-3302-4097-aceb-9516029ab267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4e80d050>]}
[0m18:06:25.892357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd597c86-3302-4097-aceb-9516029ab267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4e7c0890>]}
[0m18:06:25.892952 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:06:25.893763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd597c86-3302-4097-aceb-9516029ab267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4e6875d0>]}
[0m18:06:25.895804 [info ] [MainThread]: 
[0m18:06:25.897897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:25.899489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:06:25.915399 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:06:25.915844 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:06:25.916176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:25.969517 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:06:25.971333 [debug] [ThreadPool]: On list_postgres: Close
[0m18:06:25.973289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:06:25.980295 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:06:25.980725 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:06:25.981038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:25.989604 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:06:25.990080 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:06:25.990464 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:06:25.994207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m18:06:25.995679 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:06:25.996306 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:06:26.002294 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.003295 [debug] [MainThread]: On master: BEGIN
[0m18:06:26.003668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:26.012406 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:06:26.012880 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.013187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:26.018412 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:06:26.019800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd597c86-3302-4097-aceb-9516029ab267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4e93a0d0>]}
[0m18:06:26.020277 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:26.020883 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.021211 [debug] [MainThread]: On master: BEGIN
[0m18:06:26.021931 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:06:26.022265 [debug] [MainThread]: On master: COMMIT
[0m18:06:26.022583 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.022859 [debug] [MainThread]: On master: COMMIT
[0m18:06:26.023428 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:06:26.023732 [debug] [MainThread]: On master: Close
[0m18:06:26.024481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:26.025017 [info ] [MainThread]: 
[0m18:06:26.028641 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:06:26.029313 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:06:26.030403 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:06:26.030902 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:06:26.032998 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:06:26.034130 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:06:26.031255 => 2023-04-07 18:06:26.033877
[0m18:06:26.034973 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:06:26.086216 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:06:26.087097 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:06:26.087502 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:06:26.087766 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:26.096309 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:06:26.096814 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:06:26.097090 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY date DESC
  );
[0m18:06:26.100516 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 5: ORDER BY date DESC
                 ^

[0m18:06:26.100988 [debug] [Thread-1  ]: On model.my_project.5yearmodel: ROLLBACK
[0m18:06:26.101894 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:06:26.035842 => 2023-04-07 18:06:26.101800
[0m18:06:26.102193 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:06:26.115046 [debug] [Thread-1  ]: Database Error in model 5yearmodel (models/5yearmodel.sql)
  column "date" does not exist
  LINE 5: ORDER BY date DESC
                   ^
  compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:06:26.115692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd597c86-3302-4097-aceb-9516029ab267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4eb50190>]}
[0m18:06:26.116240 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbt.5yearmodel ............................ [[31mERROR[0m in 0.09s]
[0m18:06:26.118086 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:06:26.118629 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:06:26.119257 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.model1 ......................................... [RUN]
[0m18:06:26.120357 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:06:26.121250 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:06:26.123396 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:06:26.124161 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:06:26.121589 => 2023-04-07 18:06:26.124083
[0m18:06:26.124602 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:06:26.132524 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:06:26.133527 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:26.133855 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:06:26.134115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:26.143945 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:06:26.144451 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:26.144896 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:06:26.148978 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:06:26.158128 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:26.158692 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:06:26.160414 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:06:26.164157 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:26.164536 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:06:26.165310 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:06:26.191316 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:06:26.191799 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:26.192109 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:06:26.193220 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:06:26.199719 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:26.200190 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:06:26.202355 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:06:26.205429 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:06:26.124920 => 2023-04-07 18:06:26.205367
[0m18:06:26.205952 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:06:26.206751 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd597c86-3302-4097-aceb-9516029ab267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ed28190>]}
[0m18:06:26.207275 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:06:26.207955 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:06:26.237670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:26.238355 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.238730 [debug] [MainThread]: On master: BEGIN
[0m18:06:26.239081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:26.249058 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:06:26.249555 [debug] [MainThread]: On master: COMMIT
[0m18:06:26.249911 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.250225 [debug] [MainThread]: On master: COMMIT
[0m18:06:26.250688 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:06:26.251030 [debug] [MainThread]: On master: Close
[0m18:06:26.251796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:26.252162 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m18:06:26.252594 [info ] [MainThread]: 
[0m18:06:26.253150 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:06:26.253904 [debug] [MainThread]: Command end result
[0m18:06:26.261380 [info ] [MainThread]: 
[0m18:06:26.262555 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:06:26.263666 [info ] [MainThread]: 
[0m18:06:26.264598 [error] [MainThread]: [33mDatabase Error in model 5yearmodel (models/5yearmodel.sql)[0m
[0m18:06:26.265257 [error] [MainThread]:   column "date" does not exist
[0m18:06:26.265951 [error] [MainThread]:   LINE 5: ORDER BY date DESC
[0m18:06:26.266688 [error] [MainThread]:                    ^
[0m18:06:26.267271 [error] [MainThread]:   compiled Code at target/run/my_project/models/5yearmodel.sql
[0m18:06:26.267855 [info ] [MainThread]: 
[0m18:06:26.268590 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m18:06:26.269428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ed4dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ed32050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef4ed1e8d0>]}
[0m18:06:26.269928 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:06:39.165504 | 92e3138d-7cef-49a5-832a-0a910fff95b9 ==============================
[0m18:06:39.165504 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:06:39.168423 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:06:39.168849 [debug] [MainThread]: Tracking: tracking
[0m18:06:39.195478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4930b3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc48e68d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4930b38d0>]}
[0m18:06:39.210429 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:06:39.272975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:39.273642 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5yearmodel.sql
[0m18:06:39.295426 [debug] [MainThread]: 1699: static parser successfully parsed 5yearmodel.sql
[0m18:06:39.316505 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:06:39.324107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92e3138d-7cef-49a5-832a-0a910fff95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc492cff450>]}
[0m18:06:39.335051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92e3138d-7cef-49a5-832a-0a910fff95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49309d150>]}
[0m18:06:39.336093 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:06:39.336878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e3138d-7cef-49a5-832a-0a910fff95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49309da10>]}
[0m18:06:39.339010 [info ] [MainThread]: 
[0m18:06:39.341158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:39.342713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:06:39.358793 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:06:39.359253 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:06:39.359581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:39.389153 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:06:39.391119 [debug] [ThreadPool]: On list_postgres: Close
[0m18:06:39.392875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:06:39.401424 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:06:39.401927 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:06:39.402353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:39.411710 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:06:39.412228 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:06:39.412657 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:06:39.417470 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m18:06:39.419508 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:06:39.420233 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:06:39.427118 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.427589 [debug] [MainThread]: On master: BEGIN
[0m18:06:39.427989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:39.436639 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:06:39.437094 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.437571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:39.443691 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m18:06:39.445205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92e3138d-7cef-49a5-832a-0a910fff95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49317e790>]}
[0m18:06:39.445766 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:39.446356 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.446722 [debug] [MainThread]: On master: BEGIN
[0m18:06:39.447380 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:06:39.447792 [debug] [MainThread]: On master: COMMIT
[0m18:06:39.448183 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.448507 [debug] [MainThread]: On master: COMMIT
[0m18:06:39.449029 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:06:39.449490 [debug] [MainThread]: On master: Close
[0m18:06:39.450363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:39.450919 [info ] [MainThread]: 
[0m18:06:39.454665 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:06:39.455337 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:06:39.456690 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:06:39.457259 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:06:39.460194 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:06:39.461471 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:06:39.457610 => 2023-04-07 18:06:39.461284
[0m18:06:39.462467 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:06:39.519225 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:06:39.520361 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:06:39.520761 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:06:39.521187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:39.529547 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:06:39.529941 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:06:39.530215 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:06:39.534559 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:06:39.542338 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:06:39.542712 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:06:39.543624 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:06:39.562609 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:06:39.563030 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:06:39.563314 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:06:39.564329 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:06:39.570300 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:06:39.570662 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:06:39.571423 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:06:39.572802 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:06:39.462909 => 2023-04-07 18:06:39.572749
[0m18:06:39.573112 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:06:39.573951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92e3138d-7cef-49a5-832a-0a910fff95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4933ac410>]}
[0m18:06:39.574599 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m18:06:39.576285 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:06:39.576965 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:06:39.577594 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.model1 ......................................... [RUN]
[0m18:06:39.579022 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:06:39.579527 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:06:39.581651 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:06:39.582604 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:06:39.579911 => 2023-04-07 18:06:39.582449
[0m18:06:39.583052 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:06:39.590834 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:06:39.591714 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:39.592220 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:06:39.592536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:39.602714 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:06:39.603458 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:39.603925 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:06:39.607735 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:06:39.611582 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:39.611944 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:06:39.612840 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:06:39.617296 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:39.617731 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:06:39.618368 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:06:39.624968 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:06:39.625398 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:39.625682 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:06:39.626901 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:06:39.629951 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:06:39.630547 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:06:39.632749 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:06:39.634272 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:06:39.583394 => 2023-04-07 18:06:39.634215
[0m18:06:39.634709 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:06:39.635586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92e3138d-7cef-49a5-832a-0a910fff95b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4934cdfd0>]}
[0m18:06:39.636174 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:06:39.636888 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:06:39.666857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:39.667476 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.667919 [debug] [MainThread]: On master: BEGIN
[0m18:06:39.668268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:39.677905 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:06:39.678366 [debug] [MainThread]: On master: COMMIT
[0m18:06:39.678756 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.679166 [debug] [MainThread]: On master: COMMIT
[0m18:06:39.679854 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:06:39.680561 [debug] [MainThread]: On master: Close
[0m18:06:39.681812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:39.682416 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m18:06:39.683083 [info ] [MainThread]: 
[0m18:06:39.683994 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:06:39.684845 [debug] [MainThread]: Command end result
[0m18:06:39.692475 [info ] [MainThread]: 
[0m18:06:39.693269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:39.694118 [info ] [MainThread]: 
[0m18:06:39.694768 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:06:39.695531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc493554b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4935673d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4934d25d0>]}
[0m18:06:39.696089 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:08:56.713217 | bb279bde-8d75-4a49-8b8f-9aa7b64070c9 ==============================
[0m18:08:56.713217 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:08:56.716463 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:08:56.716894 [debug] [MainThread]: Tracking: tracking
[0m18:08:56.741195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7efcc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7efccb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7efccb10>]}
[0m18:08:56.756701 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:08:56.819536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:08:56.820212 [debug] [MainThread]: Partial parsing: added file: my_project://models/5Ycorrelation.sql
[0m18:08:56.839127 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:08:56.861491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:08:56.868778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb279bde-8d75-4a49-8b8f-9aa7b64070c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7ef94ad0>]}
[0m18:08:56.878610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb279bde-8d75-4a49-8b8f-9aa7b64070c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7efb6bd0>]}
[0m18:08:56.879153 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:08:56.879863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb279bde-8d75-4a49-8b8f-9aa7b64070c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7efb62d0>]}
[0m18:08:56.881948 [info ] [MainThread]: 
[0m18:08:56.884066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:56.885718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:08:56.903763 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:08:56.904301 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:08:56.904877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:56.964181 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:08:56.965871 [debug] [ThreadPool]: On list_postgres: Close
[0m18:08:56.967777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:08:56.975596 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:08:56.976037 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:08:56.976360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:56.985039 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:08:56.985515 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:08:56.985863 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:08:56.990040 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:08:56.991563 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:08:56.992210 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:08:56.998528 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:56.999044 [debug] [MainThread]: On master: BEGIN
[0m18:08:56.999418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:57.008732 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:08:57.009192 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:57.009511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:57.015629 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:08:57.017026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb279bde-8d75-4a49-8b8f-9aa7b64070c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f04b0d0>]}
[0m18:08:57.017562 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:57.018125 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:57.018452 [debug] [MainThread]: On master: BEGIN
[0m18:08:57.019143 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:08:57.019496 [debug] [MainThread]: On master: COMMIT
[0m18:08:57.019801 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:57.020093 [debug] [MainThread]: On master: COMMIT
[0m18:08:57.020629 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:08:57.021038 [debug] [MainThread]: On master: Close
[0m18:08:57.021815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:57.022437 [info ] [MainThread]: 
[0m18:08:57.025670 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:08:57.026354 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:08:57.027728 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:08:57.028227 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:08:57.031021 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:08:57.032657 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:08:57.028562 => 2023-04-07 18:08:57.032321
[0m18:08:57.033337 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:08:57.084930 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:08:57.085792 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:08:57.086148 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:08:57.086422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:57.095188 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:08:57.095601 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:08:57.095896 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(price, date) as correlation
FROM commodities2
WHERE date >= DATE_TRUNC('year', CURRENT_DATE - INTERVAL '5 years')
ORDER BY date DESC;
  );
[0m18:08:57.096921 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 7: ORDER BY date DESC;
                          ^

[0m18:08:57.097263 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: ROLLBACK
[0m18:08:57.097947 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:08:57.033709 => 2023-04-07 18:08:57.097876
[0m18:08:57.098268 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:08:57.111492 [debug] [Thread-1  ]: Database Error in model 5Ycorrelation (models/5Ycorrelation.sql)
  syntax error at or near ";"
  LINE 7: ORDER BY date DESC;
                            ^
  compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:08:57.112073 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb279bde-8d75-4a49-8b8f-9aa7b64070c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f1bf1d0>]}
[0m18:08:57.112664 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model dbt.5Ycorrelation ......................... [[31mERROR[0m in 0.08s]
[0m18:08:57.114534 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:08:57.115075 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:08:57.115788 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:08:57.116873 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:08:57.117245 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:08:57.119307 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:08:57.120006 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:08:57.117481 => 2023-04-07 18:08:57.119935
[0m18:08:57.120369 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:08:57.126548 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:08:57.127382 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:08:57.127785 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:08:57.128140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:57.138131 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:08:57.138520 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:08:57.138803 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:08:57.143518 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:08:57.151389 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:08:57.151756 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:08:57.152554 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:08:57.156441 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:08:57.156926 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:08:57.158141 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:08:57.181140 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:08:57.181732 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:08:57.182064 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:08:57.183175 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:08:57.189087 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:08:57.189498 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:08:57.191086 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:08:57.192888 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:08:57.120643 => 2023-04-07 18:08:57.192799
[0m18:08:57.193339 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:08:57.194398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb279bde-8d75-4a49-8b8f-9aa7b64070c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f381950>]}
[0m18:08:57.194999 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.08s]
[0m18:08:57.195671 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:08:57.196333 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:08:57.196848 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:08:57.197931 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:08:57.198478 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:08:57.201550 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:08:57.202321 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:08:57.198732 => 2023-04-07 18:08:57.202241
[0m18:08:57.202699 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:08:57.209124 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:08:57.209914 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:08:57.210408 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:08:57.210775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:57.221685 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:08:57.222145 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:08:57.222491 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:08:57.227317 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:08:57.231857 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:08:57.232330 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:08:57.233596 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:08:57.237670 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:08:57.238053 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:08:57.238825 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:08:57.242316 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:08:57.242860 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:08:57.243213 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:08:57.244329 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:08:57.247977 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:08:57.248379 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:08:57.250023 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:08:57.252080 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:08:57.203023 => 2023-04-07 18:08:57.251895
[0m18:08:57.252460 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:08:57.253567 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb279bde-8d75-4a49-8b8f-9aa7b64070c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f3aaf90>]}
[0m18:08:57.254380 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:08:57.255076 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:08:57.338761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:57.339812 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:57.340625 [debug] [MainThread]: On master: BEGIN
[0m18:08:57.341422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:57.357083 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:08:57.357865 [debug] [MainThread]: On master: COMMIT
[0m18:08:57.358422 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:57.358919 [debug] [MainThread]: On master: COMMIT
[0m18:08:57.359625 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:08:57.360095 [debug] [MainThread]: On master: Close
[0m18:08:57.361005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:57.361466 [debug] [MainThread]: Connection 'model.my_project.model1' was properly closed.
[0m18:08:57.361951 [info ] [MainThread]: 
[0m18:08:57.362803 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m18:08:57.363919 [debug] [MainThread]: Command end result
[0m18:08:57.373088 [info ] [MainThread]: 
[0m18:08:57.374513 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:08:57.375428 [info ] [MainThread]: 
[0m18:08:57.376468 [error] [MainThread]: [33mDatabase Error in model 5Ycorrelation (models/5Ycorrelation.sql)[0m
[0m18:08:57.377643 [error] [MainThread]:   syntax error at or near ";"
[0m18:08:57.378535 [error] [MainThread]:   LINE 7: ORDER BY date DESC;
[0m18:08:57.379490 [error] [MainThread]:                             ^
[0m18:08:57.380273 [error] [MainThread]:   compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:08:57.380961 [info ] [MainThread]: 
[0m18:08:57.381718 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:08:57.382497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f399dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7efb6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f3ad890>]}
[0m18:08:57.382963 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:13:35.580531 | 32c6d438-e7e8-4e59-9368-388b1a9ff6e0 ==============================
[0m18:13:35.580531 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:13:35.583421 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:13:35.583836 [debug] [MainThread]: Tracking: tracking
[0m18:13:35.605337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a0d4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a0d4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a0d4650>]}
[0m18:13:35.620859 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:13:35.641560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a1b4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a1c7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a1c78d0>]}
[0m18:13:35.642032 [debug] [MainThread]: Flushing usage events
[0m18:13:36.150731 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models/sources.yml is invalid because the yml property file models/sources.yml is missing a version tag. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2023-04-07 18:18:04.822313 | 8e33f6a2-c9c2-40dd-9669-da92d2cac123 ==============================
[0m18:18:04.822313 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:18:04.825938 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:18:04.826396 [debug] [MainThread]: Tracking: tracking
[0m18:18:04.850924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b77fd5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b77fd5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b77e95ad0>]}
[0m18:18:04.866817 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:18:04.886783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b780c3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b780c3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b780b4bd0>]}
[0m18:18:04.887349 [debug] [MainThread]: Flushing usage events
[0m18:18:05.946472 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models/models.yml is invalid because the yml property file models/models.yml is missing a version tag. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2023-04-07 18:18:23.101815 | ad6b9f88-3ff3-405c-b8a9-911c2cb3b076 ==============================
[0m18:18:23.101815 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:18:23.104590 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:18:23.105039 [debug] [MainThread]: Tracking: tracking
[0m18:18:23.126418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17291c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17291c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17291c510>]}
[0m18:18:23.143159 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:18:23.164708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1729f40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa172a07c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa172a07850>]}
[0m18:18:23.165193 [debug] [MainThread]: Flushing usage events
[0m18:18:23.530093 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models/models.yml is invalid because the yml property file models/models.yml is missing a version tag. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2023-04-07 18:18:36.365858 | 2757150d-8515-442b-b5fe-2743be8c8be8 ==============================
[0m18:18:36.365858 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:18:36.368120 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:18:36.368513 [debug] [MainThread]: Tracking: tracking
[0m18:18:36.389575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840cfcb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840cfcb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840cfcb890>]}
[0m18:18:36.405371 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:18:36.424218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840d0c8c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840d0ad5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f840d0adfd0>]}
[0m18:18:36.424741 [debug] [MainThread]: Flushing usage events
[0m18:18:36.797052 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: models.yml - Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | Version: 2
    2  |   sources:
    3  |     - name: 5year
    4  |       database: postgres
    5  |       schema: dbt
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 10


============================== 2023-04-07 18:19:54.839689 | 523a1620-36d2-46d6-bf7a-4c7a1c6b5410 ==============================
[0m18:19:54.839689 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:19:54.842894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:19:54.843278 [debug] [MainThread]: Tracking: tracking
[0m18:19:54.863471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822980b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822980b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f822980b610>]}
[0m18:19:54.879897 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:19:54.950373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:19:54.951059 [debug] [MainThread]: Partial parsing: added file: my_project://models/models.yml
[0m18:19:54.951516 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:19:54.972168 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:19:55.008012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82299a9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82297c44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82299af1d0>]}
[0m18:19:55.008532 [debug] [MainThread]: Flushing usage events
[0m18:19:55.291095 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.5Ycorrelation' (models/5Ycorrelation.sql) depends on a node named '5year' which was not found


============================== 2023-04-07 18:20:28.694162 | 3b1f87fc-ceb6-45fb-bee4-35c1aa789085 ==============================
[0m18:20:28.694162 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:20:28.696974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:20:28.697385 [debug] [MainThread]: Tracking: tracking
[0m18:20:28.722601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7acc6d55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7acc6d5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7acc6d5590>]}
[0m18:20:28.739033 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:20:28.811491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:20:28.813250 [debug] [MainThread]: Partial parsing: added file: my_project://models/models.yml
[0m18:20:28.813816 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:20:28.906328 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:20:29.022592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7acc718890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7acc74c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7accc2d510>]}
[0m18:20:29.024087 [debug] [MainThread]: Flushing usage events
[0m18:20:29.419645 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='models.yml', modification_time=1680891621.0531988, project_root='/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project') @ exposures: {'name': '5year'} - at path []: 'type' is a required property


============================== 2023-04-07 18:21:38.294009 | ea3e341e-64f1-48c5-a07c-b3e9abf48848 ==============================
[0m18:21:38.294009 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:21:38.299485 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:21:38.300492 [debug] [MainThread]: Tracking: tracking
[0m18:21:38.324584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6701c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6701ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6701c550>]}
[0m18:21:38.348373 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:21:38.414402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:21:38.415145 [debug] [MainThread]: Partial parsing: added file: my_project://models/models.yml
[0m18:21:38.415851 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:21:38.440837 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:21:38.481789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef672ed310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6730fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef673160d0>]}
[0m18:21:38.482399 [debug] [MainThread]: Flushing usage events
[0m18:21:38.706672 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='models.yml', modification_time=1680891692.0581691, project_root='/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project') @ exposures: {'name': '5year', 'type': 'table'} - at path []: 'owner' is a required property


============================== 2023-04-07 18:21:49.513072 | c9c4ab47-5ca7-41d9-9115-5da8b2b24a28 ==============================
[0m18:21:49.513072 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:21:49.515278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:21:49.515663 [debug] [MainThread]: Tracking: tracking
[0m18:21:49.540471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff506fdc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff506fdc450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff506fdc6d0>]}
[0m18:21:49.559671 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:21:49.629367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:21:49.630569 [debug] [MainThread]: Partial parsing: added file: my_project://models/models.yml
[0m18:21:49.631687 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:21:49.656745 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:21:49.692159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5072c6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5072b14d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5072d63d0>]}
[0m18:21:49.692641 [debug] [MainThread]: Flushing usage events
[0m18:21:49.877086 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='models.yml', modification_time=1680891702.7338371, project_root='/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project') @ exposures: {'name': '5year', 'type': 'view'} - at path []: 'owner' is a required property


============================== 2023-04-07 18:22:43.749503 | 89647db7-543a-421d-9612-7999be28ee84 ==============================
[0m18:22:43.749503 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:22:43.752347 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:22:43.752777 [debug] [MainThread]: Tracking: tracking
[0m18:22:43.774225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d530dc690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d530dc990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d530dc550>]}
[0m18:22:43.790981 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:22:43.862428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:22:43.863152 [debug] [MainThread]: Partial parsing: added file: my_project://models/models.yml
[0m18:22:43.863627 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:22:43.883370 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:22:43.916982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d531059d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d533c6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d53396d10>]}
[0m18:22:43.917497 [debug] [MainThread]: Flushing usage events
[0m18:22:44.288632 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.5Ycorrelation' (models/5Ycorrelation.sql) depends on a node named '5year' which was not found


============================== 2023-04-07 18:25:10.034402 | 26d16d4f-8943-4e79-8664-142c6a7c06eb ==============================
[0m18:25:10.034402 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:25:10.037042 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:25:10.037462 [debug] [MainThread]: Tracking: tracking
[0m18:25:10.062639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfc815110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfac435d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfa6c7310>]}
[0m18:25:10.078749 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:25:10.147908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m18:25:10.148638 [debug] [MainThread]: Partial parsing: added file: my_project://models/models.yml
[0m18:25:10.149040 [debug] [MainThread]: Partial parsing: added file: my_project://models/5coexposure.yml
[0m18:25:10.149428 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:25:10.168365 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:25:10.209194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfcc32890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfcbf0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfcbf01d0>]}
[0m18:25:10.209694 [debug] [MainThread]: Flushing usage events
[0m18:25:10.456702 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.5Ycorrelation' (models/5Ycorrelation.sql) depends on a node named '5year' which was not found


============================== 2023-04-07 18:27:30.054321 | e7ecc787-d0f0-46c7-81d2-4d593778f46f ==============================
[0m18:27:30.054321 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:27:30.056961 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:27:30.057361 [debug] [MainThread]: Tracking: tracking
[0m18:27:30.077742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f211152d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f21115950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f21115650>]}
[0m18:27:30.097853 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:27:30.164404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:27:30.165057 [debug] [MainThread]: Partial parsing: added file: my_project://models/models.yml
[0m18:27:30.165535 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:27:30.183943 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:27:30.218313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2129fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f210c6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f21115e50>]}
[0m18:27:30.218832 [debug] [MainThread]: Flushing usage events
[0m18:27:30.400982 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.5Ycorrelation' (models/5Ycorrelation.sql) depends on a node named '5year' which was not found


============================== 2023-04-07 18:29:22.747498 | c3273a1f-428f-4ada-b4a4-d73a29dcd27e ==============================
[0m18:29:22.747498 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:29:22.750547 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:29:22.750982 [debug] [MainThread]: Tracking: tracking
[0m18:29:22.777312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda980c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda980c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda980c5d0>]}
[0m18:29:22.794411 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:29:22.863228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:29:22.863910 [debug] [MainThread]: Partial parsing: added file: my_project://models/models.yml
[0m18:29:22.864412 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:29:22.888765 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:29:22.933869 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:29:22.941871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3273a1f-428f-4ada-b4a4-d73a29dcd27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda9b96090>]}
[0m18:29:22.952851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3273a1f-428f-4ada-b4a4-d73a29dcd27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda97e0b10>]}
[0m18:29:22.953791 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:29:22.954392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3273a1f-428f-4ada-b4a4-d73a29dcd27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda97e0910>]}
[0m18:29:22.956352 [info ] [MainThread]: 
[0m18:29:22.958546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:29:22.960165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:29:22.979776 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:29:22.980281 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:29:22.980923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:23.047422 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:29:23.047887 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:29:23.048232 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:29:23.056825 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:29:23.058829 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:29:23.059483 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:29:23.066837 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:23.067322 [debug] [MainThread]: On master: BEGIN
[0m18:29:23.067715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:23.075995 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:29:23.076480 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:23.076848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:29:23.099499 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:29:23.101051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3273a1f-428f-4ada-b4a4-d73a29dcd27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda988b9d0>]}
[0m18:29:23.101658 [debug] [MainThread]: On master: ROLLBACK
[0m18:29:23.102355 [debug] [MainThread]: On master: Close
[0m18:29:23.103193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:23.103831 [info ] [MainThread]: 
[0m18:29:23.106803 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:29:23.107695 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:29:23.108191 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:29:23.110185 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:29:23.112336 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:29:23.108523 => 2023-04-07 18:29:23.112177
[0m18:29:23.113128 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:29:23.113834 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:29:23.113716 => 2023-04-07 18:29:23.113746
[0m18:29:23.116292 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:29:23.117034 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:29:23.117963 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:29:23.118377 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:29:23.120515 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:29:23.122492 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:29:23.118668 => 2023-04-07 18:29:23.122330
[0m18:29:23.123035 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:29:23.123435 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:29:23.123366 => 2023-04-07 18:29:23.123378
[0m18:29:23.124286 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:29:23.124779 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:29:23.125585 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:29:23.125982 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:29:23.129576 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:29:23.130703 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:29:23.126268 => 2023-04-07 18:29:23.130524
[0m18:29:23.131343 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:29:23.131900 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:29:23.131783 => 2023-04-07 18:29:23.131800
[0m18:29:23.133290 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:29:23.207504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:23.207971 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:29:23.208581 [debug] [MainThread]: Command end result
[0m18:29:23.215351 [info ] [MainThread]: Done.
[0m18:29:23.216182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda988b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda988b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcda988bf50>]}
[0m18:29:23.216803 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:29:28.471051 | fdbdcc74-d3a3-4ac9-91a8-9cc1fd3a27d1 ==============================
[0m18:29:28.471051 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:29:28.473577 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:29:28.474010 [debug] [MainThread]: Tracking: tracking
[0m18:29:28.496685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b50f24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b50f2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b50f2650>]}
[0m18:29:28.512920 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:29:28.574229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:29:28.574683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:29:28.575713 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:29:28.585850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdbdcc74-d3a3-4ac9-91a8-9cc1fd3a27d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b4c2a350>]}
[0m18:29:28.594648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdbdcc74-d3a3-4ac9-91a8-9cc1fd3a27d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b50c5790>]}
[0m18:29:28.595234 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:29:28.595986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdbdcc74-d3a3-4ac9-91a8-9cc1fd3a27d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b50c54d0>]}
[0m18:29:28.598402 [info ] [MainThread]: 
[0m18:29:28.600794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:29:28.602458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:29:28.619640 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:29:28.620100 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:29:28.620468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:28.645581 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:29:28.648157 [debug] [ThreadPool]: On list_postgres: Close
[0m18:29:28.650033 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:29:28.658095 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:29:28.658506 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:29:28.658863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:29:28.666905 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:29:28.667377 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:29:28.667747 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:29:28.671994 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:29:28.673821 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:29:28.674523 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:29:28.681591 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:28.682059 [debug] [MainThread]: On master: BEGIN
[0m18:29:28.682429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:28.691116 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:29:28.691568 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:28.691921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:29:28.698060 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:29:28.699543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdbdcc74-d3a3-4ac9-91a8-9cc1fd3a27d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b515b750>]}
[0m18:29:28.700161 [debug] [MainThread]: On master: ROLLBACK
[0m18:29:28.700844 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:28.701220 [debug] [MainThread]: On master: BEGIN
[0m18:29:28.701823 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:29:28.702217 [debug] [MainThread]: On master: COMMIT
[0m18:29:28.702563 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:28.702876 [debug] [MainThread]: On master: COMMIT
[0m18:29:28.703401 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:29:28.703764 [debug] [MainThread]: On master: Close
[0m18:29:28.704508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:28.705059 [info ] [MainThread]: 
[0m18:29:28.708338 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:29:28.708975 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:29:28.710017 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:29:28.710509 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:29:28.712646 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:29:28.713963 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:29:28.710880 => 2023-04-07 18:29:28.713619
[0m18:29:28.714706 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:29:28.772356 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:29:28.773200 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:29:28.773741 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:29:28.774055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:28.784102 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:29:28.784535 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:29:28.784844 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:29:28.792804 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:29:28.801693 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:29:28.802137 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:29:28.803185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:29:28.807246 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:29:28.807672 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:29:28.808709 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:29:28.835016 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:29:28.835464 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:29:28.835822 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:29:28.836921 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:29:28.845500 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:29:28.845942 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:29:28.848293 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:29:28.850045 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:29:28.715165 => 2023-04-07 18:29:28.849955
[0m18:29:28.850553 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:29:28.851657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdbdcc74-d3a3-4ac9-91a8-9cc1fd3a27d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b54b5bd0>]}
[0m18:29:28.852375 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:29:28.854531 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:29:28.855558 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:29:28.856363 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:29:28.857532 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:29:28.858170 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:29:28.860408 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:29:28.861299 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:29:28.858583 => 2023-04-07 18:29:28.861196
[0m18:29:28.861812 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:29:28.870896 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:29:28.872075 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:29:28.872534 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:29:28.872858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:28.884818 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:29:28.885380 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:29:28.885730 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:29:28.888792 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:29:28.892512 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:29:28.893089 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:29:28.894284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:29:28.898629 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:29:28.899043 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:29:28.900041 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:29:28.903181 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:29:28.903607 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:29:28.903943 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:29:28.904898 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:29:28.908113 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:29:28.908505 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:29:28.910406 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:29:28.912823 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:29:28.862401 => 2023-04-07 18:29:28.912740
[0m18:29:28.913436 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:29:28.914388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdbdcc74-d3a3-4ac9-91a8-9cc1fd3a27d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b5139ad0>]}
[0m18:29:28.915165 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:29:28.916269 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:29:28.916815 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:29:28.917266 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:29:28.918312 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:29:28.918775 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:29:28.922091 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:29:28.923065 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:29:28.919068 => 2023-04-07 18:29:28.922946
[0m18:29:28.923594 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:29:28.931031 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:29:28.932695 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:29:28.933292 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:29:28.933788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:28.953713 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:29:28.954194 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:29:28.954547 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    -- SELECT corr(price, date) as correlation
-- FROM commodities2
-- SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
-- ORDER BY month DESC

SELECT *
FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:29:28.961812 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:29:28.967720 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:29:28.968126 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:29:28.969136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:29:28.971648 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:29:28.972069 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:29:28.972414 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:29:28.973449 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:29:28.976853 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:29:28.977334 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:29:28.978170 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:29:28.979876 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:29:28.924067 => 2023-04-07 18:29:28.979794
[0m18:29:28.980310 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:29:28.981278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdbdcc74-d3a3-4ac9-91a8-9cc1fd3a27d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b54f1690>]}
[0m18:29:28.981934 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:29:28.982658 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:29:29.031757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:29:29.032333 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:29.032775 [debug] [MainThread]: On master: BEGIN
[0m18:29:29.033116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:29:29.042910 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:29:29.043376 [debug] [MainThread]: On master: COMMIT
[0m18:29:29.043712 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:29.044035 [debug] [MainThread]: On master: COMMIT
[0m18:29:29.044638 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:29:29.045061 [debug] [MainThread]: On master: Close
[0m18:29:29.045901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:29.046239 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:29:29.046585 [info ] [MainThread]: 
[0m18:29:29.047132 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m18:29:29.047963 [debug] [MainThread]: Command end result
[0m18:29:29.057491 [info ] [MainThread]: 
[0m18:29:29.058362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:29.059097 [info ] [MainThread]: 
[0m18:29:29.059905 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:29:29.060611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b5167290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b5509e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6b5509350>]}
[0m18:29:29.061160 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:30:32.638248 | b4e85497-f89b-46b1-970c-86fcfc590bbb ==============================
[0m18:30:32.638248 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:30:32.640986 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:30:32.641445 [debug] [MainThread]: Tracking: tracking
[0m18:30:32.665648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef0ebb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef0ebb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef0ebb910>]}
[0m18:30:32.682232 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:30:32.731882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:32.732591 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:30:32.749603 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:30:32.772085 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:30:32.779109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4e85497-f89b-46b1-970c-86fcfc590bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef100e490>]}
[0m18:30:32.789028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4e85497-f89b-46b1-970c-86fcfc590bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef1049290>]}
[0m18:30:32.789691 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:30:32.790392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4e85497-f89b-46b1-970c-86fcfc590bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef1049a10>]}
[0m18:30:32.792171 [info ] [MainThread]: 
[0m18:30:32.794510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:30:32.795989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:30:32.811970 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:30:32.812429 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:30:32.812784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:32.856595 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:30:32.858585 [debug] [ThreadPool]: On list_postgres: Close
[0m18:30:32.860398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:30:32.868026 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:30:32.868598 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:30:32.868958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:32.878208 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:30:32.878686 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:30:32.879054 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:30:32.882850 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:30:32.884610 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:30:32.885277 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:30:32.892562 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:32.893102 [debug] [MainThread]: On master: BEGIN
[0m18:30:32.893553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:32.901838 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:30:32.902279 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:32.902655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:30:32.911413 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:30:32.913065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4e85497-f89b-46b1-970c-86fcfc590bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef10a6e90>]}
[0m18:30:32.913680 [debug] [MainThread]: On master: ROLLBACK
[0m18:30:32.914400 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:32.914824 [debug] [MainThread]: On master: BEGIN
[0m18:30:32.915603 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:30:32.916111 [debug] [MainThread]: On master: COMMIT
[0m18:30:32.916450 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:32.916751 [debug] [MainThread]: On master: COMMIT
[0m18:30:32.917373 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:30:32.917835 [debug] [MainThread]: On master: Close
[0m18:30:32.918611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:32.919193 [info ] [MainThread]: 
[0m18:30:32.922044 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:30:32.922688 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:30:32.923804 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:30:32.924320 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:30:32.927186 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:30:32.928092 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:30:32.924675 => 2023-04-07 18:30:32.927942
[0m18:30:32.928710 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:30:32.985545 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:30:32.986575 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:32.986970 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:30:32.987421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:30:32.996236 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:30:32.996659 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:32.996997 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:30:33.002169 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:30:33.010744 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:33.011192 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:30:33.012259 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:30:33.015920 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:33.016396 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:30:33.017268 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:30:33.042797 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:30:33.043183 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:33.043470 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:30:33.044529 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:30:33.051390 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:33.051899 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:30:33.055638 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:30:33.057298 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:30:32.929167 => 2023-04-07 18:30:33.057232
[0m18:30:33.057723 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:30:33.058638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e85497-f89b-46b1-970c-86fcfc590bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef144a7d0>]}
[0m18:30:33.059272 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:30:33.061054 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:30:33.061666 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:30:33.062237 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:30:33.063521 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:30:33.064065 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:30:33.066190 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:30:33.067071 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:30:33.064385 => 2023-04-07 18:30:33.066957
[0m18:30:33.067578 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:30:33.074836 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:30:33.075902 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:33.076314 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:30:33.076775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:30:33.084918 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:30:33.085367 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:33.085688 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:30:33.089710 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:30:33.094833 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:33.095252 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:30:33.096163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:30:33.099974 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:33.100388 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:30:33.101349 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:30:33.105364 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:30:33.105796 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:33.106091 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:30:33.107054 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:30:33.110216 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:33.110645 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:30:33.112290 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:30:33.114003 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:30:33.067899 => 2023-04-07 18:30:33.113939
[0m18:30:33.114466 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:30:33.115454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e85497-f89b-46b1-970c-86fcfc590bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef144a410>]}
[0m18:30:33.116062 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:30:33.116730 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:30:33.117475 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:30:33.118065 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:30:33.119178 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:30:33.119690 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:30:33.123131 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:30:33.124142 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:30:33.119992 => 2023-04-07 18:30:33.123981
[0m18:30:33.125194 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:30:33.132031 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:30:33.133173 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:30:33.133603 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:30:33.133952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:30:33.142945 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:30:33.143518 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:30:33.144000 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(price, date) as correlation
FROM "postgres"."dbt"."5yearmodel"
ORDER BY month DESC
  );
[0m18:30:33.145151 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 4:     SELECT corr(price, date) as correlation
                               ^

[0m18:30:33.145539 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: ROLLBACK
[0m18:30:33.146242 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:30:33.125693 => 2023-04-07 18:30:33.146116
[0m18:30:33.146694 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:30:33.159934 [debug] [Thread-1  ]: Database Error in model 5Ycorrelation (models/5Ycorrelation.sql)
  column "date" does not exist
  LINE 4:     SELECT corr(price, date) as correlation
                                 ^
  compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:30:33.160464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e85497-f89b-46b1-970c-86fcfc590bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef0e8b9d0>]}
[0m18:30:33.161227 [error] [Thread-1  ]: 3 of 3 ERROR creating sql view model dbt.5Ycorrelation ......................... [[31mERROR[0m in 0.04s]
[0m18:30:33.161984 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:30:33.238442 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:30:33.238969 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:33.239276 [debug] [MainThread]: On master: BEGIN
[0m18:30:33.239558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:33.248444 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:30:33.249036 [debug] [MainThread]: On master: COMMIT
[0m18:30:33.249650 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:33.250099 [debug] [MainThread]: On master: COMMIT
[0m18:30:33.250893 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:30:33.251326 [debug] [MainThread]: On master: Close
[0m18:30:33.252085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:33.252435 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:30:33.252807 [info ] [MainThread]: 
[0m18:30:33.253414 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m18:30:33.254266 [debug] [MainThread]: Command end result
[0m18:30:33.263070 [info ] [MainThread]: 
[0m18:30:33.264138 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:30:33.264830 [info ] [MainThread]: 
[0m18:30:33.265503 [error] [MainThread]: [33mDatabase Error in model 5Ycorrelation (models/5Ycorrelation.sql)[0m
[0m18:30:33.266319 [error] [MainThread]:   column "date" does not exist
[0m18:30:33.266959 [error] [MainThread]:   LINE 4:     SELECT corr(price, date) as correlation
[0m18:30:33.267586 [error] [MainThread]:                                  ^
[0m18:30:33.268190 [error] [MainThread]:   compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:30:33.268933 [info ] [MainThread]: 
[0m18:30:33.269628 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:30:33.270500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef10a6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef14620d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef12cbf10>]}
[0m18:30:33.271038 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:30:43.986547 | ab084fb6-18c0-4e2d-9e9a-4cbaa00908a2 ==============================
[0m18:30:43.986547 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:30:43.988961 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:30:43.989431 [debug] [MainThread]: Tracking: tracking
[0m18:30:44.012547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b10c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9aee2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9aebcb50>]}
[0m18:30:44.029613 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:30:44.064386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:44.065095 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:30:44.083024 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:30:44.107652 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:30:44.115378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab084fb6-18c0-4e2d-9e9a-4cbaa00908a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b14f8d0>]}
[0m18:30:44.124663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab084fb6-18c0-4e2d-9e9a-4cbaa00908a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b18a410>]}
[0m18:30:44.125326 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:30:44.125919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab084fb6-18c0-4e2d-9e9a-4cbaa00908a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b18abd0>]}
[0m18:30:44.128003 [info ] [MainThread]: 
[0m18:30:44.130618 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:30:44.132543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:30:44.148808 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:30:44.149338 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:30:44.150140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:44.171469 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:30:44.173347 [debug] [ThreadPool]: On list_postgres: Close
[0m18:30:44.175440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:30:44.184596 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:30:44.185008 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:30:44.185457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:44.194137 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:30:44.194602 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:30:44.195001 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:30:44.199006 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:30:44.200588 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:30:44.201320 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:30:44.208295 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:44.208711 [debug] [MainThread]: On master: BEGIN
[0m18:30:44.209044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:44.217904 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:30:44.218364 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:44.218720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:30:44.224013 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:30:44.225570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab084fb6-18c0-4e2d-9e9a-4cbaa00908a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b1aa310>]}
[0m18:30:44.226173 [debug] [MainThread]: On master: ROLLBACK
[0m18:30:44.226872 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:44.227236 [debug] [MainThread]: On master: BEGIN
[0m18:30:44.228095 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:30:44.228529 [debug] [MainThread]: On master: COMMIT
[0m18:30:44.228942 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:44.229269 [debug] [MainThread]: On master: COMMIT
[0m18:30:44.229811 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:30:44.230197 [debug] [MainThread]: On master: Close
[0m18:30:44.230965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:44.231549 [info ] [MainThread]: 
[0m18:30:44.233891 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:30:44.234544 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:30:44.235656 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:30:44.236209 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:30:44.239124 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:30:44.240053 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:30:44.236571 => 2023-04-07 18:30:44.239908
[0m18:30:44.240604 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:30:44.297561 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:30:44.298474 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:44.298856 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:30:44.299182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:30:44.308754 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:30:44.309186 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:44.309523 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:30:44.312820 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:30:44.321453 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:44.321851 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:30:44.322761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:30:44.326562 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:44.326951 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:30:44.327738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:30:44.354063 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:30:44.354466 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:44.354772 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:30:44.355875 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:30:44.362998 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:30:44.363382 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:30:44.365161 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:30:44.366851 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:30:44.241039 => 2023-04-07 18:30:44.366773
[0m18:30:44.367263 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:30:44.368126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab084fb6-18c0-4e2d-9e9a-4cbaa00908a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b2f27d0>]}
[0m18:30:44.368742 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:30:44.370703 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:30:44.371299 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:30:44.371856 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:30:44.373172 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:30:44.373751 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:30:44.376056 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:30:44.376905 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:30:44.374132 => 2023-04-07 18:30:44.376783
[0m18:30:44.377411 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:30:44.385364 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:30:44.386255 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:44.386672 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:30:44.386982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:30:44.395977 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:30:44.396628 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:44.397136 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:30:44.400557 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:30:44.405967 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:44.406356 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:30:44.407296 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:30:44.411214 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:44.411679 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:30:44.412857 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:30:44.416122 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:30:44.416528 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:44.416828 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:30:44.417901 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:30:44.421366 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:30:44.421750 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:30:44.423472 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:30:44.425160 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:30:44.377862 => 2023-04-07 18:30:44.425100
[0m18:30:44.425556 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:30:44.426391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab084fb6-18c0-4e2d-9e9a-4cbaa00908a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b4faf50>]}
[0m18:30:44.426978 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:30:44.427771 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:30:44.428495 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:30:44.429203 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:30:44.430997 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:30:44.431657 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:30:44.435082 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:30:44.435821 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:30:44.431959 => 2023-04-07 18:30:44.435707
[0m18:30:44.436283 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:30:44.442680 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:30:44.443501 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:30:44.443919 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:30:44.444313 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:30:44.454614 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:30:44.455006 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:30:44.455297 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(price, month) as correlation
FROM "postgres"."dbt"."5yearmodel"
ORDER BY month DESC
  );
[0m18:30:44.457730 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function corr(double precision, date) does not exist
LINE 4:     SELECT corr(price, month) as correlation
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:30:44.458290 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: ROLLBACK
[0m18:30:44.459152 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:30:44.436623 => 2023-04-07 18:30:44.459050
[0m18:30:44.459546 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:30:44.462189 [debug] [Thread-1  ]: Database Error in model 5Ycorrelation (models/5Ycorrelation.sql)
  function corr(double precision, date) does not exist
  LINE 4:     SELECT corr(price, month) as correlation
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:30:44.462989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab084fb6-18c0-4e2d-9e9a-4cbaa00908a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b453210>]}
[0m18:30:44.463932 [error] [Thread-1  ]: 3 of 3 ERROR creating sql view model dbt.5Ycorrelation ......................... [[31mERROR[0m in 0.03s]
[0m18:30:44.465067 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:30:44.550545 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:30:44.551051 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:44.551482 [debug] [MainThread]: On master: BEGIN
[0m18:30:44.551842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:44.560167 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:30:44.560675 [debug] [MainThread]: On master: COMMIT
[0m18:30:44.561094 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:44.561460 [debug] [MainThread]: On master: COMMIT
[0m18:30:44.561987 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:30:44.562355 [debug] [MainThread]: On master: Close
[0m18:30:44.563128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:44.563670 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:30:44.564127 [info ] [MainThread]: 
[0m18:30:44.564832 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m18:30:44.565843 [debug] [MainThread]: Command end result
[0m18:30:44.573321 [info ] [MainThread]: 
[0m18:30:44.574046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:30:44.574713 [info ] [MainThread]: 
[0m18:30:44.575483 [error] [MainThread]: [33mDatabase Error in model 5Ycorrelation (models/5Ycorrelation.sql)[0m
[0m18:30:44.576198 [error] [MainThread]:   function corr(double precision, date) does not exist
[0m18:30:44.576862 [error] [MainThread]:   LINE 4:     SELECT corr(price, month) as correlation
[0m18:30:44.577520 [error] [MainThread]:                      ^
[0m18:30:44.578201 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:30:44.578822 [error] [MainThread]:   compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:30:44.579417 [info ] [MainThread]: 
[0m18:30:44.580060 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:30:44.581120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b19fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b442d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9b1c2610>]}
[0m18:30:44.581625 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:31:35.991625 | a88a4152-efbc-4371-bb70-4f91c26cfc98 ==============================
[0m18:31:35.991625 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:31:35.994078 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:31:35.994487 [debug] [MainThread]: Tracking: tracking
[0m18:31:36.016204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79822590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce772a6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79822790>]}
[0m18:31:36.032267 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:31:36.063737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:36.064401 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:31:36.081684 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:31:36.102619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:31:36.110689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88a4152-efbc-4371-bb70-4f91c26cfc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79855110>]}
[0m18:31:36.123157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88a4152-efbc-4371-bb70-4f91c26cfc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7988a750>]}
[0m18:31:36.123783 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:31:36.124755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88a4152-efbc-4371-bb70-4f91c26cfc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7988ab90>]}
[0m18:31:36.127042 [info ] [MainThread]: 
[0m18:31:36.131184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:31:36.133482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:31:36.152557 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:31:36.153178 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:31:36.153738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:36.185530 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:31:36.187424 [debug] [ThreadPool]: On list_postgres: Close
[0m18:31:36.189690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:31:36.198211 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:31:36.198696 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:31:36.199041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:36.208208 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:31:36.208939 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:31:36.209713 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:31:36.215258 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:31:36.216961 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:31:36.217570 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:31:36.224482 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:36.224893 [debug] [MainThread]: On master: BEGIN
[0m18:31:36.225203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:36.234319 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:31:36.234853 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:36.235161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:36.240156 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:31:36.241497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88a4152-efbc-4371-bb70-4f91c26cfc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce798c4390>]}
[0m18:31:36.241964 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:36.242514 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:36.242854 [debug] [MainThread]: On master: BEGIN
[0m18:31:36.243587 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:31:36.243932 [debug] [MainThread]: On master: COMMIT
[0m18:31:36.244252 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:36.244528 [debug] [MainThread]: On master: COMMIT
[0m18:31:36.244977 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:31:36.245304 [debug] [MainThread]: On master: Close
[0m18:31:36.246014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:36.246575 [info ] [MainThread]: 
[0m18:31:36.249622 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:31:36.250296 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:31:36.251442 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:31:36.251980 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:31:36.255061 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:31:36.256139 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:31:36.252310 => 2023-04-07 18:31:36.255957
[0m18:31:36.256841 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:31:36.309446 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:31:36.310320 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:31:36.310623 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:31:36.310891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:36.319410 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:31:36.319824 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:31:36.320202 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:31:36.323024 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:31:36.330311 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:31:36.330749 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:31:36.331799 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:36.335479 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:31:36.336010 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:31:36.336870 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:36.360767 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:31:36.361176 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:31:36.361452 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:31:36.364588 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:31:36.371460 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:31:36.371833 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:31:36.373554 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:31:36.375036 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:31:36.257615 => 2023-04-07 18:31:36.374979
[0m18:31:36.375403 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:31:36.376445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88a4152-efbc-4371-bb70-4f91c26cfc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79b54590>]}
[0m18:31:36.377163 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:31:36.378952 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:31:36.379526 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:31:36.380431 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:31:36.381530 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:31:36.381949 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:31:36.384090 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:31:36.384895 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:31:36.382220 => 2023-04-07 18:31:36.384812
[0m18:31:36.385438 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:31:36.392837 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:31:36.393753 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:31:36.394288 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:31:36.394701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:36.403895 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:31:36.404428 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:31:36.404795 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:31:36.407478 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:31:36.412660 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:31:36.413190 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:31:36.414337 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:36.418125 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:31:36.418477 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:31:36.419219 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:36.421737 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:31:36.422051 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:31:36.422376 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:31:36.423340 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:31:36.426092 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:31:36.426648 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:31:36.428400 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:31:36.430666 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:31:36.385769 => 2023-04-07 18:31:36.430600
[0m18:31:36.431206 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:31:36.432290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88a4152-efbc-4371-bb70-4f91c26cfc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79b54190>]}
[0m18:31:36.432928 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:31:36.433599 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:31:36.434076 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:31:36.434599 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:31:36.435703 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:31:36.436209 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:31:36.439271 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:31:36.440049 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:31:36.436484 => 2023-04-07 18:31:36.439967
[0m18:31:36.440424 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:31:36.447385 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:31:36.448272 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:31:36.448698 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:31:36.448968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:36.458974 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:31:36.459489 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:31:36.459850 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), month) as correlation
FROM "postgres"."dbt"."5yearmodel"
ORDER BY month DESC
  );
[0m18:31:36.462632 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function corr(numeric, date) does not exist
LINE 4:     SELECT corr(CAST(price AS numeric), month) as correlatio...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:31:36.463141 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: ROLLBACK
[0m18:31:36.464200 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:31:36.440658 => 2023-04-07 18:31:36.464039
[0m18:31:36.464681 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:31:36.467267 [debug] [Thread-1  ]: Database Error in model 5Ycorrelation (models/5Ycorrelation.sql)
  function corr(numeric, date) does not exist
  LINE 4:     SELECT corr(CAST(price AS numeric), month) as correlatio...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:31:36.468056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88a4152-efbc-4371-bb70-4f91c26cfc98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79c04190>]}
[0m18:31:36.468590 [error] [Thread-1  ]: 3 of 3 ERROR creating sql view model dbt.5Ycorrelation ......................... [[31mERROR[0m in 0.03s]
[0m18:31:36.469214 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:31:36.564300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:31:36.565959 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:36.566898 [debug] [MainThread]: On master: BEGIN
[0m18:31:36.567669 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:36.584544 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:31:36.585377 [debug] [MainThread]: On master: COMMIT
[0m18:31:36.586004 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:36.586531 [debug] [MainThread]: On master: COMMIT
[0m18:31:36.587253 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:31:36.587803 [debug] [MainThread]: On master: Close
[0m18:31:36.589243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:36.589961 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:31:36.590578 [info ] [MainThread]: 
[0m18:31:36.591489 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m18:31:36.592665 [debug] [MainThread]: Command end result
[0m18:31:36.603133 [info ] [MainThread]: 
[0m18:31:36.604073 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:31:36.604947 [info ] [MainThread]: 
[0m18:31:36.605655 [error] [MainThread]: [33mDatabase Error in model 5Ycorrelation (models/5Ycorrelation.sql)[0m
[0m18:31:36.606284 [error] [MainThread]:   function corr(numeric, date) does not exist
[0m18:31:36.606871 [error] [MainThread]:   LINE 4:     SELECT corr(CAST(price AS numeric), month) as correlatio...
[0m18:31:36.607540 [error] [MainThread]:                      ^
[0m18:31:36.608285 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:31:36.608862 [error] [MainThread]:   compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:31:36.609512 [info ] [MainThread]: 
[0m18:31:36.610196 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:31:36.610975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79b8d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce798c4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79897e50>]}
[0m18:31:36.611575 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:32:01.000981 | a50900a2-e0fc-493e-8ac0-778cce21c08e ==============================
[0m18:32:01.000981 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:32:01.003818 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:32:01.004172 [debug] [MainThread]: Tracking: tracking
[0m18:32:01.037231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83900d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83900d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe838fbb610>]}
[0m18:32:01.052656 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:32:01.119749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:32:01.120491 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:32:01.140179 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:32:01.164257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:32:01.171654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a50900a2-e0fc-493e-8ac0-778cce21c08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe838c7f4d0>]}
[0m18:32:01.181419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a50900a2-e0fc-493e-8ac0-778cce21c08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe839088490>]}
[0m18:32:01.182162 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:32:01.183527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50900a2-e0fc-493e-8ac0-778cce21c08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe839088ad0>]}
[0m18:32:01.185998 [info ] [MainThread]: 
[0m18:32:01.188406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:32:01.190113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:32:01.209914 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:32:01.210510 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:32:01.210955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:01.265891 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:32:01.267832 [debug] [ThreadPool]: On list_postgres: Close
[0m18:32:01.269735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:32:01.277272 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:32:01.277657 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:32:01.277948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:01.287694 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:32:01.288151 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:32:01.288490 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:32:01.292070 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:32:01.293527 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:32:01.294086 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:32:01.300503 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.300891 [debug] [MainThread]: On master: BEGIN
[0m18:32:01.301227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:01.310160 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:32:01.310631 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.310927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:32:01.316505 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:32:01.318029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50900a2-e0fc-493e-8ac0-778cce21c08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8391ab390>]}
[0m18:32:01.318516 [debug] [MainThread]: On master: ROLLBACK
[0m18:32:01.319097 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.319397 [debug] [MainThread]: On master: BEGIN
[0m18:32:01.320042 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:32:01.320381 [debug] [MainThread]: On master: COMMIT
[0m18:32:01.320675 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.320943 [debug] [MainThread]: On master: COMMIT
[0m18:32:01.321392 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:32:01.321781 [debug] [MainThread]: On master: Close
[0m18:32:01.322500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:01.323055 [info ] [MainThread]: 
[0m18:32:01.326728 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:32:01.327319 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:32:01.328413 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:32:01.328816 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:32:01.331456 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:32:01.332414 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:32:01.329165 => 2023-04-07 18:32:01.332279
[0m18:32:01.332986 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:32:01.386300 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:32:01.387055 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:01.387415 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:32:01.387673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:01.396772 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:32:01.397152 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:01.397425 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:32:01.400680 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:32:01.408678 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:01.409037 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:32:01.409837 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:01.413079 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:01.413436 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:32:01.414194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:01.436022 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:32:01.436548 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:01.436829 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:32:01.438066 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:32:01.444841 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:01.445368 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:32:01.447079 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:32:01.448559 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:32:01.333475 => 2023-04-07 18:32:01.448502
[0m18:32:01.448884 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:32:01.449751 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50900a2-e0fc-493e-8ac0-778cce21c08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe839337850>]}
[0m18:32:01.450511 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m18:32:01.452266 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:32:01.452832 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:32:01.453751 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:32:01.454853 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:32:01.455383 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:32:01.457460 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:32:01.458341 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:32:01.455701 => 2023-04-07 18:32:01.458224
[0m18:32:01.458740 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:32:01.467147 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:32:01.467928 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:01.468230 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:32:01.468482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:01.477383 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:32:01.477936 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:01.478403 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:32:01.481741 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:32:01.487270 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:01.487728 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:32:01.489298 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:01.492453 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:01.492754 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:32:01.493546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:01.497042 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:32:01.497538 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:01.497863 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:32:01.498725 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:32:01.501793 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:01.502127 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:32:01.503836 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:32:01.505383 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:32:01.458984 => 2023-04-07 18:32:01.505327
[0m18:32:01.505860 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:32:01.506630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50900a2-e0fc-493e-8ac0-778cce21c08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe839337610>]}
[0m18:32:01.507273 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:32:01.507895 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:32:01.508448 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:32:01.508866 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:32:01.509812 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:32:01.510205 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:32:01.513997 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:32:01.515066 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:32:01.510454 => 2023-04-07 18:32:01.514956
[0m18:32:01.515520 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:32:01.522235 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:32:01.522978 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:32:01.523342 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:32:01.523625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:01.532949 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:32:01.533337 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:32:01.533678 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"
ORDER BY month DESC
  );
[0m18:32:01.544110 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "5yearmodel.month" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6: ORDER BY month DESC
                 ^

[0m18:32:01.544711 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: ROLLBACK
[0m18:32:01.545886 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:32:01.515791 => 2023-04-07 18:32:01.545726
[0m18:32:01.546480 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:32:01.558655 [debug] [Thread-1  ]: Database Error in model 5Ycorrelation (models/5Ycorrelation.sql)
  column "5yearmodel.month" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6: ORDER BY month DESC
                   ^
  compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:32:01.559275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50900a2-e0fc-493e-8ac0-778cce21c08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83951f1d0>]}
[0m18:32:01.559871 [error] [Thread-1  ]: 3 of 3 ERROR creating sql view model dbt.5Ycorrelation ......................... [[31mERROR[0m in 0.05s]
[0m18:32:01.560492 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:32:01.645965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:32:01.647104 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.647941 [debug] [MainThread]: On master: BEGIN
[0m18:32:01.648687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:01.674055 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:32:01.674796 [debug] [MainThread]: On master: COMMIT
[0m18:32:01.675329 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.675981 [debug] [MainThread]: On master: COMMIT
[0m18:32:01.676790 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:32:01.677293 [debug] [MainThread]: On master: Close
[0m18:32:01.678242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:01.678715 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:32:01.679671 [info ] [MainThread]: 
[0m18:32:01.680393 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m18:32:01.681509 [debug] [MainThread]: Command end result
[0m18:32:01.690156 [info ] [MainThread]: 
[0m18:32:01.690902 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:32:01.691519 [info ] [MainThread]: 
[0m18:32:01.692130 [error] [MainThread]: [33mDatabase Error in model 5Ycorrelation (models/5Ycorrelation.sql)[0m
[0m18:32:01.692744 [error] [MainThread]:   column "5yearmodel.month" must appear in the GROUP BY clause or be used in an aggregate function
[0m18:32:01.693347 [error] [MainThread]:   LINE 6: ORDER BY month DESC
[0m18:32:01.693948 [error] [MainThread]:                    ^
[0m18:32:01.694530 [error] [MainThread]:   compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:32:01.695160 [info ] [MainThread]: 
[0m18:32:01.696107 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:32:01.697266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8390e4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83953b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe839469c90>]}
[0m18:32:01.698615 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:32:12.135454 | b27b9e5d-42c9-4e76-877f-468150755829 ==============================
[0m18:32:12.135454 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:32:12.137798 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:32:12.138165 [debug] [MainThread]: Tracking: tracking
[0m18:32:12.158992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c4fd7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c265ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c4fd7450>]}
[0m18:32:12.177240 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:32:12.242513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:32:12.243360 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:32:12.259162 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:32:12.281705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:32:12.289088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b27b9e5d-42c9-4e76-877f-468150755829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c500e2d0>]}
[0m18:32:12.299108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b27b9e5d-42c9-4e76-877f-468150755829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c5042350>]}
[0m18:32:12.299853 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:32:12.300479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b27b9e5d-42c9-4e76-877f-468150755829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c5042990>]}
[0m18:32:12.302851 [info ] [MainThread]: 
[0m18:32:12.305217 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:32:12.307085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:32:12.325952 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:32:12.326440 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:32:12.327018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:12.359828 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:32:12.361704 [debug] [ThreadPool]: On list_postgres: Close
[0m18:32:12.363619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:32:12.372130 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:32:12.372799 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:32:12.373280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:12.382240 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:32:12.382760 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:32:12.383113 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:32:12.387345 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:32:12.388966 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:32:12.389815 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:32:12.396543 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:12.397002 [debug] [MainThread]: On master: BEGIN
[0m18:32:12.397357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:12.405737 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:32:12.406232 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:12.406568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:32:12.412407 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:32:12.413872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b27b9e5d-42c9-4e76-877f-468150755829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c515d850>]}
[0m18:32:12.414473 [debug] [MainThread]: On master: ROLLBACK
[0m18:32:12.415113 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:12.415448 [debug] [MainThread]: On master: BEGIN
[0m18:32:12.416290 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:32:12.416841 [debug] [MainThread]: On master: COMMIT
[0m18:32:12.417242 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:12.417607 [debug] [MainThread]: On master: COMMIT
[0m18:32:12.418268 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:32:12.418645 [debug] [MainThread]: On master: Close
[0m18:32:12.419400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:12.419996 [info ] [MainThread]: 
[0m18:32:12.422857 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:32:12.423496 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:32:12.424583 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:32:12.425034 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:32:12.427657 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:32:12.428983 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:32:12.425353 => 2023-04-07 18:32:12.428770
[0m18:32:12.429696 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:32:12.482241 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:32:12.483010 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:12.483324 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:32:12.483590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:12.492748 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:32:12.493142 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:12.493420 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:32:12.496765 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:32:12.503965 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:12.504460 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:32:12.505560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:12.509292 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:12.509655 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:32:12.510412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:12.532599 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:32:12.533014 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:12.533293 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:32:12.534377 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:32:12.541000 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:32:12.541379 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:32:12.543023 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:32:12.544591 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:32:12.430270 => 2023-04-07 18:32:12.544534
[0m18:32:12.544926 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:32:12.545782 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27b9e5d-42c9-4e76-877f-468150755829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c530c550>]}
[0m18:32:12.546400 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m18:32:12.548087 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:32:12.548640 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:32:12.549339 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:32:12.550711 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:32:12.551284 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:32:12.553269 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:32:12.554166 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:32:12.551551 => 2023-04-07 18:32:12.554065
[0m18:32:12.554597 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:32:12.562519 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:32:12.563602 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:12.563951 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:32:12.564225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:12.573660 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:32:12.574119 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:12.574753 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:32:12.578002 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:32:12.583011 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:12.583390 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:32:12.584254 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:12.587839 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:12.588459 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:32:12.589568 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:12.592476 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:32:12.592906 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:12.593362 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:32:12.594477 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:32:12.597154 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:32:12.597535 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:32:12.599414 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:32:12.600793 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:32:12.554920 => 2023-04-07 18:32:12.600736
[0m18:32:12.601117 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:32:12.601888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27b9e5d-42c9-4e76-877f-468150755829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c530c190>]}
[0m18:32:12.602469 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:32:12.603114 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:32:12.603717 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:32:12.604253 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:32:12.605421 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:32:12.606252 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:32:12.609956 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:32:12.610824 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:32:12.606746 => 2023-04-07 18:32:12.610735
[0m18:32:12.611214 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:32:12.617097 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:32:12.618003 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:32:12.618320 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:32:12.618607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:12.629172 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:32:12.629664 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:32:12.629975 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:32:12.633470 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:32:12.637028 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:32:12.637538 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:32:12.638575 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:32:12.641486 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:32:12.641900 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:32:12.642201 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:32:12.643156 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:32:12.646141 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:32:12.646502 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:32:12.647167 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:32:12.648665 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:32:12.611458 => 2023-04-07 18:32:12.648610
[0m18:32:12.648995 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:32:12.649748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27b9e5d-42c9-4e76-877f-468150755829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c500e090>]}
[0m18:32:12.650350 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m18:32:12.651003 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:32:12.743762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:32:12.745234 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:12.746077 [debug] [MainThread]: On master: BEGIN
[0m18:32:12.746890 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:12.763043 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:32:12.763889 [debug] [MainThread]: On master: COMMIT
[0m18:32:12.764467 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:12.765006 [debug] [MainThread]: On master: COMMIT
[0m18:32:12.765736 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:32:12.766300 [debug] [MainThread]: On master: Close
[0m18:32:12.767391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:12.767896 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:32:12.768552 [info ] [MainThread]: 
[0m18:32:12.769628 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m18:32:12.770792 [debug] [MainThread]: Command end result
[0m18:32:12.781017 [info ] [MainThread]: 
[0m18:32:12.781919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:12.782726 [info ] [MainThread]: 
[0m18:32:12.783345 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:32:12.784105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c52c6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c500e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c52fc950>]}
[0m18:32:12.784665 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:33:00.730697 | 5690784a-df7b-4892-9c87-8cb7ed04acb7 ==============================
[0m18:33:00.730697 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:33:00.735856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:33:00.736283 [debug] [MainThread]: Tracking: tracking
[0m18:33:00.759306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9158cc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9158cc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9158cc790>]}
[0m18:33:00.776073 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:33:00.843358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:00.844208 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:33:00.866515 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:33:00.893455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:33:00.901365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5690784a-df7b-4892-9c87-8cb7ed04acb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915905150>]}
[0m18:33:00.912097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5690784a-df7b-4892-9c87-8cb7ed04acb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915884050>]}
[0m18:33:00.913037 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:33:00.914151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5690784a-df7b-4892-9c87-8cb7ed04acb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915948150>]}
[0m18:33:00.916518 [info ] [MainThread]: 
[0m18:33:00.918969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:00.920681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:33:00.940779 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:33:00.941418 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:33:00.941927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:01.072300 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:33:01.074184 [debug] [ThreadPool]: On list_postgres: Close
[0m18:33:01.076104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:33:01.083552 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:33:01.084052 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:33:01.084480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:01.092960 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:33:01.093464 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:33:01.093832 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:33:01.097389 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:33:01.099125 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:33:01.099956 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:33:01.107188 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.107652 [debug] [MainThread]: On master: BEGIN
[0m18:33:01.107987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:01.117381 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:01.117825 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.118244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:01.124524 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:33:01.126961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5690784a-df7b-4892-9c87-8cb7ed04acb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9159a6210>]}
[0m18:33:01.127686 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:01.128366 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.128855 [debug] [MainThread]: On master: BEGIN
[0m18:33:01.129703 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:01.130146 [debug] [MainThread]: On master: COMMIT
[0m18:33:01.130469 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.131200 [debug] [MainThread]: On master: COMMIT
[0m18:33:01.131924 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:33:01.132410 [debug] [MainThread]: On master: Close
[0m18:33:01.133187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:01.133728 [info ] [MainThread]: 
[0m18:33:01.137019 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:33:01.137697 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:33:01.138800 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:33:01.139307 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:33:01.142296 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:33:01.143794 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:33:01.139695 => 2023-04-07 18:33:01.143634
[0m18:33:01.144477 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:33:01.207423 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:33:01.208490 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:01.209105 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:33:01.209540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:01.218805 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:01.219353 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:01.219757 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:33:01.223233 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:33:01.231213 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:01.231684 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:33:01.232511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:01.236309 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:01.236780 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:33:01.237555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:01.265352 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:33:01.265853 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:01.266178 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:33:01.267249 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:33:01.274397 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:01.274862 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:33:01.277148 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:33:01.278788 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:33:01.145149 => 2023-04-07 18:33:01.278727
[0m18:33:01.279165 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:33:01.279973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5690784a-df7b-4892-9c87-8cb7ed04acb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915ac3a90>]}
[0m18:33:01.280553 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:33:01.282276 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:33:01.282961 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:33:01.283579 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:33:01.284733 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:33:01.285224 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:33:01.287406 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:33:01.288244 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:33:01.285581 => 2023-04-07 18:33:01.288143
[0m18:33:01.288724 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:33:01.297954 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:33:01.298885 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:01.299313 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:33:01.299659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:01.310618 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:01.311221 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:01.311629 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:33:01.314749 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:33:01.320231 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:01.320704 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:33:01.322040 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:01.326654 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:01.327057 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:33:01.339513 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:01.344806 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:33:01.345316 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:01.345671 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:33:01.385177 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:33:01.398387 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:01.398822 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:33:01.400523 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:33:01.402297 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:33:01.289083 => 2023-04-07 18:33:01.402224
[0m18:33:01.402731 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:33:01.403612 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5690784a-df7b-4892-9c87-8cb7ed04acb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915cc06d0>]}
[0m18:33:01.404337 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.12s]
[0m18:33:01.405130 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:33:01.405749 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:33:01.406346 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:33:01.407581 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:33:01.408185 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:33:01.411858 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:33:01.412989 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:33:01.408572 => 2023-04-07 18:33:01.412873
[0m18:33:01.413521 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:33:01.420059 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:33:01.420920 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:01.421371 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:33:01.421781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:01.432185 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:01.432669 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:01.432985 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(price, month) as correlation
FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:33:01.434208 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function corr(double precision, date) does not exist
LINE 4:     SELECT corr(price, month) as correlation
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:33:01.434633 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: ROLLBACK
[0m18:33:01.435334 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:33:01.413945 => 2023-04-07 18:33:01.435258
[0m18:33:01.435830 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:33:01.446941 [debug] [Thread-1  ]: Database Error in model 5Ycorrelation (models/5Ycorrelation.sql)
  function corr(double precision, date) does not exist
  LINE 4:     SELECT corr(price, month) as correlation
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:33:01.447707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5690784a-df7b-4892-9c87-8cb7ed04acb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915ca2c90>]}
[0m18:33:01.448275 [error] [Thread-1  ]: 3 of 3 ERROR creating sql view model dbt.5Ycorrelation ......................... [[31mERROR[0m in 0.04s]
[0m18:33:01.448853 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:33:01.453249 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:01.453876 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.454367 [debug] [MainThread]: On master: BEGIN
[0m18:33:01.454768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:01.464584 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:01.465018 [debug] [MainThread]: On master: COMMIT
[0m18:33:01.465451 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.465824 [debug] [MainThread]: On master: COMMIT
[0m18:33:01.466304 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:33:01.466725 [debug] [MainThread]: On master: Close
[0m18:33:01.467501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:01.467791 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:33:01.468161 [info ] [MainThread]: 
[0m18:33:01.468809 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m18:33:01.469824 [debug] [MainThread]: Command end result
[0m18:33:01.478242 [info ] [MainThread]: 
[0m18:33:01.479287 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:33:01.480392 [info ] [MainThread]: 
[0m18:33:01.481181 [error] [MainThread]: [33mDatabase Error in model 5Ycorrelation (models/5Ycorrelation.sql)[0m
[0m18:33:01.481975 [error] [MainThread]:   function corr(double precision, date) does not exist
[0m18:33:01.482518 [error] [MainThread]:   LINE 4:     SELECT corr(price, month) as correlation
[0m18:33:01.483006 [error] [MainThread]:                      ^
[0m18:33:01.483505 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:33:01.484017 [error] [MainThread]:   compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:33:01.484761 [info ] [MainThread]: 
[0m18:33:01.485577 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:33:01.486306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915c54f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915a69090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb915ac2d10>]}
[0m18:33:01.486866 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:33:30.520168 | 8eeef2e3-211b-456a-9bf2-fe9ad7a87397 ==============================
[0m18:33:30.520168 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:33:30.522877 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:33:30.523304 [debug] [MainThread]: Tracking: tracking
[0m18:33:30.543234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d98f9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d98f99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d98f9650>]}
[0m18:33:30.561632 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:33:30.623935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:30.624986 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:33:30.648292 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:33:30.672141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:33:30.679482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eeef2e3-211b-456a-9bf2-fe9ad7a87397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d993a0d0>]}
[0m18:33:30.688955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eeef2e3-211b-456a-9bf2-fe9ad7a87397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d996b050>]}
[0m18:33:30.689669 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:33:30.690659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eeef2e3-211b-456a-9bf2-fe9ad7a87397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d996ba90>]}
[0m18:33:30.692859 [info ] [MainThread]: 
[0m18:33:30.694900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:30.696723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:33:30.713255 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:33:30.713886 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:33:30.714236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:30.779017 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:33:30.781191 [debug] [ThreadPool]: On list_postgres: Close
[0m18:33:30.783259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:33:30.791691 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:33:30.792216 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:33:30.792525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:30.801063 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:33:30.801543 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:33:30.801914 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:33:30.806827 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:33:30.808605 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:33:30.809532 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:33:30.816331 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.816804 [debug] [MainThread]: On master: BEGIN
[0m18:33:30.817183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:30.826320 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:30.826784 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.827172 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:30.833327 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:33:30.834877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eeef2e3-211b-456a-9bf2-fe9ad7a87397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d99c5850>]}
[0m18:33:30.835483 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:30.836235 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.836703 [debug] [MainThread]: On master: BEGIN
[0m18:33:30.837767 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:30.838367 [debug] [MainThread]: On master: COMMIT
[0m18:33:30.838881 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.839277 [debug] [MainThread]: On master: COMMIT
[0m18:33:30.840096 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:33:30.840509 [debug] [MainThread]: On master: Close
[0m18:33:30.841364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:30.841898 [info ] [MainThread]: 
[0m18:33:30.845124 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:33:30.845656 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:33:30.846647 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:33:30.847016 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:33:30.849827 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:33:30.850837 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:33:30.847279 => 2023-04-07 18:33:30.850671
[0m18:33:30.851385 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:33:30.912087 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:33:30.912979 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:30.913531 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:33:30.914150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:30.928407 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:30.928892 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:30.929304 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:33:30.935398 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:33:30.945212 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:30.945772 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:33:31.017135 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:31.021405 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:31.021901 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:33:31.023270 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:31.048264 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:33:31.048882 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:31.049233 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:33:31.051915 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:33:31.060960 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:31.061589 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:33:31.063741 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:33:31.065119 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:33:30.851711 => 2023-04-07 18:33:31.065068
[0m18:33:31.065481 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:33:31.066654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eeef2e3-211b-456a-9bf2-fe9ad7a87397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d9c346d0>]}
[0m18:33:31.067358 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.22s]
[0m18:33:31.069328 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:33:31.069986 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:33:31.070762 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:33:31.072037 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:33:31.072475 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:33:31.074431 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:33:31.075196 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:33:31.072765 => 2023-04-07 18:33:31.075112
[0m18:33:31.075820 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:33:31.083783 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:33:31.084591 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:31.084957 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:33:31.085239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:31.096526 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:31.096978 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:31.097342 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:33:31.100013 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:33:31.104759 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:31.105246 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:33:31.106866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:31.111469 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:31.111891 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:33:31.112676 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:31.116285 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:33:31.116834 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:31.117181 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:33:31.118174 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:33:31.121709 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:31.122201 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:33:31.125128 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:33:31.127095 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:33:31.076451 => 2023-04-07 18:33:31.127020
[0m18:33:31.127525 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:33:31.128429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eeef2e3-211b-456a-9bf2-fe9ad7a87397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d9ce0310>]}
[0m18:33:31.129329 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:33:31.130101 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:33:31.130790 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:33:31.131304 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:33:31.132609 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:33:31.133404 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:33:31.137185 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:33:31.138323 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:33:31.133798 => 2023-04-07 18:33:31.138214
[0m18:33:31.139027 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:33:31.145794 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:33:31.147113 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:31.147717 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:33:31.148354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:31.163727 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:31.164272 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:31.164694 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"
ORDER BY month DESC
  );
[0m18:33:31.166781 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "5yearmodel.month" must appear in the GROUP BY clause or be used in an aggregate function
LINE 6: ORDER BY month DESC
                 ^

[0m18:33:31.167339 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: ROLLBACK
[0m18:33:31.168233 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:33:31.139354 => 2023-04-07 18:33:31.168138
[0m18:33:31.168731 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:33:31.177650 [debug] [Thread-1  ]: Database Error in model 5Ycorrelation (models/5Ycorrelation.sql)
  column "5yearmodel.month" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 6: ORDER BY month DESC
                   ^
  compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:33:31.178228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eeef2e3-211b-456a-9bf2-fe9ad7a87397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d9cc1350>]}
[0m18:33:31.178852 [error] [Thread-1  ]: 3 of 3 ERROR creating sql view model dbt.5Ycorrelation ......................... [[31mERROR[0m in 0.05s]
[0m18:33:31.179698 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:33:31.272414 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:31.272944 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:31.273372 [debug] [MainThread]: On master: BEGIN
[0m18:33:31.273723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:31.282266 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:31.282744 [debug] [MainThread]: On master: COMMIT
[0m18:33:31.283207 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:31.283565 [debug] [MainThread]: On master: COMMIT
[0m18:33:31.284020 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:33:31.284348 [debug] [MainThread]: On master: Close
[0m18:33:31.285008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:31.285348 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:33:31.285679 [info ] [MainThread]: 
[0m18:33:31.286208 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m18:33:31.287090 [debug] [MainThread]: Command end result
[0m18:33:31.294707 [info ] [MainThread]: 
[0m18:33:31.295452 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:33:31.295998 [info ] [MainThread]: 
[0m18:33:31.296496 [error] [MainThread]: [33mDatabase Error in model 5Ycorrelation (models/5Ycorrelation.sql)[0m
[0m18:33:31.297011 [error] [MainThread]:   column "5yearmodel.month" must appear in the GROUP BY clause or be used in an aggregate function
[0m18:33:31.297482 [error] [MainThread]:   LINE 6: ORDER BY month DESC
[0m18:33:31.297984 [error] [MainThread]:                    ^
[0m18:33:31.298501 [error] [MainThread]:   compiled Code at target/run/my_project/models/5Ycorrelation.sql
[0m18:33:31.299021 [info ] [MainThread]: 
[0m18:33:31.299672 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:33:31.300586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d99c9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d9c51890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d9c162d0>]}
[0m18:33:31.301091 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:33:35.214997 | 2c704e8e-c835-4290-8a5f-2be707da2304 ==============================
[0m18:33:35.214997 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:33:35.217134 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:33:35.217473 [debug] [MainThread]: Tracking: tracking
[0m18:33:35.258496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b00c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b00c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b00c590>]}
[0m18:33:35.273338 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:33:35.306129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:35.306840 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:33:35.325207 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:33:35.347917 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:33:35.355375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c704e8e-c835-4290-8a5f-2be707da2304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b06b590>]}
[0m18:33:35.365431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c704e8e-c835-4290-8a5f-2be707da2304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7afec190>]}
[0m18:33:35.366034 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:33:35.366781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c704e8e-c835-4290-8a5f-2be707da2304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7afecad0>]}
[0m18:33:35.369129 [info ] [MainThread]: 
[0m18:33:35.371846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:35.373811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:33:35.390826 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:33:35.391552 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:33:35.392123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:35.405505 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:33:35.407496 [debug] [ThreadPool]: On list_postgres: Close
[0m18:33:35.409380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:33:35.417072 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:33:35.417578 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:33:35.417936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:35.427539 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:33:35.427963 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:33:35.428267 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:33:35.431703 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m18:33:35.433453 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:33:35.434225 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:33:35.441584 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:35.442047 [debug] [MainThread]: On master: BEGIN
[0m18:33:35.442419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:35.450904 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:35.451371 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:35.451757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:35.456684 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m18:33:35.458378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c704e8e-c835-4290-8a5f-2be707da2304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd780eae50>]}
[0m18:33:35.459016 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:35.459592 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:35.459940 [debug] [MainThread]: On master: BEGIN
[0m18:33:35.460615 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:35.461020 [debug] [MainThread]: On master: COMMIT
[0m18:33:35.461407 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:35.461782 [debug] [MainThread]: On master: COMMIT
[0m18:33:35.462387 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:33:35.462873 [debug] [MainThread]: On master: Close
[0m18:33:35.463765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:35.464482 [info ] [MainThread]: 
[0m18:33:35.466792 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:33:35.467499 [info ] [Thread-1  ]: 1 of 3 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:33:35.468615 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:33:35.469158 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:33:35.471980 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:33:35.473140 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:33:35.469531 => 2023-04-07 18:33:35.472976
[0m18:33:35.474431 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:33:35.534674 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:33:35.535736 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:35.536247 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:33:35.536594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:35.546061 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:35.546504 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:35.546889 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:33:35.550808 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:33:35.560460 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:35.560871 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:33:35.561713 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:35.565529 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:35.566230 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:33:35.567057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:35.593737 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:33:35.594276 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:35.594900 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:33:35.597121 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:33:35.605180 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:33:35.605569 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:33:35.607163 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:33:35.608777 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:33:35.475147 => 2023-04-07 18:33:35.608707
[0m18:33:35.609137 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:33:35.609994 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c704e8e-c835-4290-8a5f-2be707da2304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b352690>]}
[0m18:33:35.610597 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:33:35.612405 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:33:35.612988 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:33:35.613750 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt.model1 ......................................... [RUN]
[0m18:33:35.614945 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:33:35.615401 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:33:35.617561 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:33:35.618425 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:33:35.615701 => 2023-04-07 18:33:35.618321
[0m18:33:35.618955 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:33:35.626643 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:33:35.627574 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:35.627906 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:33:35.628181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:35.638395 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:35.638824 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:35.639138 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:33:35.642514 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:33:35.647612 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:35.648022 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:33:35.648939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:35.653518 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:35.654064 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:33:35.654866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:35.657866 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:33:35.658231 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:35.658554 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:33:35.659720 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:33:35.663159 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:33:35.663628 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:33:35.665594 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:33:35.667481 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:33:35.619473 => 2023-04-07 18:33:35.667336
[0m18:33:35.668056 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:33:35.669360 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c704e8e-c835-4290-8a5f-2be707da2304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b1d5a90>]}
[0m18:33:35.670242 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:33:35.671087 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:33:35.671666 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:33:35.672523 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:33:35.673860 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:33:35.674294 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:33:35.677393 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:33:35.678201 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:33:35.674547 => 2023-04-07 18:33:35.678099
[0m18:33:35.678613 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:33:35.683777 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:33:35.684666 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:35.685191 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:33:35.687227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:35.705042 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:33:35.705490 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:35.705822 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:33:35.709041 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:33:35.713033 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:35.713482 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:33:35.714501 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:33:35.716953 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:33:35.717443 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:35.717913 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:33:35.719299 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:33:35.722905 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:33:35.723402 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:33:35.724201 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:33:35.725684 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:33:35.678917 => 2023-04-07 18:33:35.725629
[0m18:33:35.726029 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:33:35.726746 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c704e8e-c835-4290-8a5f-2be707da2304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b0a8510>]}
[0m18:33:35.727324 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:33:35.727908 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:33:35.784622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:35.785435 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:35.786188 [debug] [MainThread]: On master: BEGIN
[0m18:33:35.786848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:35.799583 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:33:35.800261 [debug] [MainThread]: On master: COMMIT
[0m18:33:35.800780 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:35.801231 [debug] [MainThread]: On master: COMMIT
[0m18:33:35.801921 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:33:35.802401 [debug] [MainThread]: On master: Close
[0m18:33:35.803349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:35.803768 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:33:35.804257 [info ] [MainThread]: 
[0m18:33:35.805045 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m18:33:35.806051 [debug] [MainThread]: Command end result
[0m18:33:35.815860 [info ] [MainThread]: 
[0m18:33:35.816888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:35.817611 [info ] [MainThread]: 
[0m18:33:35.818384 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:33:35.819229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b1d47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd780eae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd7b341210>]}
[0m18:33:35.819842 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:39:25.725361 | ae13d523-0411-4822-8028-cb2278b8037c ==============================
[0m18:39:25.725361 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:39:25.728094 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:39:25.728560 [debug] [MainThread]: Tracking: tracking
[0m18:39:25.757390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b115610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b115490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b115550>]}
[0m18:39:25.773656 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:39:25.842076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:39:25.842901 [debug] [MainThread]: Partial parsing: added file: my_project://models/5YWheatvsCorn.sql
[0m18:39:25.843444 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5Ycorrelation.sql
[0m18:39:25.862916 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheatvsCorn.sql
[0m18:39:25.880365 [debug] [MainThread]: 1699: static parser successfully parsed 5Ycorrelation.sql
[0m18:39:25.892811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:39:25.900661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae13d523-0411-4822-8028-cb2278b8037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b2b4b90>]}
[0m18:39:25.910249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae13d523-0411-4822-8028-cb2278b8037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b18a210>]}
[0m18:39:25.910899 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:39:25.911618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae13d523-0411-4822-8028-cb2278b8037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b18a990>]}
[0m18:39:25.914546 [info ] [MainThread]: 
[0m18:39:25.916895 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:25.919079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:39:25.945164 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:39:25.945636 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:39:25.946009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:26.115508 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:39:26.117406 [debug] [ThreadPool]: On list_postgres: Close
[0m18:39:26.119286 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:39:26.127554 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:39:26.128153 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:39:26.128557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:26.138548 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:39:26.139021 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:39:26.139418 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:39:26.144730 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:39:26.146232 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:39:26.146797 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:39:26.153865 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:26.154317 [debug] [MainThread]: On master: BEGIN
[0m18:39:26.154650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:26.164638 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:39:26.165074 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:26.165467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:39:26.171901 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:39:26.173578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae13d523-0411-4822-8028-cb2278b8037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b19f850>]}
[0m18:39:26.174132 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:26.174794 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:26.175246 [debug] [MainThread]: On master: BEGIN
[0m18:39:26.176029 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:39:26.176416 [debug] [MainThread]: On master: COMMIT
[0m18:39:26.176736 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:26.177053 [debug] [MainThread]: On master: COMMIT
[0m18:39:26.177587 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:39:26.177919 [debug] [MainThread]: On master: Close
[0m18:39:26.178732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:26.179585 [info ] [MainThread]: 
[0m18:39:26.182653 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:39:26.183311 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:39:26.184379 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:39:26.184884 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:39:26.187764 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:39:26.188603 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:39:26.185257 => 2023-04-07 18:39:26.188475
[0m18:39:26.189277 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:39:26.247974 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:39:26.249204 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:26.249695 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:39:26.250090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:26.258927 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:39:26.259470 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:26.259755 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:39:26.264371 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:39:26.274615 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:26.275044 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:39:26.275866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:39:26.279257 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:26.279585 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:39:26.280323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:39:26.304842 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:39:26.305248 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:26.305522 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:39:26.306657 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:39:26.312579 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:26.312985 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:39:26.314953 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:39:26.316449 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:39:26.189845 => 2023-04-07 18:39:26.316394
[0m18:39:26.316981 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:39:26.317814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae13d523-0411-4822-8028-cb2278b8037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b2c9890>]}
[0m18:39:26.318460 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:39:26.320290 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:39:26.320968 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:39:26.321819 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:39:26.322899 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:39:26.323515 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:39:26.325682 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:39:26.326509 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:39:26.323874 => 2023-04-07 18:39:26.326424
[0m18:39:26.326962 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:39:26.334900 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:39:26.335831 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:39:26.336311 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:39:26.336705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:26.346766 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:39:26.347293 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:39:26.347682 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:39:26.350675 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:39:26.356672 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:39:26.357067 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:39:26.357753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:39:26.361681 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:39:26.362051 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:39:26.362786 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:39:26.365472 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:39:26.365779 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:39:26.366121 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:39:26.367360 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:39:26.371437 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:39:26.371857 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:39:26.373429 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:39:26.375336 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:39:26.327334 => 2023-04-07 18:39:26.375277
[0m18:39:26.375724 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:39:26.376547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae13d523-0411-4822-8028-cb2278b8037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b4f0890>]}
[0m18:39:26.377133 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:39:26.377747 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:39:26.378354 [debug] [Thread-1  ]: Began running node model.my_project.5YWheatvsCorn
[0m18:39:26.378761 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheatvsCorn .................................. [RUN]
[0m18:39:26.379718 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheatvsCorn'
[0m18:39:26.380297 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheatvsCorn
[0m18:39:26.383435 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheatvsCorn"
[0m18:39:26.384438 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (compile): 2023-04-07 18:39:26.380574 => 2023-04-07 18:39:26.384349
[0m18:39:26.384890 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheatvsCorn
[0m18:39:26.392091 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheatvsCorn"
[0m18:39:26.393140 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:39:26.393643 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: BEGIN
[0m18:39:26.393983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:26.402712 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:39:26.403387 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:39:26.403919 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheatvsCorn"} */

  create view "postgres"."dbt"."5YWheatvsCorn__dbt_tmp" as (
    SELECT 
    DATEPART(year, date) AS year,
    DATEPART(month, date) AS month,
    CORR(price, 
         (SELECT price 
          FROM commodities2 
          WHERE commodity = 'wheat' AND 
                DATEPART(year, date) = DATEPART(year, commodities2.date) AND 
                DATEPART(month, date) = DATEPART(month, commodities2.date)
         )
    ) AS correlation
WHERE 
    commodity = 'corn'
GROUP BY 
    DATEPART(year, date), 
    DATEPART(month, date)

FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:39:26.404915 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 21: FROM "postgres"."dbt"."5yearmodel"
         ^

[0m18:39:26.405535 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: ROLLBACK
[0m18:39:26.406253 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (execute): 2023-04-07 18:39:26.385151 => 2023-04-07 18:39:26.406170
[0m18:39:26.406591 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: Close
[0m18:39:26.417928 [debug] [Thread-1  ]: Database Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)
  syntax error at or near "FROM"
  LINE 21: FROM "postgres"."dbt"."5yearmodel"
           ^
  compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:39:26.418705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae13d523-0411-4822-8028-cb2278b8037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b4fc0d0>]}
[0m18:39:26.419750 [error] [Thread-1  ]: 3 of 4 ERROR creating sql view model dbt.5YWheatvsCorn ......................... [[31mERROR[0m in 0.04s]
[0m18:39:26.420712 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheatvsCorn
[0m18:39:26.421405 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:39:26.422171 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:39:26.423252 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:39:26.423715 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:39:26.427529 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:39:26.428380 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:39:26.423999 => 2023-04-07 18:39:26.428280
[0m18:39:26.428854 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:39:26.435446 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:39:26.436519 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:39:26.436911 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:39:26.437312 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:26.447955 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:39:26.448333 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:39:26.448654 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:39:26.454545 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:39:26.458844 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:39:26.459255 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:39:26.460017 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:39:26.462492 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:39:26.462935 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:39:26.463273 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:39:26.464234 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:39:26.467697 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:39:26.468168 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:39:26.469087 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:39:26.471271 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:39:26.429217 => 2023-04-07 18:39:26.471153
[0m18:39:26.471749 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:39:26.472768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae13d523-0411-4822-8028-cb2278b8037c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8afec950>]}
[0m18:39:26.473526 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:39:26.474502 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:39:26.499575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:26.500124 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:26.500557 [debug] [MainThread]: On master: BEGIN
[0m18:39:26.500971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:26.511166 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:39:26.511763 [debug] [MainThread]: On master: COMMIT
[0m18:39:26.512082 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:26.512412 [debug] [MainThread]: On master: COMMIT
[0m18:39:26.512947 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:39:26.513258 [debug] [MainThread]: On master: Close
[0m18:39:26.513949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:26.514216 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:39:26.514555 [info ] [MainThread]: 
[0m18:39:26.515109 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m18:39:26.516102 [debug] [MainThread]: Command end result
[0m18:39:26.526075 [info ] [MainThread]: 
[0m18:39:26.526787 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:39:26.527338 [info ] [MainThread]: 
[0m18:39:26.528003 [error] [MainThread]: [33mDatabase Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)[0m
[0m18:39:26.528591 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:39:26.529135 [error] [MainThread]:   LINE 21: FROM "postgres"."dbt"."5yearmodel"
[0m18:39:26.529650 [error] [MainThread]:            ^
[0m18:39:26.530210 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:39:26.530781 [info ] [MainThread]: 
[0m18:39:26.531302 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:39:26.532369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b56cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b4edfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8b5a8910>]}
[0m18:39:26.532943 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:39:59.512727 | 67b0ea81-60de-4040-a134-7f73bcf65f08 ==============================
[0m18:39:59.512727 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:39:59.515686 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:39:59.516100 [debug] [MainThread]: Tracking: tracking
[0m18:39:59.544105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f831291c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f831291c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f831291c710>]}
[0m18:39:59.561195 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:39:59.627703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:39:59.628368 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheatvsCorn.sql
[0m18:39:59.648850 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheatvsCorn.sql
[0m18:39:59.675797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:39:59.683274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67b0ea81-60de-4040-a134-7f73bcf65f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312abde10>]}
[0m18:39:59.692829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67b0ea81-60de-4040-a134-7f73bcf65f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312989210>]}
[0m18:39:59.693750 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:39:59.694408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b0ea81-60de-4040-a134-7f73bcf65f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312989750>]}
[0m18:39:59.696247 [info ] [MainThread]: 
[0m18:39:59.698470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:59.699958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:39:59.716749 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:39:59.717302 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:39:59.717645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:59.782981 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:39:59.784826 [debug] [ThreadPool]: On list_postgres: Close
[0m18:39:59.786704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:39:59.795040 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:39:59.795510 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:39:59.795829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:59.805465 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:39:59.805976 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:39:59.806365 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:39:59.810196 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:39:59.811684 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:39:59.812351 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:39:59.818888 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:59.819296 [debug] [MainThread]: On master: BEGIN
[0m18:39:59.819608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:59.828297 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:39:59.828780 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:59.829098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:39:59.834825 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:39:59.836383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67b0ea81-60de-4040-a134-7f73bcf65f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83129a0dd0>]}
[0m18:39:59.836904 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:59.837659 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:59.838029 [debug] [MainThread]: On master: BEGIN
[0m18:39:59.838871 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:39:59.839309 [debug] [MainThread]: On master: COMMIT
[0m18:39:59.839678 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:59.839965 [debug] [MainThread]: On master: COMMIT
[0m18:39:59.840448 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:39:59.840827 [debug] [MainThread]: On master: Close
[0m18:39:59.841536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:59.842119 [info ] [MainThread]: 
[0m18:39:59.845151 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:39:59.845786 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:39:59.846899 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:39:59.847458 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:39:59.850233 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:39:59.851288 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:39:59.847816 => 2023-04-07 18:39:59.851103
[0m18:39:59.851866 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:39:59.907520 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:39:59.908576 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:59.909093 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:39:59.909468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:59.917995 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:39:59.918396 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:59.918822 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:39:59.923135 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:39:59.931012 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:59.931397 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:39:59.932193 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:39:59.935855 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:59.936223 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:39:59.936973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:39:59.959511 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:39:59.959932 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:59.960225 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:39:59.961357 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:39:59.967581 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:39:59.967970 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:39:59.969801 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:39:59.971276 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:39:59.852237 => 2023-04-07 18:39:59.971213
[0m18:39:59.971757 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:39:59.972825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b0ea81-60de-4040-a134-7f73bcf65f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312c6b990>]}
[0m18:39:59.973488 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:39:59.975300 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:39:59.975948 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:39:59.976783 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:39:59.978574 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:39:59.979081 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:39:59.981085 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:39:59.981908 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:39:59.979374 => 2023-04-07 18:39:59.981827
[0m18:39:59.982403 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:39:59.989605 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:39:59.990527 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:39:59.990945 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:39:59.991314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:00.000701 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:00.001099 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:00.001565 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:40:00.036193 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:00.040915 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:00.041430 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:40:00.042388 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:00.045819 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:00.046170 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:40:00.046999 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:00.049975 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:40:00.050334 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:00.050635 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:40:00.051703 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:00.054502 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:00.054840 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:40:00.056536 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:00.058559 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:39:59.982760 => 2023-04-07 18:40:00.058483
[0m18:40:00.059106 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:40:00.060080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b0ea81-60de-4040-a134-7f73bcf65f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312d0afd0>]}
[0m18:40:00.060765 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:40:00.061571 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:40:00.062110 [debug] [Thread-1  ]: Began running node model.my_project.5YWheatvsCorn
[0m18:40:00.062623 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheatvsCorn .................................. [RUN]
[0m18:40:00.063710 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheatvsCorn'
[0m18:40:00.064424 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheatvsCorn
[0m18:40:00.067876 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheatvsCorn"
[0m18:40:00.068706 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (compile): 2023-04-07 18:40:00.064809 => 2023-04-07 18:40:00.068597
[0m18:40:00.069194 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheatvsCorn
[0m18:40:00.075826 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheatvsCorn"
[0m18:40:00.077228 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:40:00.077726 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: BEGIN
[0m18:40:00.078061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:00.086445 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:00.086836 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:40:00.087192 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheatvsCorn"} */

  create view "postgres"."dbt"."5YWheatvsCorn__dbt_tmp" as (
    SELECT 
    DATEPART(year, date) AS year,
    DATEPART(month, date) AS month,
    CORR(price, 
         (SELECT price 
          FROM commodities2 
          WHERE commodity = 'Wheat' AND 
                DATEPART(year, date) = DATEPART(year, commodities2.date) AND 
                DATEPART(month, date) = DATEPART(month, commodities2.date)
         )
    ) AS correlation
WHERE 
    commodity = 'Corn'
GROUP BY 
    DATEPART(year, date), 
    DATEPART(month, date)

FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:40:00.088176 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 21: FROM "postgres"."dbt"."5yearmodel"
         ^

[0m18:40:00.088648 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: ROLLBACK
[0m18:40:00.089402 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (execute): 2023-04-07 18:40:00.069548 => 2023-04-07 18:40:00.089286
[0m18:40:00.089838 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: Close
[0m18:40:00.100325 [debug] [Thread-1  ]: Database Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)
  syntax error at or near "FROM"
  LINE 21: FROM "postgres"."dbt"."5yearmodel"
           ^
  compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:40:00.101094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b0ea81-60de-4040-a134-7f73bcf65f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312d1abd0>]}
[0m18:40:00.101703 [error] [Thread-1  ]: 3 of 4 ERROR creating sql view model dbt.5YWheatvsCorn ......................... [[31mERROR[0m in 0.04s]
[0m18:40:00.102326 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheatvsCorn
[0m18:40:00.102908 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:40:00.103618 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:40:00.104772 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:40:00.105313 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:40:00.109661 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:40:00.110449 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:40:00.105661 => 2023-04-07 18:40:00.110364
[0m18:40:00.110839 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:40:00.116301 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:40:00.117246 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:00.117739 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:40:00.118170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:00.127941 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:00.128465 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:00.128806 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:40:00.132244 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:00.135873 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:00.136224 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:40:00.137187 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:00.139891 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:40:00.140398 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:00.140846 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:40:00.142341 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:00.145694 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:00.146343 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:40:00.147125 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:00.148526 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:40:00.111114 => 2023-04-07 18:40:00.148471
[0m18:40:00.148902 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:40:00.149674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67b0ea81-60de-4040-a134-7f73bcf65f08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312d5fd90>]}
[0m18:40:00.150357 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:40:00.151220 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:40:00.163214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:00.163687 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:00.164032 [debug] [MainThread]: On master: BEGIN
[0m18:40:00.164331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:40:00.173470 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:00.174005 [debug] [MainThread]: On master: COMMIT
[0m18:40:00.174415 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:00.174775 [debug] [MainThread]: On master: COMMIT
[0m18:40:00.175474 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:40:00.175901 [debug] [MainThread]: On master: Close
[0m18:40:00.176591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:00.176894 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:40:00.177229 [info ] [MainThread]: 
[0m18:40:00.177963 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m18:40:00.178932 [debug] [MainThread]: Command end result
[0m18:40:00.187356 [info ] [MainThread]: 
[0m18:40:00.188088 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:40:00.188740 [info ] [MainThread]: 
[0m18:40:00.189437 [error] [MainThread]: [33mDatabase Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)[0m
[0m18:40:00.190081 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:40:00.190634 [error] [MainThread]:   LINE 21: FROM "postgres"."dbt"."5yearmodel"
[0m18:40:00.191157 [error] [MainThread]:            ^
[0m18:40:00.191746 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:40:00.192374 [info ] [MainThread]: 
[0m18:40:00.193340 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:40:00.194418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312c30a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312c30390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8312c30210>]}
[0m18:40:00.195207 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:40:11.422221 | 20865a0a-e1a4-4f44-8fd4-b72ab970801c ==============================
[0m18:40:11.422221 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:40:11.424874 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:40:11.425266 [debug] [MainThread]: Tracking: tracking
[0m18:40:11.455107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ccfd9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ccfd9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ccfd9410>]}
[0m18:40:11.471349 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:40:11.535671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:11.536389 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheatvsCorn.sql
[0m18:40:11.556628 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheatvsCorn.sql
[0m18:40:11.581534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:40:11.588559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20865a0a-e1a4-4f44-8fd4-b72ab970801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd10f0d0>]}
[0m18:40:11.597601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20865a0a-e1a4-4f44-8fd4-b72ab970801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ccfab0d0>]}
[0m18:40:11.598328 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:40:11.599216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20865a0a-e1a4-4f44-8fd4-b72ab970801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ccfabc10>]}
[0m18:40:11.602161 [info ] [MainThread]: 
[0m18:40:11.604623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:11.606197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:40:11.624220 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:40:11.641729 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:40:11.642392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:11.694250 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:40:11.696036 [debug] [ThreadPool]: On list_postgres: Close
[0m18:40:11.697989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:40:11.705618 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:40:11.706512 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:40:11.707014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:11.716148 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:40:11.716618 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:40:11.717118 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:40:11.729799 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:40:11.731828 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:40:11.733253 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:40:11.740781 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:11.741271 [debug] [MainThread]: On master: BEGIN
[0m18:40:11.741630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:11.759487 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:11.759995 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:11.760400 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:40:11.767659 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:40:11.769243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20865a0a-e1a4-4f44-8fd4-b72ab970801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ccfef0d0>]}
[0m18:40:11.769771 [debug] [MainThread]: On master: ROLLBACK
[0m18:40:11.770348 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:11.770708 [debug] [MainThread]: On master: BEGIN
[0m18:40:11.771350 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:11.771710 [debug] [MainThread]: On master: COMMIT
[0m18:40:11.772023 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:11.772310 [debug] [MainThread]: On master: COMMIT
[0m18:40:11.772794 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:40:11.773138 [debug] [MainThread]: On master: Close
[0m18:40:11.773824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:11.774351 [info ] [MainThread]: 
[0m18:40:11.777022 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:40:11.777661 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:40:11.778669 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:40:11.779127 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:40:11.781307 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:40:11.782175 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:40:11.779505 => 2023-04-07 18:40:11.782043
[0m18:40:11.782625 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:40:11.838147 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:40:11.838945 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:11.839342 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:40:11.839655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:11.849363 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:11.849834 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:11.850148 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:40:11.853286 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:11.861661 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:11.862092 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:40:11.863252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:11.866712 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:11.867226 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:40:11.868083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:11.893322 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:40:11.893748 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:11.894070 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:40:11.895089 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:11.902621 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:11.903030 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:40:11.906297 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:11.907916 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:40:11.783093 => 2023-04-07 18:40:11.907853
[0m18:40:11.908315 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:40:11.909251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20865a0a-e1a4-4f44-8fd4-b72ab970801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd2df7d0>]}
[0m18:40:11.909995 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:40:11.911932 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:40:11.912518 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:40:11.913056 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:40:11.914115 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:40:11.914554 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:40:11.917282 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:40:11.918710 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:40:11.914826 => 2023-04-07 18:40:11.918604
[0m18:40:11.919252 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:40:11.927604 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:40:11.928570 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:11.928975 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:40:11.929534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:11.938913 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:11.939349 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:11.939685 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:40:11.943022 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:11.946886 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:11.947299 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:40:11.948036 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:11.952235 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:11.952638 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:40:11.953593 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:11.956440 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:40:11.956837 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:11.957138 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:40:11.958249 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:11.961085 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:11.961436 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:40:11.965656 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:11.967573 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:40:11.919595 => 2023-04-07 18:40:11.967505
[0m18:40:11.968099 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:40:11.968945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20865a0a-e1a4-4f44-8fd4-b72ab970801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd4c5a50>]}
[0m18:40:11.969538 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:40:11.970250 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:40:11.971213 [debug] [Thread-1  ]: Began running node model.my_project.5YWheatvsCorn
[0m18:40:11.971876 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheatvsCorn .................................. [RUN]
[0m18:40:11.972914 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheatvsCorn'
[0m18:40:11.973340 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheatvsCorn
[0m18:40:11.976522 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheatvsCorn"
[0m18:40:11.977313 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (compile): 2023-04-07 18:40:11.973595 => 2023-04-07 18:40:11.977223
[0m18:40:11.977782 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheatvsCorn
[0m18:40:11.984010 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheatvsCorn"
[0m18:40:11.985418 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:40:11.986314 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: BEGIN
[0m18:40:11.986853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:11.996752 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:11.997204 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:40:11.997605 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheatvsCorn"} */

  create view "postgres"."dbt"."5YWheatvsCorn__dbt_tmp" as (
    SELECT 
    DATEPART(year, date) AS year,
    DATEPART(month, date) AS month,
    CORR(price, 
         (SELECT price 
          FROM postgres 
          WHERE commodity = 'Wheat' AND 
                DATEPART(year, date) = DATEPART(year, commodities2.date) AND 
                DATEPART(month, date) = DATEPART(month, commodities2.date)
         )
    ) AS correlation
WHERE 
    commodity = 'Corn'
GROUP BY 
    DATEPART(year, date), 
    DATEPART(month, date)

FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:40:11.998790 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 21: FROM "postgres"."dbt"."5yearmodel"
         ^

[0m18:40:11.999493 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: ROLLBACK
[0m18:40:12.001258 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (execute): 2023-04-07 18:40:11.978070 => 2023-04-07 18:40:12.001072
[0m18:40:12.002011 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: Close
[0m18:40:12.013350 [debug] [Thread-1  ]: Database Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)
  syntax error at or near "FROM"
  LINE 21: FROM "postgres"."dbt"."5yearmodel"
           ^
  compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:40:12.014488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20865a0a-e1a4-4f44-8fd4-b72ab970801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd116310>]}
[0m18:40:12.016164 [error] [Thread-1  ]: 3 of 4 ERROR creating sql view model dbt.5YWheatvsCorn ......................... [[31mERROR[0m in 0.04s]
[0m18:40:12.018063 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheatvsCorn
[0m18:40:12.018559 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:40:12.019418 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:40:12.020987 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:40:12.021454 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:40:12.024893 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:40:12.025786 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:40:12.021728 => 2023-04-07 18:40:12.025618
[0m18:40:12.026300 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:40:12.032893 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:40:12.036361 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:12.037570 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:40:12.038234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:12.052861 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:12.053328 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:12.053758 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:40:12.058357 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:12.061904 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:12.062615 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:40:12.064252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:12.068557 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:40:12.069132 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:12.069475 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:40:12.070385 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:12.073579 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:12.073988 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:40:12.074574 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:12.075983 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:40:12.026586 => 2023-04-07 18:40:12.075924
[0m18:40:12.076364 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:40:12.077242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20865a0a-e1a4-4f44-8fd4-b72ab970801c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd545e50>]}
[0m18:40:12.077899 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:40:12.078681 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:40:12.090038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:12.090651 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:12.091008 [debug] [MainThread]: On master: BEGIN
[0m18:40:12.091373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:40:12.103004 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:12.103481 [debug] [MainThread]: On master: COMMIT
[0m18:40:12.103862 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:12.104195 [debug] [MainThread]: On master: COMMIT
[0m18:40:12.105040 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:40:12.105499 [debug] [MainThread]: On master: Close
[0m18:40:12.106465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:12.106884 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:40:12.107329 [info ] [MainThread]: 
[0m18:40:12.107888 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m18:40:12.108756 [debug] [MainThread]: Command end result
[0m18:40:12.118236 [info ] [MainThread]: 
[0m18:40:12.119049 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:40:12.119939 [info ] [MainThread]: 
[0m18:40:12.121017 [error] [MainThread]: [33mDatabase Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)[0m
[0m18:40:12.122074 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:40:12.122916 [error] [MainThread]:   LINE 21: FROM "postgres"."dbt"."5yearmodel"
[0m18:40:12.123673 [error] [MainThread]:            ^
[0m18:40:12.124445 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:40:12.125180 [info ] [MainThread]: 
[0m18:40:12.125907 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:40:12.126796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd584b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd584c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cd584e10>]}
[0m18:40:12.127475 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:40:21.415021 | 5f7e3e9f-e840-4520-a365-e8fd10082cec ==============================
[0m18:40:21.415021 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:40:21.417270 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:40:21.417638 [debug] [MainThread]: Tracking: tracking
[0m18:40:21.441651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391120510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391120810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391120650>]}
[0m18:40:21.457170 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:40:21.491617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:21.492383 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheatvsCorn.sql
[0m18:40:21.510358 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheatvsCorn.sql
[0m18:40:21.532974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:40:21.540036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f7e3e9f-e840-4520-a365-e8fd10082cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391155ed0>]}
[0m18:40:21.549930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f7e3e9f-e840-4520-a365-e8fd10082cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa390fe4110>]}
[0m18:40:21.550528 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:40:21.551153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f7e3e9f-e840-4520-a365-e8fd10082cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa390fe4850>]}
[0m18:40:21.553416 [info ] [MainThread]: 
[0m18:40:21.555583 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:21.557250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:40:21.574073 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:40:21.574692 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:40:21.575274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:21.593155 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:40:21.594892 [debug] [ThreadPool]: On list_postgres: Close
[0m18:40:21.596943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:40:21.604440 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:40:21.604917 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:40:21.605253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:21.615898 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:40:21.616447 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:40:21.616840 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:40:21.620671 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:40:21.622267 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:40:21.622987 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:40:21.629470 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:21.629892 [debug] [MainThread]: On master: BEGIN
[0m18:40:21.630256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:21.638921 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:21.639418 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:21.639776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:40:21.645220 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:40:21.646918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f7e3e9f-e840-4520-a365-e8fd10082cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3911a00d0>]}
[0m18:40:21.647506 [debug] [MainThread]: On master: ROLLBACK
[0m18:40:21.648135 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:21.648491 [debug] [MainThread]: On master: BEGIN
[0m18:40:21.649103 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:21.649460 [debug] [MainThread]: On master: COMMIT
[0m18:40:21.649769 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:21.650039 [debug] [MainThread]: On master: COMMIT
[0m18:40:21.650444 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:40:21.650761 [debug] [MainThread]: On master: Close
[0m18:40:21.651423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:21.651922 [info ] [MainThread]: 
[0m18:40:21.654049 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:40:21.654596 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:40:21.655480 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:40:21.655865 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:40:21.658597 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:40:21.659530 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:40:21.656159 => 2023-04-07 18:40:21.659401
[0m18:40:21.659945 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:40:21.717758 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:40:21.718629 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:21.719065 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:40:21.719447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:21.728908 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:21.729349 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:21.729641 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:40:21.732585 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:21.741722 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:21.742146 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:40:21.743194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:21.747609 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:21.748139 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:40:21.749027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:21.775477 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:40:21.776188 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:21.776564 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:40:21.777608 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:21.783678 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:21.784020 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:40:21.786930 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:21.788424 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:40:21.660204 => 2023-04-07 18:40:21.788366
[0m18:40:21.788844 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:40:21.789821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7e3e9f-e840-4520-a365-e8fd10082cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa39145b550>]}
[0m18:40:21.790372 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:40:21.792371 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:40:21.793003 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:40:21.793856 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:40:21.795008 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:40:21.795434 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:40:21.797474 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:40:21.798205 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:40:21.795770 => 2023-04-07 18:40:21.798124
[0m18:40:21.798701 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:40:21.805727 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:40:21.806654 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:21.807114 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:40:21.807448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:21.816777 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:21.817215 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:21.817523 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:40:21.820115 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:21.824939 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:21.825598 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:40:21.827028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:21.831060 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:21.831552 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:40:21.832410 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:21.835247 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:40:21.835613 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:21.835884 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:40:21.836900 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:21.839796 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:21.840222 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:40:21.842910 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:21.845325 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:40:21.799005 => 2023-04-07 18:40:21.845253
[0m18:40:21.845755 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:40:21.847037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7e3e9f-e840-4520-a365-e8fd10082cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3915082d0>]}
[0m18:40:21.847791 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:40:21.848536 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:40:21.849082 [debug] [Thread-1  ]: Began running node model.my_project.5YWheatvsCorn
[0m18:40:21.849524 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheatvsCorn .................................. [RUN]
[0m18:40:21.850472 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheatvsCorn'
[0m18:40:21.850885 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheatvsCorn
[0m18:40:21.853967 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheatvsCorn"
[0m18:40:21.855027 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (compile): 2023-04-07 18:40:21.851119 => 2023-04-07 18:40:21.854941
[0m18:40:21.855502 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheatvsCorn
[0m18:40:21.861939 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheatvsCorn"
[0m18:40:21.863132 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:40:21.863744 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: BEGIN
[0m18:40:21.864183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:21.874120 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:21.874636 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:40:21.875216 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheatvsCorn"} */

  create view "postgres"."dbt"."5YWheatvsCorn__dbt_tmp" as (
    SELECT 
    DATEPART(year, date) AS year,
    DATEPART(month, date) AS month,
    CORR(price, 
         (SELECT price 
          FROM postgres.dbt.5yearmodel 
          WHERE commodity = 'Wheat' AND 
                DATEPART(year, date) = DATEPART(year, commodities2.date) AND 
                DATEPART(month, date) = DATEPART(month, commodities2.date)
         )
    ) AS correlation
WHERE 
    commodity = 'Corn'
GROUP BY 
    DATEPART(year, date), 
    DATEPART(month, date)

FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:40:21.876304 [debug] [Thread-1  ]: Postgres adapter: Postgres error: trailing junk after numeric literal at or near ".5y"
LINE 9:           FROM postgres.dbt.5yearmodel 
                                   ^

[0m18:40:21.876753 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: ROLLBACK
[0m18:40:21.877686 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (execute): 2023-04-07 18:40:21.855768 => 2023-04-07 18:40:21.877588
[0m18:40:21.878071 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: Close
[0m18:40:21.881120 [debug] [Thread-1  ]: Database Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)
  trailing junk after numeric literal at or near ".5y"
  LINE 9:           FROM postgres.dbt.5yearmodel 
                                     ^
  compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:40:21.881885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7e3e9f-e840-4520-a365-e8fd10082cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3914ebcd0>]}
[0m18:40:21.882950 [error] [Thread-1  ]: 3 of 4 ERROR creating sql view model dbt.5YWheatvsCorn ......................... [[31mERROR[0m in 0.03s]
[0m18:40:21.883824 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheatvsCorn
[0m18:40:21.884415 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:40:21.884834 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:40:21.885966 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:40:21.886511 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:40:21.890587 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:40:21.891700 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:40:21.886851 => 2023-04-07 18:40:21.891501
[0m18:40:21.892313 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:40:21.899496 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:40:21.900278 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:21.900585 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:40:21.900836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:21.910569 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:21.911014 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:21.911324 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:40:21.914174 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:21.917771 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:21.918264 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:40:21.919048 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:21.921378 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:40:21.921674 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:21.921939 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:40:21.922986 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:21.926946 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:21.927413 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:40:21.928170 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:21.929580 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:40:21.892612 => 2023-04-07 18:40:21.929521
[0m18:40:21.929912 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:40:21.930795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f7e3e9f-e840-4520-a365-e8fd10082cec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391560d50>]}
[0m18:40:21.931346 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:40:21.932042 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:40:21.968309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:21.968835 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:21.969175 [debug] [MainThread]: On master: BEGIN
[0m18:40:21.969508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:40:21.978890 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:21.979376 [debug] [MainThread]: On master: COMMIT
[0m18:40:21.979688 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:21.979982 [debug] [MainThread]: On master: COMMIT
[0m18:40:21.980427 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:40:21.980744 [debug] [MainThread]: On master: Close
[0m18:40:21.981422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:21.981773 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:40:21.982078 [info ] [MainThread]: 
[0m18:40:21.982549 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m18:40:21.983507 [debug] [MainThread]: Command end result
[0m18:40:21.991737 [info ] [MainThread]: 
[0m18:40:21.992572 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:40:21.993143 [info ] [MainThread]: 
[0m18:40:21.993704 [error] [MainThread]: [33mDatabase Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)[0m
[0m18:40:21.994206 [error] [MainThread]:   trailing junk after numeric literal at or near ".5y"
[0m18:40:21.994772 [error] [MainThread]:   LINE 9:           FROM postgres.dbt.5yearmodel 
[0m18:40:21.995448 [error] [MainThread]:                                      ^
[0m18:40:21.996431 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:40:21.997154 [info ] [MainThread]: 
[0m18:40:21.998123 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:40:21.998959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391101bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa390ed31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3914e55d0>]}
[0m18:40:21.999764 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:40:58.737785 | cff274a9-eba6-43d2-907e-4ba94ae872cd ==============================
[0m18:40:58.737785 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:40:58.740065 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:40:58.740433 [debug] [MainThread]: Tracking: tracking
[0m18:40:58.760790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3dff7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3dff7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3dff7710>]}
[0m18:40:58.776724 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:40:58.810265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:58.810993 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheatvsCorn.sql
[0m18:40:58.826873 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheatvsCorn.sql
[0m18:40:58.848126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:40:58.855638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cff274a9-eba6-43d2-907e-4ba94ae872cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e02bb90>]}
[0m18:40:58.865067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cff274a9-eba6-43d2-907e-4ba94ae872cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3dfc3250>]}
[0m18:40:58.865708 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:40:58.866343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff274a9-eba6-43d2-907e-4ba94ae872cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3dfc3c50>]}
[0m18:40:58.868767 [info ] [MainThread]: 
[0m18:40:58.871597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:58.873365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:40:58.891858 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:40:58.892342 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:40:58.892703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:58.927010 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:40:58.929018 [debug] [ThreadPool]: On list_postgres: Close
[0m18:40:58.931059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:40:58.939478 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:40:58.939918 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:40:58.940264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:58.950410 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:40:58.950846 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:40:58.951201 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:40:58.955167 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:40:58.956820 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:40:58.957538 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:40:58.964533 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:58.965039 [debug] [MainThread]: On master: BEGIN
[0m18:40:58.965372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:58.973734 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:58.974254 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:58.974593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:40:58.979932 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:40:58.981710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff274a9-eba6-43d2-907e-4ba94ae872cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e06d9d0>]}
[0m18:40:58.982367 [debug] [MainThread]: On master: ROLLBACK
[0m18:40:58.983115 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:58.983570 [debug] [MainThread]: On master: BEGIN
[0m18:40:58.984351 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:58.984702 [debug] [MainThread]: On master: COMMIT
[0m18:40:58.985011 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:58.985289 [debug] [MainThread]: On master: COMMIT
[0m18:40:58.985746 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:40:58.986046 [debug] [MainThread]: On master: Close
[0m18:40:58.986806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:58.987355 [info ] [MainThread]: 
[0m18:40:58.989861 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:40:58.990508 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:40:58.991623 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:40:58.992209 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:40:58.994884 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:40:58.995884 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:40:58.992579 => 2023-04-07 18:40:58.995702
[0m18:40:58.996660 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:40:59.050131 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:40:59.051113 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:59.051496 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:40:59.051775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:59.060684 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:59.061467 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:59.061903 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:40:59.068242 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:59.076449 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:59.076826 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:40:59.077698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:59.080894 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:59.081198 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:40:59.081986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:59.103546 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:40:59.103946 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:59.104223 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:40:59.105522 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:59.111900 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:40:59.112249 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:40:59.114040 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:59.115575 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:40:58.997291 => 2023-04-07 18:40:59.115519
[0m18:40:59.115920 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:40:59.116696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff274a9-eba6-43d2-907e-4ba94ae872cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e552190>]}
[0m18:40:59.117298 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:40:59.118995 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:40:59.119484 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:40:59.120116 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:40:59.121377 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:40:59.121848 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:40:59.123904 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:40:59.124713 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:40:59.122132 => 2023-04-07 18:40:59.124632
[0m18:40:59.125134 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:40:59.132555 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:40:59.133480 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:59.133960 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:40:59.134305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:59.143315 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:59.143732 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:59.144047 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:40:59.146438 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:59.151793 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:59.152340 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:40:59.153393 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:59.157032 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:59.157370 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:40:59.158160 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:59.160620 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:40:59.160924 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:59.161181 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:40:59.162080 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:59.165597 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:40:59.165985 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:40:59.168916 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:59.171158 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:40:59.125489 => 2023-04-07 18:40:59.171091
[0m18:40:59.171568 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:40:59.172425 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff274a9-eba6-43d2-907e-4ba94ae872cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e552210>]}
[0m18:40:59.173059 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:40:59.173986 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:40:59.174581 [debug] [Thread-1  ]: Began running node model.my_project.5YWheatvsCorn
[0m18:40:59.175011 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheatvsCorn .................................. [RUN]
[0m18:40:59.175914 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheatvsCorn'
[0m18:40:59.176315 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheatvsCorn
[0m18:40:59.179955 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheatvsCorn"
[0m18:40:59.180899 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (compile): 2023-04-07 18:40:59.176558 => 2023-04-07 18:40:59.180820
[0m18:40:59.181319 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheatvsCorn
[0m18:40:59.188076 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheatvsCorn"
[0m18:40:59.189523 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:40:59.190074 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: BEGIN
[0m18:40:59.190502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:59.199584 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:59.200124 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:40:59.200544 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheatvsCorn"} */

  create view "postgres"."dbt"."5YWheatvsCorn__dbt_tmp" as (
    SELECT 
    DATE_PART('year', date) AS year,
    DATE_PART('month', date) AS month,
    CORR(price, 
         (SELECT price 
          FROM "postgres"."dbt"."5yearmodel" 
          WHERE commodity = 'Wheat' AND 
                DATE_PART('year', date) = DATE_PART('year', commodities2.date) AND 
                DATE_PART('month', date) = DATE_PART('month', commodities2.date)
         )
    ) AS correlation
FROM 
    "postgres"."dbt"."5yearmodel" 
WHERE 
    commodity = 'Corn'
GROUP BY 
    DATE_PART('year', date), 
    DATE_PART('month', date)
  );
[0m18:40:59.202617 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 5:     DATE_PART('year', date) AS year,
                              ^

[0m18:40:59.203229 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: ROLLBACK
[0m18:40:59.204124 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (execute): 2023-04-07 18:40:59.181683 => 2023-04-07 18:40:59.204027
[0m18:40:59.204757 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: Close
[0m18:40:59.207760 [debug] [Thread-1  ]: Database Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)
  column "date" does not exist
  LINE 5:     DATE_PART('year', date) AS year,
                                ^
  compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:40:59.208403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff274a9-eba6-43d2-907e-4ba94ae872cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e539a10>]}
[0m18:40:59.208958 [error] [Thread-1  ]: 3 of 4 ERROR creating sql view model dbt.5YWheatvsCorn ......................... [[31mERROR[0m in 0.03s]
[0m18:40:59.209600 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheatvsCorn
[0m18:40:59.210157 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:40:59.210652 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:40:59.211906 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:40:59.212365 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:40:59.215829 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:40:59.216698 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:40:59.212622 => 2023-04-07 18:40:59.216584
[0m18:40:59.217198 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:40:59.224758 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:40:59.225577 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:59.225937 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:40:59.226233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:40:59.235839 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:40:59.236514 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:59.237091 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:40:59.240470 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:40:59.244149 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:59.244502 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:40:59.245373 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:40:59.247480 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:40:59.247823 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:59.248080 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:40:59.249149 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:40:59.253342 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:40:59.253993 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:40:59.254749 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:40:59.256218 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:40:59.217481 => 2023-04-07 18:40:59.256160
[0m18:40:59.256743 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:40:59.257616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff274a9-eba6-43d2-907e-4ba94ae872cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e656f50>]}
[0m18:40:59.258202 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:40:59.258914 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:40:59.304571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:59.305311 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:59.305824 [debug] [MainThread]: On master: BEGIN
[0m18:40:59.306297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:40:59.316474 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:40:59.317000 [debug] [MainThread]: On master: COMMIT
[0m18:40:59.317373 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:59.317713 [debug] [MainThread]: On master: COMMIT
[0m18:40:59.318207 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:40:59.318702 [debug] [MainThread]: On master: Close
[0m18:40:59.319490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:59.319831 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:40:59.320257 [info ] [MainThread]: 
[0m18:40:59.320807 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m18:40:59.321668 [debug] [MainThread]: Command end result
[0m18:40:59.331781 [info ] [MainThread]: 
[0m18:40:59.332577 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:40:59.333235 [info ] [MainThread]: 
[0m18:40:59.333857 [error] [MainThread]: [33mDatabase Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)[0m
[0m18:40:59.334548 [error] [MainThread]:   column "date" does not exist
[0m18:40:59.335173 [error] [MainThread]:   LINE 5:     DATE_PART('year', date) AS year,
[0m18:40:59.336111 [error] [MainThread]:                                 ^
[0m18:40:59.336820 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:40:59.337699 [info ] [MainThread]: 
[0m18:40:59.338278 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:40:59.338901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e637cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e637f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d3e637a10>]}
[0m18:40:59.339374 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:41:43.576099 | fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec ==============================
[0m18:41:43.576099 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:41:43.579044 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:41:43.579580 [debug] [MainThread]: Tracking: tracking
[0m18:41:43.608821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202fcd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202fcdb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202fcd990>]}
[0m18:41:43.626784 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:41:43.698004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:41:43.698693 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheatvsCorn.sql
[0m18:41:43.719681 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheatvsCorn.sql
[0m18:41:43.744241 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:41:43.751415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f820326d050>]}
[0m18:41:43.761703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202faa2d0>]}
[0m18:41:43.762354 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:41:43.763199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202faabd0>]}
[0m18:41:43.765356 [info ] [MainThread]: 
[0m18:41:43.767716 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:43.769734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:41:43.789313 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:41:43.789986 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:41:43.790523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:43.860945 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:41:43.862799 [debug] [ThreadPool]: On list_postgres: Close
[0m18:41:43.864900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:41:43.873116 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:41:43.873600 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:41:43.873995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:43.882804 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:41:43.883292 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:41:43.883723 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:41:43.889302 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:41:43.890953 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:41:43.891577 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:41:43.898436 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:43.898876 [debug] [MainThread]: On master: BEGIN
[0m18:41:43.899230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:43.907941 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:41:43.908372 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:43.908699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:43.916869 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:41:43.918557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202fbe190>]}
[0m18:41:43.919138 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:43.919891 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:43.920301 [debug] [MainThread]: On master: BEGIN
[0m18:41:43.921054 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:41:43.921488 [debug] [MainThread]: On master: COMMIT
[0m18:41:43.921794 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:43.922109 [debug] [MainThread]: On master: COMMIT
[0m18:41:43.922646 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:41:43.922990 [debug] [MainThread]: On master: Close
[0m18:41:43.923756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:43.924288 [info ] [MainThread]: 
[0m18:41:43.927273 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:41:43.928001 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:41:43.929129 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:41:43.929621 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:41:43.932342 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:41:43.934278 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:41:43.929947 => 2023-04-07 18:41:43.933927
[0m18:41:43.935379 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:41:43.999913 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:41:44.015141 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:41:44.016284 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:41:44.016883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:44.026652 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:41:44.027105 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:41:44.027455 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:41:44.032846 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:41:44.041745 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:41:44.042196 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:41:44.043542 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:41:44.047470 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:41:44.047884 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:41:44.048985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:41:44.077107 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:41:44.077519 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:41:44.077796 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:41:44.078893 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:41:44.086042 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:41:44.086432 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:41:44.088966 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:41:44.091265 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:41:43.935797 => 2023-04-07 18:41:44.091167
[0m18:41:44.091779 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:41:44.092760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f820341b510>]}
[0m18:41:44.093373 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.16s]
[0m18:41:44.095075 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:41:44.095728 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:41:44.096275 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:41:44.097559 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:41:44.098034 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:41:44.100018 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:41:44.101393 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:41:44.098285 => 2023-04-07 18:41:44.101270
[0m18:41:44.101951 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:41:44.108519 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:41:44.109785 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:41:44.110377 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:41:44.110885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:44.121305 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:41:44.121776 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:41:44.122257 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:41:44.125755 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:41:44.130560 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:41:44.130966 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:41:44.131674 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:41:44.135078 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:41:44.135473 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:41:44.136360 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:41:44.140539 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:41:44.141126 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:41:44.141505 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:41:44.142379 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:41:44.145460 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:41:44.145857 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:41:44.147414 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:41:44.148900 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:41:44.102222 => 2023-04-07 18:41:44.148821
[0m18:41:44.149339 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:41:44.150324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f820341b150>]}
[0m18:41:44.151080 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:41:44.151830 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:41:44.152717 [debug] [Thread-1  ]: Began running node model.my_project.5YWheatvsCorn
[0m18:41:44.153286 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheatvsCorn .................................. [RUN]
[0m18:41:44.154418 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheatvsCorn'
[0m18:41:44.154921 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheatvsCorn
[0m18:41:44.158768 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheatvsCorn"
[0m18:41:44.159837 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (compile): 2023-04-07 18:41:44.155240 => 2023-04-07 18:41:44.159709
[0m18:41:44.160539 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheatvsCorn
[0m18:41:44.168197 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheatvsCorn"
[0m18:41:44.169166 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:41:44.169703 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: BEGIN
[0m18:41:44.170044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:44.180933 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:41:44.181548 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheatvsCorn"
[0m18:41:44.181923 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheatvsCorn"} */

  create view "postgres"."dbt"."5YWheatvsCorn__dbt_tmp" as (
    SELECT 
    DATE_PART('year', month) AS year,
    DATE_PART('month', month) AS month,
    CORR(price, 
         (SELECT price 
          FROM "postgres"."dbt"."5yearmodel" 
          WHERE commodity = 'Wheat' AND 
                DATE_PART('year', month) = DATE_PART('year', commodities2.date) AND 
                DATE_PART('month', month) = DATE_PART('month', commodities2.date)
         )
    ) AS correlation
FROM 
    "postgres"."dbt"."5yearmodel" 
WHERE 
    commodity = 'Corn'
GROUP BY 
    DATE_PART('year', month), 
    DATE_PART('month', month)
  );
[0m18:41:44.184132 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "commodities2"
LINE 11: ...     DATE_PART('year', month) = DATE_PART('year', commoditie...
                                                              ^

[0m18:41:44.184544 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: ROLLBACK
[0m18:41:44.185255 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheatvsCorn (execute): 2023-04-07 18:41:44.161208 => 2023-04-07 18:41:44.185165
[0m18:41:44.185665 [debug] [Thread-1  ]: On model.my_project.5YWheatvsCorn: Close
[0m18:41:44.196794 [debug] [Thread-1  ]: Database Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)
  missing FROM-clause entry for table "commodities2"
  LINE 11: ...     DATE_PART('year', month) = DATE_PART('year', commoditie...
                                                                ^
  compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:41:44.197387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82034d4850>]}
[0m18:41:44.197996 [error] [Thread-1  ]: 3 of 4 ERROR creating sql view model dbt.5YWheatvsCorn ......................... [[31mERROR[0m in 0.04s]
[0m18:41:44.198769 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheatvsCorn
[0m18:41:44.199408 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:41:44.200186 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:41:44.201404 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:41:44.201854 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:41:44.205448 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:41:44.206337 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:41:44.202223 => 2023-04-07 18:41:44.206231
[0m18:41:44.206847 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:41:44.214983 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:41:44.215854 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:41:44.216347 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:41:44.216914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:44.235464 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:41:44.236148 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:41:44.236587 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:41:44.241100 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:41:44.246035 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:41:44.246494 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:41:44.247435 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:41:44.250811 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:41:44.251238 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:41:44.251559 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:41:44.252733 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:41:44.256185 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:41:44.256617 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:41:44.257351 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:41:44.259068 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:41:44.207177 => 2023-04-07 18:41:44.258990
[0m18:41:44.259545 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:41:44.260439 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdd4a9f6-62cc-4d60-95cf-c62f936fb8ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8202fbe490>]}
[0m18:41:44.261067 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:41:44.261935 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:41:44.341266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:44.342045 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:44.342555 [debug] [MainThread]: On master: BEGIN
[0m18:41:44.342933 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:44.353115 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:41:44.353592 [debug] [MainThread]: On master: COMMIT
[0m18:41:44.354031 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:44.354596 [debug] [MainThread]: On master: COMMIT
[0m18:41:44.355290 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:41:44.355860 [debug] [MainThread]: On master: Close
[0m18:41:44.356675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:44.357124 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:41:44.357568 [info ] [MainThread]: 
[0m18:41:44.358255 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m18:41:44.359193 [debug] [MainThread]: Command end result
[0m18:41:44.369494 [info ] [MainThread]: 
[0m18:41:44.370264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:41:44.371226 [info ] [MainThread]: 
[0m18:41:44.372031 [error] [MainThread]: [33mDatabase Error in model 5YWheatvsCorn (models/5YWheatvsCorn.sql)[0m
[0m18:41:44.372708 [error] [MainThread]:   missing FROM-clause entry for table "commodities2"
[0m18:41:44.373382 [error] [MainThread]:   LINE 11: ...     DATE_PART('year', month) = DATE_PART('year', commoditie...
[0m18:41:44.374546 [error] [MainThread]:                                                                 ^
[0m18:41:44.375305 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheatvsCorn.sql
[0m18:41:44.376183 [info ] [MainThread]: 
[0m18:41:44.376957 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:41:44.377739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82031da490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203197250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f820342cb90>]}
[0m18:41:44.378386 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:43:59.961882 | 4ff19a42-65a6-4104-9698-9501c9474224 ==============================
[0m18:43:59.961882 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:43:59.964710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:43:59.965189 [debug] [MainThread]: Tracking: tracking
[0m18:43:59.987954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d781d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d781d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d781d810>]}
[0m18:44:00.005600 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:44:00.077789 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m18:44:00.078399 [debug] [MainThread]: Partial parsing: added file: my_project://models/5YWheat.sql
[0m18:44:00.078696 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/5YWheatvsCorn.sql
[0m18:44:00.099198 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheat.sql
[0m18:44:00.122856 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:44:00.130197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ff19a42-65a6-4104-9698-9501c9474224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d79af0d0>]}
[0m18:44:00.139901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ff19a42-65a6-4104-9698-9501c9474224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d7796210>]}
[0m18:44:00.140532 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:44:00.141351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ff19a42-65a6-4104-9698-9501c9474224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d77e9150>]}
[0m18:44:00.143456 [info ] [MainThread]: 
[0m18:44:00.145467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:00.147103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:44:00.162837 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:44:00.163328 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:44:00.163659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:00.220584 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:44:00.222353 [debug] [ThreadPool]: On list_postgres: Close
[0m18:44:00.224154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:44:00.231073 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:44:00.231468 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:44:00.231770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:00.240573 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:44:00.241060 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:44:00.241367 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:44:00.244864 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:44:00.246478 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:44:00.247121 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:44:00.253570 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:00.253978 [debug] [MainThread]: On master: BEGIN
[0m18:44:00.254281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:00.263159 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:44:00.263573 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:00.263873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:00.269557 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:44:00.271197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ff19a42-65a6-4104-9698-9501c9474224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d79af350>]}
[0m18:44:00.271672 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:00.272255 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:00.272566 [debug] [MainThread]: On master: BEGIN
[0m18:44:00.273265 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:44:00.273607 [debug] [MainThread]: On master: COMMIT
[0m18:44:00.273921 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:00.274220 [debug] [MainThread]: On master: COMMIT
[0m18:44:00.274731 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:44:00.275077 [debug] [MainThread]: On master: Close
[0m18:44:00.275852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:00.276409 [info ] [MainThread]: 
[0m18:44:00.279674 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:44:00.280324 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:44:00.281386 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:44:00.281909 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:44:00.284628 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:44:00.286090 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:44:00.282273 => 2023-04-07 18:44:00.285931
[0m18:44:00.287014 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:44:00.342707 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:44:00.343554 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:00.343886 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:44:00.344197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:00.352761 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:44:00.353165 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:00.353480 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:44:00.356772 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:44:00.364991 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:00.365411 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:44:00.366214 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:00.369624 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:00.369978 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:44:00.370799 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:00.393974 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:44:00.394451 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:00.394772 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:44:00.395865 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:44:00.402246 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:00.402625 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:44:00.404590 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:44:00.406058 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:44:00.287509 => 2023-04-07 18:44:00.406001
[0m18:44:00.406392 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:44:00.407244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ff19a42-65a6-4104-9698-9501c9474224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d76dba10>]}
[0m18:44:00.407802 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:44:00.409540 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:44:00.410187 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:44:00.411086 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:44:00.412183 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:44:00.412625 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:44:00.414640 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:44:00.415628 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:44:00.412929 => 2023-04-07 18:44:00.415465
[0m18:44:00.416407 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:44:00.423758 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:44:00.424810 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:00.425238 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:44:00.425764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:00.434529 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:44:00.435020 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:00.435501 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:44:00.439155 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:44:00.444204 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:00.444596 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:44:00.445931 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:00.449485 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:00.449926 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:44:00.451115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:00.454808 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:44:00.455248 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:00.455566 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:44:00.456610 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:44:00.459791 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:00.460197 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:44:00.461747 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:44:00.463489 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:44:00.417035 => 2023-04-07 18:44:00.463427
[0m18:44:00.463888 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:44:00.464681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ff19a42-65a6-4104-9698-9501c9474224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d7b52c50>]}
[0m18:44:00.465280 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:44:00.466012 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:44:00.466624 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:44:00.467348 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:44:00.468903 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:44:00.469760 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:44:00.473153 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:44:00.474053 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:44:00.470164 => 2023-04-07 18:44:00.473961
[0m18:44:00.474497 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:44:00.481619 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:44:00.482721 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:44:00.483165 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:44:00.483628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:00.492505 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:44:00.492882 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:44:00.493169 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT WHERE commodity= 'Corn'
FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:44:00.494050 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 5: FROM "postgres"."dbt"."5yearmodel"
        ^

[0m18:44:00.494364 [debug] [Thread-1  ]: On model.my_project.5YWheat: ROLLBACK
[0m18:44:00.495043 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:44:00.474823 => 2023-04-07 18:44:00.494970
[0m18:44:00.495383 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:44:00.507746 [debug] [Thread-1  ]: Database Error in model 5YWheat (models/5YWheat.sql)
  syntax error at or near "FROM"
  LINE 5: FROM "postgres"."dbt"."5yearmodel"
          ^
  compiled Code at target/run/my_project/models/5YWheat.sql
[0m18:44:00.508287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ff19a42-65a6-4104-9698-9501c9474224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d7b52c90>]}
[0m18:44:00.509072 [error] [Thread-1  ]: 3 of 4 ERROR creating sql view model dbt.5YWheat ............................... [[31mERROR[0m in 0.04s]
[0m18:44:00.509765 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:44:00.510359 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:44:00.510978 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:44:00.512052 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:44:00.512518 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:44:00.516439 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:44:00.517429 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:44:00.512957 => 2023-04-07 18:44:00.517239
[0m18:44:00.518069 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:44:00.525568 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:44:00.526511 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:00.526911 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:44:00.527195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:00.537043 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:44:00.537464 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:00.537768 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:44:00.540593 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:44:00.544267 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:00.544647 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:44:00.545481 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:00.547608 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:44:00.547948 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:00.548304 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:44:00.549374 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:44:00.553223 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:00.553630 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:44:00.554175 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:44:00.555627 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:44:00.518424 => 2023-04-07 18:44:00.555572
[0m18:44:00.555949 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:44:00.556740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ff19a42-65a6-4104-9698-9501c9474224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d7c5ee90>]}
[0m18:44:00.557271 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:44:00.557908 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:44:00.597832 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:00.598501 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:00.598979 [debug] [MainThread]: On master: BEGIN
[0m18:44:00.599429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:00.610859 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:44:00.611463 [debug] [MainThread]: On master: COMMIT
[0m18:44:00.611859 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:00.612217 [debug] [MainThread]: On master: COMMIT
[0m18:44:00.612743 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:44:00.613166 [debug] [MainThread]: On master: Close
[0m18:44:00.613922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:00.614266 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:44:00.614658 [info ] [MainThread]: 
[0m18:44:00.615281 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m18:44:00.616370 [debug] [MainThread]: Command end result
[0m18:44:00.625331 [info ] [MainThread]: 
[0m18:44:00.626082 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:44:00.626730 [info ] [MainThread]: 
[0m18:44:00.627337 [error] [MainThread]: [33mDatabase Error in model 5YWheat (models/5YWheat.sql)[0m
[0m18:44:00.628023 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:44:00.628660 [error] [MainThread]:   LINE 5: FROM "postgres"."dbt"."5yearmodel"
[0m18:44:00.629257 [error] [MainThread]:           ^
[0m18:44:00.629881 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheat.sql
[0m18:44:00.630500 [info ] [MainThread]: 
[0m18:44:00.631110 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:44:00.631826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d7c52410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d7c52b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d7c521d0>]}
[0m18:44:00.632305 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:44:12.952128 | dd187478-f476-4c68-9471-02f90c34a08d ==============================
[0m18:44:12.952128 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:44:12.954800 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:44:12.955249 [debug] [MainThread]: Tracking: tracking
[0m18:44:12.975372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc286f2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc286f2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc286f2910>]}
[0m18:44:12.990615 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:44:13.051361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:13.052190 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheat.sql
[0m18:44:13.072762 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheat.sql
[0m18:44:13.094917 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:44:13.102095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd187478-f476-4c68-9471-02f90c34a08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2872b810>]}
[0m18:44:13.113894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd187478-f476-4c68-9471-02f90c34a08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc286c3290>]}
[0m18:44:13.114940 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:44:13.115915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd187478-f476-4c68-9471-02f90c34a08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc286c3fd0>]}
[0m18:44:13.119058 [info ] [MainThread]: 
[0m18:44:13.121436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:13.122908 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:44:13.138423 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:44:13.138887 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:44:13.139219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:13.168297 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:44:13.168715 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:44:13.169039 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:44:13.172626 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:44:13.174510 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:44:13.175284 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:44:13.182584 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:13.183016 [debug] [MainThread]: On master: BEGIN
[0m18:44:13.183396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:13.192169 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:44:13.192574 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:13.192876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:13.198606 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:44:13.200219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd187478-f476-4c68-9471-02f90c34a08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc28777690>]}
[0m18:44:13.200682 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:13.201242 [debug] [MainThread]: On master: Close
[0m18:44:13.201911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:13.202383 [info ] [MainThread]: 
[0m18:44:13.206031 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:44:13.206806 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:44:13.207285 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:44:13.209306 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:44:13.210310 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:44:13.207571 => 2023-04-07 18:44:13.210099
[0m18:44:13.210749 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:44:13.211079 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:44:13.211003 => 2023-04-07 18:44:13.211032
[0m18:44:13.213775 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:44:13.214838 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:44:13.216200 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:44:13.216992 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:44:13.219626 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:44:13.220370 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:44:13.217377 => 2023-04-07 18:44:13.220291
[0m18:44:13.220836 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:44:13.221279 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:44:13.221208 => 2023-04-07 18:44:13.221220
[0m18:44:13.222127 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:44:13.222549 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:44:13.223238 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:44:13.223572 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:44:13.227049 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:44:13.228378 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:44:13.223807 => 2023-04-07 18:44:13.228258
[0m18:44:13.228918 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:44:13.229287 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:44:13.229214 => 2023-04-07 18:44:13.229228
[0m18:44:13.230332 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:44:13.230824 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:44:13.231445 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:44:13.231766 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:44:13.234874 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:44:13.235647 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:44:13.232006 => 2023-04-07 18:44:13.235573
[0m18:44:13.236082 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:44:13.236425 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:44:13.236317 => 2023-04-07 18:44:13.236360
[0m18:44:13.237122 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:44:13.306705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:13.308109 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:44:13.309995 [debug] [MainThread]: Command end result
[0m18:44:13.322536 [info ] [MainThread]: Done.
[0m18:44:13.323648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc28ad4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc286c3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc28a06190>]}
[0m18:44:13.324332 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:44:20.243489 | 32613729-2f17-43bb-9f46-6a9722edc7dd ==============================
[0m18:44:20.243489 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:44:20.245959 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:44:20.246351 [debug] [MainThread]: Tracking: tracking
[0m18:44:20.266505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef311b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef2f86090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef311b510>]}
[0m18:44:20.282432 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:44:20.314031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:20.314482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:20.315513 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:44:20.324166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32613729-2f17-43bb-9f46-6a9722edc7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef2c2a450>]}
[0m18:44:20.333236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32613729-2f17-43bb-9f46-6a9722edc7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef2fcacd0>]}
[0m18:44:20.333802 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:44:20.334577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32613729-2f17-43bb-9f46-6a9722edc7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef2fcad90>]}
[0m18:44:20.336493 [info ] [MainThread]: 
[0m18:44:20.338977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:20.340835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:44:20.357315 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:44:20.357941 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:44:20.358451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:20.374269 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:44:20.376009 [debug] [ThreadPool]: On list_postgres: Close
[0m18:44:20.378166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:44:20.385978 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:44:20.386457 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:44:20.386966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:20.396877 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:44:20.397299 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:44:20.397604 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:44:20.401730 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:44:20.404010 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:44:20.404938 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:44:20.411825 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:20.412237 [debug] [MainThread]: On master: BEGIN
[0m18:44:20.412548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:20.421523 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:44:20.421941 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:20.422258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:20.427741 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:44:20.429262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32613729-2f17-43bb-9f46-6a9722edc7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef32b1a50>]}
[0m18:44:20.429739 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:20.430333 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:20.430673 [debug] [MainThread]: On master: BEGIN
[0m18:44:20.431423 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:44:20.431777 [debug] [MainThread]: On master: COMMIT
[0m18:44:20.432089 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:20.432371 [debug] [MainThread]: On master: COMMIT
[0m18:44:20.432866 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:44:20.433177 [debug] [MainThread]: On master: Close
[0m18:44:20.433889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:20.434426 [info ] [MainThread]: 
[0m18:44:20.436842 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:44:20.437383 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:44:20.438420 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:44:20.438876 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:44:20.441090 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:44:20.442232 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:44:20.439197 => 2023-04-07 18:44:20.442117
[0m18:44:20.442637 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:44:20.502540 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:44:20.503547 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:20.504015 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:44:20.504310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:20.513936 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:44:20.514336 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:20.514624 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:44:20.519317 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:44:20.526665 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:20.527045 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:44:20.528024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:20.531830 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:20.532221 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:44:20.533080 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:20.556912 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:44:20.557386 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:20.557743 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:44:20.558872 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:44:20.566267 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:44:20.566763 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:44:20.568906 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:44:20.570949 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:44:20.442891 => 2023-04-07 18:44:20.570830
[0m18:44:20.571416 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:44:20.572226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32613729-2f17-43bb-9f46-6a9722edc7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef33a5710>]}
[0m18:44:20.572831 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:44:20.574764 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:44:20.575397 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:44:20.576162 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:44:20.577478 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:44:20.577973 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:44:20.580069 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:44:20.581061 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:44:20.578314 => 2023-04-07 18:44:20.580936
[0m18:44:20.581766 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:44:20.588673 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:44:20.589538 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:20.590044 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:44:20.590424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:20.599822 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:44:20.600298 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:20.600609 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:44:20.603399 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:44:20.607854 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:20.608248 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:44:20.608983 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:20.612279 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:20.612643 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:44:20.613388 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:20.615835 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:44:20.616142 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:20.616409 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:44:20.617536 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:44:20.620754 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:44:20.621308 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:44:20.623753 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:44:20.625496 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:44:20.582270 => 2023-04-07 18:44:20.625434
[0m18:44:20.625894 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:44:20.626667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32613729-2f17-43bb-9f46-6a9722edc7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef33a3310>]}
[0m18:44:20.627430 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:44:20.628125 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:44:20.628778 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:44:20.629215 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:44:20.630154 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:44:20.630583 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:44:20.633703 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:44:20.634743 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:44:20.630833 => 2023-04-07 18:44:20.634613
[0m18:44:20.635227 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:44:20.642049 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:44:20.643753 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:44:20.644252 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:44:20.644672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:20.653483 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:44:20.654044 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:44:20.654429 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT WHERE commodity= 'Wheat'
FROM "postgres"."dbt"."5yearmodel"
  );
[0m18:44:20.655278 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 5: FROM "postgres"."dbt"."5yearmodel"
        ^

[0m18:44:20.655918 [debug] [Thread-1  ]: On model.my_project.5YWheat: ROLLBACK
[0m18:44:20.657239 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:44:20.635584 => 2023-04-07 18:44:20.657088
[0m18:44:20.657749 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:44:20.666793 [debug] [Thread-1  ]: Database Error in model 5YWheat (models/5YWheat.sql)
  syntax error at or near "FROM"
  LINE 5: FROM "postgres"."dbt"."5yearmodel"
          ^
  compiled Code at target/run/my_project/models/5YWheat.sql
[0m18:44:20.667326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32613729-2f17-43bb-9f46-6a9722edc7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef32d0990>]}
[0m18:44:20.667852 [error] [Thread-1  ]: 3 of 4 ERROR creating sql view model dbt.5YWheat ............................... [[31mERROR[0m in 0.04s]
[0m18:44:20.668483 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:44:20.669024 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:44:20.669597 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:44:20.670758 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:44:20.671565 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:44:20.675461 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:44:20.676253 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:44:20.672028 => 2023-04-07 18:44:20.676157
[0m18:44:20.676824 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:44:20.683874 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:44:20.684676 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:20.685319 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:44:20.685739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:20.695057 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:44:20.695449 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:20.695745 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:44:20.698433 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:44:20.701732 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:20.702080 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:44:20.702968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:44:20.706101 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:44:20.706795 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:20.707233 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:44:20.708226 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:44:20.711905 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:44:20.712281 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:44:20.712941 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:44:20.714318 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:44:20.677093 => 2023-04-07 18:44:20.714264
[0m18:44:20.714642 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:44:20.715338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32613729-2f17-43bb-9f46-6a9722edc7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef33e3690>]}
[0m18:44:20.715865 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:44:20.716590 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:44:20.746761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:20.747315 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:20.747771 [debug] [MainThread]: On master: BEGIN
[0m18:44:20.748107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:20.758334 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:44:20.758903 [debug] [MainThread]: On master: COMMIT
[0m18:44:20.759327 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:20.759635 [debug] [MainThread]: On master: COMMIT
[0m18:44:20.760135 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:44:20.760560 [debug] [MainThread]: On master: Close
[0m18:44:20.761351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:20.761720 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:44:20.762096 [info ] [MainThread]: 
[0m18:44:20.762717 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m18:44:20.763604 [debug] [MainThread]: Command end result
[0m18:44:20.770884 [info ] [MainThread]: 
[0m18:44:20.771681 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:44:20.772532 [info ] [MainThread]: 
[0m18:44:20.773261 [error] [MainThread]: [33mDatabase Error in model 5YWheat (models/5YWheat.sql)[0m
[0m18:44:20.773777 [error] [MainThread]:   syntax error at or near "FROM"
[0m18:44:20.774271 [error] [MainThread]:   LINE 5: FROM "postgres"."dbt"."5yearmodel"
[0m18:44:20.774815 [error] [MainThread]:           ^
[0m18:44:20.775496 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheat.sql
[0m18:44:20.776389 [info ] [MainThread]: 
[0m18:44:20.777196 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:44:20.778497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef33f9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef3179090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef3468fd0>]}
[0m18:44:20.779172 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:45:03.719120 | f0c6b4a7-828f-4a94-ab1a-5f66e596d30f ==============================
[0m18:45:03.719120 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:45:03.721406 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:45:03.721781 [debug] [MainThread]: Tracking: tracking
[0m18:45:03.742560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b822810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b8222d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b822310>]}
[0m18:45:03.758486 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:45:03.792154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:03.792860 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheat.sql
[0m18:45:03.810858 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheat.sql
[0m18:45:03.836286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:45:03.844398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0c6b4a7-828f-4a94-ab1a-5f66e596d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b84df10>]}
[0m18:45:03.853435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0c6b4a7-828f-4a94-ab1a-5f66e596d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b83afd0>]}
[0m18:45:03.854036 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:45:03.854845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c6b4a7-828f-4a94-ab1a-5f66e596d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b83afd0>]}
[0m18:45:03.857338 [info ] [MainThread]: 
[0m18:45:03.859515 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:03.861289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:45:03.883725 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:45:03.884293 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:45:03.884703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:03.917788 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:45:03.920157 [debug] [ThreadPool]: On list_postgres: Close
[0m18:45:03.922279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:45:03.931066 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:45:03.931498 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:45:03.931830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:03.941638 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:45:03.942081 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:45:03.942401 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:45:03.946706 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:45:03.948266 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:45:03.948837 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:45:03.956050 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:03.956502 [debug] [MainThread]: On master: BEGIN
[0m18:45:03.956847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:03.965934 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:03.966346 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:03.966644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:03.973733 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:45:03.975742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0c6b4a7-828f-4a94-ab1a-5f66e596d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b88b090>]}
[0m18:45:03.976580 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:03.977616 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:03.978189 [debug] [MainThread]: On master: BEGIN
[0m18:45:03.979031 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:03.979523 [debug] [MainThread]: On master: COMMIT
[0m18:45:03.980018 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:03.980309 [debug] [MainThread]: On master: COMMIT
[0m18:45:03.980841 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:45:03.981152 [debug] [MainThread]: On master: Close
[0m18:45:03.981861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:03.982392 [info ] [MainThread]: 
[0m18:45:03.985228 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:45:03.985942 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:45:03.986979 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:45:03.987398 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:45:03.990233 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:45:03.991127 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:45:03.987667 => 2023-04-07 18:45:03.991019
[0m18:45:03.991721 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:45:04.045007 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:45:04.045881 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:04.046189 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:45:04.046457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:04.055374 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:04.055827 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:04.056182 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT FROM { ref('5yearmodel') }
WHERE commodity = 'Wheat'
  );
[0m18:45:04.057237 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 4:     SELECT FROM { ref('5yearmodel') }
                        ^

[0m18:45:04.057641 [debug] [Thread-1  ]: On model.my_project.5YWheat: ROLLBACK
[0m18:45:04.058437 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:45:03.992337 => 2023-04-07 18:45:04.058363
[0m18:45:04.058794 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:45:04.061130 [debug] [Thread-1  ]: Database Error in model 5YWheat (models/5YWheat.sql)
  syntax error at or near "{"
  LINE 4:     SELECT FROM { ref('5yearmodel') }
                          ^
  compiled Code at target/run/my_project/models/5YWheat.sql
[0m18:45:04.061637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c6b4a7-828f-4a94-ab1a-5f66e596d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b8d7210>]}
[0m18:45:04.062160 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model dbt.5YWheat ............................... [[31mERROR[0m in 0.08s]
[0m18:45:04.063839 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:45:04.064443 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:45:04.065138 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:45:04.066375 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:45:04.066760 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:45:04.068883 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:45:04.069669 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:45:04.067019 => 2023-04-07 18:45:04.069596
[0m18:45:04.070115 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:45:04.076195 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:45:04.077078 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:04.077456 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:45:04.077754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:04.087597 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:04.087998 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:04.088330 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:45:04.091455 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:04.100763 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:04.101215 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:45:04.102094 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:04.105986 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:04.106441 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:45:04.108613 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:04.134903 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:45:04.135342 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:04.135686 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:45:04.136754 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:04.143599 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:04.143982 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:45:04.146748 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:04.148371 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:45:04.070477 => 2023-04-07 18:45:04.148311
[0m18:45:04.148795 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:45:04.149594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c6b4a7-828f-4a94-ab1a-5f66e596d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7bc33e50>]}
[0m18:45:04.150184 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.08s]
[0m18:45:04.150834 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:45:04.151388 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:45:04.152135 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:45:04.153207 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:45:04.153799 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:45:04.157191 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:45:04.158171 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:45:04.154115 => 2023-04-07 18:45:04.158066
[0m18:45:04.158717 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:45:04.166262 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:45:04.167259 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:04.167687 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:45:04.168111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:04.177294 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:04.178043 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:04.178527 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:45:04.182189 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:04.186278 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:04.186663 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:45:04.187588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:04.191432 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:04.191994 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:45:04.193255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:04.197067 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:45:04.197458 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:04.197762 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:45:04.198753 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:04.201693 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:04.202196 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:45:04.203965 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:04.205986 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:45:04.159006 => 2023-04-07 18:45:04.205828
[0m18:45:04.206463 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:45:04.207441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c6b4a7-828f-4a94-ab1a-5f66e596d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7bc0f0d0>]}
[0m18:45:04.208112 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:45:04.208916 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:45:04.209578 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:45:04.210385 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:45:04.211509 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:45:04.212077 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:45:04.215697 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:45:04.216914 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:45:04.212584 => 2023-04-07 18:45:04.216799
[0m18:45:04.217653 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:45:04.224149 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:45:04.225269 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:04.225680 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:45:04.226181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:04.235538 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:04.235990 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:04.236321 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:45:04.239232 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:04.243409 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:04.243896 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:45:04.244921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:04.247504 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:45:04.247891 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:04.248203 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:45:04.249417 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:04.252278 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:04.252626 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:45:04.253255 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:04.254556 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:45:04.218342 => 2023-04-07 18:45:04.254501
[0m18:45:04.254878 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:45:04.255758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0c6b4a7-828f-4a94-ab1a-5f66e596d30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7be479d0>]}
[0m18:45:04.256522 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m18:45:04.257233 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:45:04.293179 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:04.293827 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:04.294516 [debug] [MainThread]: On master: BEGIN
[0m18:45:04.295068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:04.303981 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:04.304501 [debug] [MainThread]: On master: COMMIT
[0m18:45:04.304869 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:04.305155 [debug] [MainThread]: On master: COMMIT
[0m18:45:04.305756 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:45:04.306171 [debug] [MainThread]: On master: Close
[0m18:45:04.307005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:04.307368 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:45:04.307708 [info ] [MainThread]: 
[0m18:45:04.308498 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m18:45:04.309443 [debug] [MainThread]: Command end result
[0m18:45:04.318652 [info ] [MainThread]: 
[0m18:45:04.319436 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:45:04.320051 [info ] [MainThread]: 
[0m18:45:04.320633 [error] [MainThread]: [33mDatabase Error in model 5YWheat (models/5YWheat.sql)[0m
[0m18:45:04.321152 [error] [MainThread]:   syntax error at or near "{"
[0m18:45:04.321689 [error] [MainThread]:   LINE 4:     SELECT FROM { ref('5yearmodel') }
[0m18:45:04.322162 [error] [MainThread]:                           ^
[0m18:45:04.322617 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheat.sql
[0m18:45:04.323151 [info ] [MainThread]: 
[0m18:45:04.323712 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:45:04.324417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b9b09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b905a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7b8ff2d0>]}
[0m18:45:04.324943 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:45:14.640009 | 7b5d0034-5544-42b3-a5b9-77379286b6a4 ==============================
[0m18:45:14.640009 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:45:14.642651 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:45:14.643104 [debug] [MainThread]: Tracking: tracking
[0m18:45:14.782998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb66c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb66c510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb66c890>]}
[0m18:45:14.817315 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:45:14.886281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:14.887077 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheat.sql
[0m18:45:14.910747 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheat.sql
[0m18:45:14.936712 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:45:14.944501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b5d0034-5544-42b3-a5b9-77379286b6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb82fed0>]}
[0m18:45:14.954844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b5d0034-5544-42b3-a5b9-77379286b6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb6c7850>]}
[0m18:45:14.955614 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:45:14.956481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b5d0034-5544-42b3-a5b9-77379286b6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fb6c7210>]}
[0m18:45:14.959641 [info ] [MainThread]: 
[0m18:45:14.961876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:14.963835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:45:14.982236 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:45:14.982681 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:45:14.983124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:15.027544 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:45:15.029573 [debug] [ThreadPool]: On list_postgres: Close
[0m18:45:15.031619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:45:15.039252 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:45:15.039716 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:45:15.040067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:15.049026 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:45:15.049461 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:45:15.049888 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:45:15.064234 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:45:15.065816 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:45:15.066545 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:45:15.074987 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:15.075525 [debug] [MainThread]: On master: BEGIN
[0m18:45:15.075898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:15.084724 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:15.085302 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:15.086108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:15.094146 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:45:15.096154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b5d0034-5544-42b3-a5b9-77379286b6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f8e43e90>]}
[0m18:45:15.096775 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:15.097623 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:15.098075 [debug] [MainThread]: On master: BEGIN
[0m18:45:15.098923 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:15.099337 [debug] [MainThread]: On master: COMMIT
[0m18:45:15.099680 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:15.099984 [debug] [MainThread]: On master: COMMIT
[0m18:45:15.100423 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:45:15.100757 [debug] [MainThread]: On master: Close
[0m18:45:15.101429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:15.101972 [info ] [MainThread]: 
[0m18:45:15.104985 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:45:15.105681 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:45:15.106924 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:45:15.107483 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:45:15.110183 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:45:15.111120 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:45:15.107881 => 2023-04-07 18:45:15.110931
[0m18:45:15.111664 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:45:15.171841 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:45:15.172938 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:15.173306 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:45:15.173681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:15.183628 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:15.184156 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:15.184549 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT price FROM { ref('5yearmodel') }
WHERE commodity = 'Wheat'
  );
[0m18:45:15.185676 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 4:     SELECT price FROM { ref('5yearmodel') }
                              ^

[0m18:45:15.186167 [debug] [Thread-1  ]: On model.my_project.5YWheat: ROLLBACK
[0m18:45:15.187118 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:45:15.112022 => 2023-04-07 18:45:15.187034
[0m18:45:15.187491 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:45:15.199716 [debug] [Thread-1  ]: Database Error in model 5YWheat (models/5YWheat.sql)
  syntax error at or near "{"
  LINE 4:     SELECT price FROM { ref('5yearmodel') }
                                ^
  compiled Code at target/run/my_project/models/5YWheat.sql
[0m18:45:15.200404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b5d0034-5544-42b3-a5b9-77379286b6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fbb0c490>]}
[0m18:45:15.201003 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model dbt.5YWheat ............................... [[31mERROR[0m in 0.09s]
[0m18:45:15.202728 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:45:15.203286 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:45:15.203799 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:45:15.204877 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:45:15.205332 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:45:15.207543 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:45:15.208388 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:45:15.205656 => 2023-04-07 18:45:15.208278
[0m18:45:15.208886 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:45:15.217779 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:45:15.218877 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:15.219340 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:45:15.219970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:15.229633 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:15.230048 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:15.230355 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:45:15.233696 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:15.243470 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:15.244017 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:45:15.245016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:15.248455 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:15.248883 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:45:15.249675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:15.275875 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:45:15.276390 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:15.276795 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:45:15.279332 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:15.287629 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:15.288074 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:45:15.290082 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:15.292034 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:45:15.209236 => 2023-04-07 18:45:15.291964
[0m18:45:15.292534 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:45:15.293415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b5d0034-5544-42b3-a5b9-77379286b6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fbd49310>]}
[0m18:45:15.294008 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m18:45:15.294862 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:45:15.295476 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:45:15.296011 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:45:15.297266 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:45:15.298139 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:45:15.300553 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:45:15.301392 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:45:15.298764 => 2023-04-07 18:45:15.301294
[0m18:45:15.301830 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:45:15.309074 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:45:15.309976 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:15.310418 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:45:15.310846 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:15.321717 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:15.322302 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:15.322785 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:45:15.326078 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:15.330035 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:15.330426 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:45:15.331359 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:15.335172 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:15.335647 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:45:15.349789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:15.353322 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:45:15.353795 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:15.354146 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:45:15.355852 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:15.359512 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:15.359953 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:45:15.361829 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:15.363430 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:45:15.302135 => 2023-04-07 18:45:15.363367
[0m18:45:15.363817 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:45:15.364629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b5d0034-5544-42b3-a5b9-77379286b6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fbd56c50>]}
[0m18:45:15.365208 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:45:15.365852 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:45:15.366489 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:45:15.367006 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:45:15.367979 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:45:15.368573 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:45:15.372459 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:45:15.373385 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:45:15.368900 => 2023-04-07 18:45:15.373265
[0m18:45:15.374104 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:45:15.382141 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:45:15.383342 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:15.384168 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:45:15.384602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:15.401324 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:15.401894 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:15.402309 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:45:15.407452 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:15.412473 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:15.412935 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:45:15.414043 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:15.417432 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:45:15.417982 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:15.418371 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:45:15.421507 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:15.425550 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:15.426036 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:45:15.426872 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:15.429034 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:45:15.374649 => 2023-04-07 18:45:15.428963
[0m18:45:15.429557 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:45:15.430530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b5d0034-5544-42b3-a5b9-77379286b6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fbd56910>]}
[0m18:45:15.431200 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:45:15.431940 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:45:15.524133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:15.525295 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:15.526166 [debug] [MainThread]: On master: BEGIN
[0m18:45:15.527166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:15.560200 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:15.560668 [debug] [MainThread]: On master: COMMIT
[0m18:45:15.561136 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:15.561569 [debug] [MainThread]: On master: COMMIT
[0m18:45:15.562351 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:45:15.562902 [debug] [MainThread]: On master: Close
[0m18:45:15.563889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:15.564519 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:45:15.565620 [info ] [MainThread]: 
[0m18:45:15.566643 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m18:45:15.567804 [debug] [MainThread]: Command end result
[0m18:45:15.577886 [info ] [MainThread]: 
[0m18:45:15.579065 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:45:15.579992 [info ] [MainThread]: 
[0m18:45:15.581359 [error] [MainThread]: [33mDatabase Error in model 5YWheat (models/5YWheat.sql)[0m
[0m18:45:15.582185 [error] [MainThread]:   syntax error at or near "{"
[0m18:45:15.582833 [error] [MainThread]:   LINE 4:     SELECT price FROM { ref('5yearmodel') }
[0m18:45:15.583563 [error] [MainThread]:                                 ^
[0m18:45:15.584216 [error] [MainThread]:   compiled Code at target/run/my_project/models/5YWheat.sql
[0m18:45:15.584877 [info ] [MainThread]: 
[0m18:45:15.585465 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:45:15.586268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fbd1fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fbdcfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85fbdcff10>]}
[0m18:45:15.587752 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:45:37.853106 | f501e046-4984-4530-9d9c-187dedd1da55 ==============================
[0m18:45:37.853106 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:45:37.856151 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:45:37.856590 [debug] [MainThread]: Tracking: tracking
[0m18:45:37.879344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d0cc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8a6c0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8ac152d0>]}
[0m18:45:37.895732 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:45:37.960179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:37.960850 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheat.sql
[0m18:45:37.980104 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheat.sql
[0m18:45:38.003341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:45:38.011239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f501e046-4984-4530-9d9c-187dedd1da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d1150d0>]}
[0m18:45:38.021579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f501e046-4984-4530-9d9c-187dedd1da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d0aa390>]}
[0m18:45:38.022282 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:45:38.023107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f501e046-4984-4530-9d9c-187dedd1da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d0aa090>]}
[0m18:45:38.026272 [info ] [MainThread]: 
[0m18:45:38.028822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:38.030780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:45:38.051940 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:45:38.052520 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:45:38.053066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:38.118577 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:45:38.120586 [debug] [ThreadPool]: On list_postgres: Close
[0m18:45:38.122808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:45:38.130791 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:45:38.131218 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:45:38.131517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:38.140252 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:45:38.140669 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:45:38.140975 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:45:38.144418 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m18:45:38.146040 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:45:38.146720 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:45:38.153630 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.154039 [debug] [MainThread]: On master: BEGIN
[0m18:45:38.154338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:38.162999 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:38.163439 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.163819 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:38.173536 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m18:45:38.176199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f501e046-4984-4530-9d9c-187dedd1da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d155890>]}
[0m18:45:38.176855 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:38.177992 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.178482 [debug] [MainThread]: On master: BEGIN
[0m18:45:38.179420 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:38.179867 [debug] [MainThread]: On master: COMMIT
[0m18:45:38.180244 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.180607 [debug] [MainThread]: On master: COMMIT
[0m18:45:38.181300 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:45:38.181747 [debug] [MainThread]: On master: Close
[0m18:45:38.182631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:38.183320 [info ] [MainThread]: 
[0m18:45:38.186299 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:45:38.186921 [info ] [Thread-1  ]: 1 of 4 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:45:38.188100 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:45:38.188593 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:45:38.191552 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:45:38.192750 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:45:38.188917 => 2023-04-07 18:45:38.192556
[0m18:45:38.193676 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:45:38.245963 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:45:38.246905 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:38.247232 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:45:38.247513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:38.256674 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:38.257129 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:38.257460 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:45:38.263687 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:38.272133 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:38.272659 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:45:38.273564 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:38.276998 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:38.277370 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:45:38.278068 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:38.300215 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:45:38.300747 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:38.301033 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:45:38.302382 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:38.308927 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:45:38.309324 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:45:38.311337 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:38.312836 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:45:38.194193 => 2023-04-07 18:45:38.312779
[0m18:45:38.313192 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:45:38.314051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f501e046-4984-4530-9d9c-187dedd1da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d443250>]}
[0m18:45:38.314705 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:45:38.316629 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:45:38.317212 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:45:38.318142 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt.model1 ......................................... [RUN]
[0m18:45:38.319228 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:45:38.319685 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:45:38.321881 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:45:38.322741 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:45:38.320003 => 2023-04-07 18:45:38.322649
[0m18:45:38.323237 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:45:38.330740 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:45:38.331830 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:38.332343 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:45:38.332761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:38.342785 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:38.343259 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:38.343624 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:45:38.347175 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:38.351751 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:38.352290 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:45:38.354335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:38.358587 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:38.359140 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:45:38.359871 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:38.362928 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:45:38.363360 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:38.363692 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:45:38.364713 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:38.367969 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:45:38.368437 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:45:38.371110 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:38.373386 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:45:38.323628 => 2023-04-07 18:45:38.373321
[0m18:45:38.373808 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:45:38.374641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f501e046-4984-4530-9d9c-187dedd1da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d4ac650>]}
[0m18:45:38.375516 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:45:38.376631 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:45:38.377237 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:45:38.377773 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:45:38.378876 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:45:38.379310 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:45:38.383072 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:45:38.383985 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:45:38.379596 => 2023-04-07 18:45:38.383823
[0m18:45:38.384468 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:45:38.391381 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:45:38.392495 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:38.393014 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:45:38.393407 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:38.403779 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:38.404308 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:38.404805 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Wheat'
  );
[0m18:45:38.408353 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:38.411999 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:38.412341 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:45:38.413334 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:38.416346 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:45:38.416752 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:38.417084 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:45:38.418457 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:38.422451 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:45:38.422837 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:45:38.423398 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:38.424772 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:45:38.384704 => 2023-04-07 18:45:38.424716
[0m18:45:38.425249 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:45:38.426092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f501e046-4984-4530-9d9c-187dedd1da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d4a01d0>]}
[0m18:45:38.426641 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:45:38.427287 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:45:38.427990 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:45:38.428555 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:45:38.429647 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:45:38.430044 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:45:38.433428 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:45:38.434291 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:45:38.430306 => 2023-04-07 18:45:38.434204
[0m18:45:38.434782 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:45:38.442524 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:45:38.443611 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:38.443975 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:45:38.444252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:38.453531 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:45:38.454069 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:38.454608 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:45:38.458839 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:45:38.462628 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:38.463050 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:45:38.463945 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:45:38.466351 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:45:38.466705 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:38.467006 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:45:38.468171 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:45:38.473189 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:45:38.473594 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:45:38.474147 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:45:38.475522 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:45:38.435161 => 2023-04-07 18:45:38.475451
[0m18:45:38.475982 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:45:38.476771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f501e046-4984-4530-9d9c-187dedd1da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d5080d0>]}
[0m18:45:38.477295 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:45:38.477964 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:45:38.500309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:38.500896 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.501330 [debug] [MainThread]: On master: BEGIN
[0m18:45:38.501664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:38.512865 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:45:38.513324 [debug] [MainThread]: On master: COMMIT
[0m18:45:38.513668 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.513992 [debug] [MainThread]: On master: COMMIT
[0m18:45:38.514604 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:45:38.515052 [debug] [MainThread]: On master: Close
[0m18:45:38.516004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:38.516502 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:45:38.516923 [info ] [MainThread]: 
[0m18:45:38.517525 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m18:45:38.518420 [debug] [MainThread]: Command end result
[0m18:45:38.526738 [info ] [MainThread]: 
[0m18:45:38.527473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:38.528131 [info ] [MainThread]: 
[0m18:45:38.528755 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:45:38.529427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d155c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d5033d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8d50ac90>]}
[0m18:45:38.529884 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:46:18.442578 | b9a19781-2a9f-4e61-b58f-7ac607e99488 ==============================
[0m18:46:18.442578 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:46:18.445597 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:46:18.445974 [debug] [MainThread]: Tracking: tracking
[0m18:46:18.469577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf11c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf11c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf11c910>]}
[0m18:46:18.485116 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:46:18.554024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:46:18.554737 [debug] [MainThread]: Partial parsing: added file: my_project://models/5YCorn.sql
[0m18:46:18.575283 [debug] [MainThread]: 1699: static parser successfully parsed 5YCorn.sql
[0m18:46:18.597819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:46:18.605306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf135790>]}
[0m18:46:18.616346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf0fd750>]}
[0m18:46:18.617226 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:46:18.617867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf0fdfd0>]}
[0m18:46:18.620005 [info ] [MainThread]: 
[0m18:46:18.622253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:46:18.624022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:46:18.642478 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:46:18.642983 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:46:18.643458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:18.708961 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:46:18.710941 [debug] [ThreadPool]: On list_postgres: Close
[0m18:46:18.713006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:46:18.720487 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:46:18.721033 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:46:18.721353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:18.729939 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:46:18.730413 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:46:18.730722 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:46:18.734817 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:46:18.736408 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:46:18.737106 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:46:18.743872 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:18.744319 [debug] [MainThread]: On master: BEGIN
[0m18:46:18.744624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:18.753377 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:46:18.753935 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:18.754371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:46:18.761311 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m18:46:18.763565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf1d7490>]}
[0m18:46:18.764271 [debug] [MainThread]: On master: ROLLBACK
[0m18:46:18.765011 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:18.765439 [debug] [MainThread]: On master: BEGIN
[0m18:46:18.766216 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:46:18.766557 [debug] [MainThread]: On master: COMMIT
[0m18:46:18.766862 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:18.767140 [debug] [MainThread]: On master: COMMIT
[0m18:46:18.767616 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:46:18.767919 [debug] [MainThread]: On master: Close
[0m18:46:18.768605 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:46:18.769139 [info ] [MainThread]: 
[0m18:46:18.772803 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:46:18.773407 [info ] [Thread-1  ]: 1 of 5 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:46:18.774573 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:46:18.775134 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:46:18.778137 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:46:18.779522 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:46:18.775477 => 2023-04-07 18:46:18.779275
[0m18:46:18.780420 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:46:18.831415 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:46:18.832203 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:46:18.832520 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:46:18.832929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:18.841779 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:46:18.842184 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:46:18.842622 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:46:18.847380 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:46:18.855076 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:46:18.855631 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:46:18.856545 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:46:18.859924 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:46:18.860435 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:46:18.861213 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:46:18.884912 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:46:18.885319 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:46:18.885600 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:46:18.886663 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:46:18.893425 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:46:18.893942 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:46:18.897966 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:46:18.899640 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:46:18.780934 => 2023-04-07 18:46:18.899579
[0m18:46:18.900040 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:46:18.900903 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf456cd0>]}
[0m18:46:18.901521 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:46:18.903396 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:46:18.904037 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:46:18.904899 [info ] [Thread-1  ]: 2 of 5 START sql view model dbt.model1 ......................................... [RUN]
[0m18:46:18.906034 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:46:18.906514 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:46:18.908667 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:46:18.909529 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:46:18.906832 => 2023-04-07 18:46:18.909416
[0m18:46:18.909981 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:46:18.918779 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:46:18.919606 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:46:18.919964 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:46:18.920254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:18.937108 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:46:18.937538 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:46:18.937899 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:46:18.944025 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:46:18.951081 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:46:18.951565 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:46:18.952708 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:46:18.956742 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:46:18.957139 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:46:18.958004 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:46:18.961489 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:46:18.962160 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:46:18.962714 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:46:18.964147 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:46:18.967643 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:46:18.968071 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:46:18.969662 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:46:18.971586 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:46:18.910413 => 2023-04-07 18:46:18.971516
[0m18:46:18.971976 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:46:18.972989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf439910>]}
[0m18:46:18.973659 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:46:18.974390 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:46:18.975018 [debug] [Thread-1  ]: Began running node model.my_project.5YCorn
[0m18:46:18.975715 [info ] [Thread-1  ]: 3 of 5 START sql view model dbt.5YCorn ......................................... [RUN]
[0m18:46:18.976829 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCorn'
[0m18:46:18.977408 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCorn
[0m18:46:18.981146 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCorn"
[0m18:46:18.982111 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (compile): 2023-04-07 18:46:18.977774 => 2023-04-07 18:46:18.981911
[0m18:46:18.982666 [debug] [Thread-1  ]: Began executing node model.my_project.5YCorn
[0m18:46:18.989082 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCorn"
[0m18:46:18.990225 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:46:18.990610 [debug] [Thread-1  ]: On model.my_project.5YCorn: BEGIN
[0m18:46:18.990905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:19.000745 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:46:19.001318 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:46:19.001604 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */

  create view "postgres"."dbt"."5YCorn__dbt_tmp" as (
    SELECT price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:46:19.004505 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:46:19.008596 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:46:19.009007 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
alter table "postgres"."dbt"."5YCorn__dbt_tmp" rename to "5YCorn"
[0m18:46:19.010338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:46:19.014651 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:46:19.015111 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:46:19.015513 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:46:19.016610 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:46:19.020042 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:46:19.020457 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
drop view if exists "postgres"."dbt"."5YCorn__dbt_backup" cascade
[0m18:46:19.021045 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:46:19.022570 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (execute): 2023-04-07 18:46:18.983032 => 2023-04-07 18:46:19.022450
[0m18:46:19.022992 [debug] [Thread-1  ]: On model.my_project.5YCorn: Close
[0m18:46:19.023886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf4567d0>]}
[0m18:46:19.024477 [info ] [Thread-1  ]: 3 of 5 OK created sql view model dbt.5YCorn .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:46:19.025119 [debug] [Thread-1  ]: Finished running node model.my_project.5YCorn
[0m18:46:19.025626 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:46:19.026155 [info ] [Thread-1  ]: 4 of 5 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:46:19.027200 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:46:19.027938 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:46:19.032335 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:46:19.033208 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:46:19.028401 => 2023-04-07 18:46:19.033092
[0m18:46:19.033734 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:46:19.040119 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:46:19.041152 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:46:19.041503 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:46:19.041792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:19.054125 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:46:19.054547 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:46:19.054882 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Wheat'
  );
[0m18:46:19.058090 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:46:19.062745 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:46:19.063163 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:46:19.063902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:46:19.067605 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:46:19.068044 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:46:19.068389 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:46:19.069353 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:46:19.071908 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:46:19.072217 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:46:19.072913 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:46:19.074551 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:46:19.034077 => 2023-04-07 18:46:19.074493
[0m18:46:19.075046 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:46:19.075847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf52f490>]}
[0m18:46:19.076536 [info ] [Thread-1  ]: 4 of 5 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:46:19.077686 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:46:19.078468 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:46:19.079300 [info ] [Thread-1  ]: 5 of 5 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:46:19.080581 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:46:19.080975 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:46:19.084625 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:46:19.085475 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:46:19.081229 => 2023-04-07 18:46:19.085394
[0m18:46:19.085926 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:46:19.091763 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:46:19.092551 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:46:19.092978 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:46:19.093348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:19.102582 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:46:19.103123 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:46:19.103564 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:46:19.106236 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:46:19.110615 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:46:19.111110 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:46:19.112279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:46:19.114914 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:46:19.115497 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:46:19.115846 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:46:19.116778 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:46:19.119910 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:46:19.120312 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:46:19.121099 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:46:19.122792 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:46:19.086177 => 2023-04-07 18:46:19.122719
[0m18:46:19.123372 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:46:19.124360 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a19781-2a9f-4e61-b58f-7ac607e99488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf505310>]}
[0m18:46:19.124960 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m18:46:19.125707 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:46:19.198260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:46:19.198828 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:19.199201 [debug] [MainThread]: On master: BEGIN
[0m18:46:19.199496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:19.208499 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:46:19.208988 [debug] [MainThread]: On master: COMMIT
[0m18:46:19.209456 [debug] [MainThread]: Using postgres connection "master"
[0m18:46:19.209906 [debug] [MainThread]: On master: COMMIT
[0m18:46:19.210500 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:46:19.210920 [debug] [MainThread]: On master: Close
[0m18:46:19.211698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:19.212094 [debug] [MainThread]: Connection 'model.my_project.5Ycorrelation' was properly closed.
[0m18:46:19.212621 [info ] [MainThread]: 
[0m18:46:19.213352 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m18:46:19.214436 [debug] [MainThread]: Command end result
[0m18:46:19.222423 [info ] [MainThread]: 
[0m18:46:19.223276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:19.224226 [info ] [MainThread]: 
[0m18:46:19.224897 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:46:19.225738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf50c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf1a07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97bf0fdb90>]}
[0m18:46:19.226246 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:47:53.626879 | 70005939-b27b-4699-a7c0-356a9d307afe ==============================
[0m18:47:53.626879 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:47:53.630662 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:47:53.631145 [debug] [MainThread]: Tracking: tracking
[0m18:47:53.654795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e8798610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e86bafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e8798850>]}
[0m18:47:53.671835 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:47:53.726143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:47:53.726760 [debug] [MainThread]: Partial parsing: added file: my_project://models/CornVsWheat.sql
[0m18:47:53.746809 [debug] [MainThread]: 1699: static parser successfully parsed CornVsWheat.sql
[0m18:47:53.764048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e8982f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e8982f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e8982fd0>]}
[0m18:47:53.764535 [debug] [MainThread]: Flushing usage events
[0m18:47:54.393144 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.CornVsWheat' (models/CornVsWheat.sql) depends on a node named '5Ycorn' which was not found


============================== 2023-04-07 18:48:10.062624 | 12d0934e-6927-49d7-951c-a2da284881a8 ==============================
[0m18:48:10.062624 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:48:10.064851 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:48:10.065251 [debug] [MainThread]: Tracking: tracking
[0m18:48:10.099420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43e7dd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43e7dda10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43e7dd810>]}
[0m18:48:10.114935 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:48:10.177074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:48:10.177696 [debug] [MainThread]: Partial parsing: added file: my_project://models/CornVsWheat.sql
[0m18:48:10.195234 [debug] [MainThread]: 1699: static parser successfully parsed CornVsWheat.sql
[0m18:48:10.213044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43ea81cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43e901a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc43e9013d0>]}
[0m18:48:10.213560 [debug] [MainThread]: Flushing usage events
[0m18:48:10.591987 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.CornVsWheat' (models/CornVsWheat.sql) depends on a node named '5Ycorn' which was not found


============================== 2023-04-07 18:48:15.377616 | 0ffed1f9-6c6c-4ac0-9531-b11520cbec82 ==============================
[0m18:48:15.377616 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:48:15.380165 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:48:15.380580 [debug] [MainThread]: Tracking: tracking
[0m18:48:15.413560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd30fcd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd30fcd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd30fcda90>]}
[0m18:48:15.430595 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:48:15.479095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:48:15.488202 [debug] [MainThread]: Partial parsing: added file: my_project://models/CornVsWheat.sql
[0m18:48:15.507282 [debug] [MainThread]: 1699: static parser successfully parsed CornVsWheat.sql
[0m18:48:15.525015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3117edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3117ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd3117ef10>]}
[0m18:48:15.525494 [debug] [MainThread]: Flushing usage events
[0m18:48:15.892515 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.CornVsWheat' (models/CornVsWheat.sql) depends on a node named '5Ycorn' which was not found


============================== 2023-04-07 18:48:37.374296 | 7d49b666-2f1e-4a77-ab99-264c3ea05ede ==============================
[0m18:48:37.374296 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:48:37.377037 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:48:37.377458 [debug] [MainThread]: Tracking: tracking
[0m18:48:37.396763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d260db310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d25027210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d260db950>]}
[0m18:48:37.414363 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:48:37.484143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:48:37.484818 [debug] [MainThread]: Partial parsing: added file: my_project://models/CornVsWheat.sql
[0m18:48:37.505777 [debug] [MainThread]: 1699: static parser successfully parsed CornVsWheat.sql
[0m18:48:37.527360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d263b8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d263b8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d263b8cd0>]}
[0m18:48:37.528065 [debug] [MainThread]: Flushing usage events
[0m18:48:37.706370 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.CornVsWheat' (models/CornVsWheat.sql) depends on a node named '5Ywheat' which was not found


============================== 2023-04-07 18:48:45.795137 | c9d841a1-b12c-46fb-8b31-ead31f735061 ==============================
[0m18:48:45.795137 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:48:45.797422 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m18:48:45.797818 [debug] [MainThread]: Tracking: tracking
[0m18:48:45.816910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aa8db250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aa8db9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aa8db850>]}
[0m18:48:45.831893 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:48:45.865880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:48:45.866650 [debug] [MainThread]: Partial parsing: added file: my_project://models/CornVsWheat.sql
[0m18:48:45.882587 [debug] [MainThread]: 1699: static parser successfully parsed CornVsWheat.sql
[0m18:48:45.905142 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:48:45.912946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9d841a1-b12c-46fb-8b31-ead31f735061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aaae22d0>]}
[0m18:48:45.922231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9d841a1-b12c-46fb-8b31-ead31f735061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aa8bd0d0>]}
[0m18:48:45.922959 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:48:45.923586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9d841a1-b12c-46fb-8b31-ead31f735061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aa8bd790>]}
[0m18:48:45.925931 [info ] [MainThread]: 
[0m18:48:45.928107 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:45.929918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:48:45.948238 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:48:45.948757 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:48:45.949270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:45.994307 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:48:45.994797 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:48:45.995151 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:48:45.998873 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:48:46.000866 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:48:46.001604 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:48:46.009598 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:46.010066 [debug] [MainThread]: On master: BEGIN
[0m18:48:46.010381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:46.018807 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:48:46.019273 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:46.019638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:46.026082 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m18:48:46.028043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9d841a1-b12c-46fb-8b31-ead31f735061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aa8bdb50>]}
[0m18:48:46.028570 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:46.029084 [debug] [MainThread]: On master: Close
[0m18:48:46.029819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:46.030446 [info ] [MainThread]: 
[0m18:48:46.033796 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:48:46.034877 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:48:46.035410 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:48:46.037896 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:48:46.038869 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:48:46.035755 => 2023-04-07 18:48:46.038718
[0m18:48:46.039533 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:48:46.040305 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:48:46.040087 => 2023-04-07 18:48:46.040132
[0m18:48:46.043253 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:48:46.043957 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:48:46.045254 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:48:46.045749 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:48:46.048761 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:48:46.050227 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:48:46.046085 => 2023-04-07 18:48:46.049996
[0m18:48:46.051289 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:48:46.052110 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:48:46.051895 => 2023-04-07 18:48:46.051963
[0m18:48:46.053420 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:48:46.054136 [debug] [Thread-1  ]: Began running node model.my_project.5YCorn
[0m18:48:46.055005 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCorn'
[0m18:48:46.055479 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCorn
[0m18:48:46.059052 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCorn"
[0m18:48:46.060027 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (compile): 2023-04-07 18:48:46.055787 => 2023-04-07 18:48:46.059901
[0m18:48:46.060493 [debug] [Thread-1  ]: Began executing node model.my_project.5YCorn
[0m18:48:46.060863 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (execute): 2023-04-07 18:48:46.060804 => 2023-04-07 18:48:46.060814
[0m18:48:46.061607 [debug] [Thread-1  ]: Finished running node model.my_project.5YCorn
[0m18:48:46.062054 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:48:46.062772 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:48:46.063267 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:48:46.066661 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:48:46.067786 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:48:46.063593 => 2023-04-07 18:48:46.067646
[0m18:48:46.068366 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:48:46.068779 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:48:46.068686 => 2023-04-07 18:48:46.068699
[0m18:48:46.069791 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:48:46.070390 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:48:46.071130 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:48:46.071535 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:48:46.074974 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:48:46.075896 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:48:46.071801 => 2023-04-07 18:48:46.075811
[0m18:48:46.076318 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:48:46.076657 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:48:46.076600 => 2023-04-07 18:48:46.076609
[0m18:48:46.077411 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:48:46.077831 [debug] [Thread-1  ]: Began running node model.my_project.CornVsWheat
[0m18:48:46.078444 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CornVsWheat'
[0m18:48:46.078803 [debug] [Thread-1  ]: Began compiling node model.my_project.CornVsWheat
[0m18:48:46.082275 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CornVsWheat"
[0m18:48:46.083918 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (compile): 2023-04-07 18:48:46.079066 => 2023-04-07 18:48:46.083828
[0m18:48:46.084360 [debug] [Thread-1  ]: Began executing node model.my_project.CornVsWheat
[0m18:48:46.084669 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (execute): 2023-04-07 18:48:46.084612 => 2023-04-07 18:48:46.084621
[0m18:48:46.085486 [debug] [Thread-1  ]: Finished running node model.my_project.CornVsWheat
[0m18:48:46.138669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:46.140073 [debug] [MainThread]: Connection 'model.my_project.CornVsWheat' was properly closed.
[0m18:48:46.142280 [debug] [MainThread]: Command end result
[0m18:48:46.156691 [info ] [MainThread]: Done.
[0m18:48:46.158066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aac55990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aac556d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9aaacfa10>]}
[0m18:48:46.158864 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:48:53.535110 | 3dd52687-a41e-462a-b001-58a7529682e0 ==============================
[0m18:48:53.535110 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:48:53.537390 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:48:53.537782 [debug] [MainThread]: Tracking: tracking
[0m18:48:53.559101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01efd2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01efd26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01efd2ad0>]}
[0m18:48:53.574390 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:48:53.605639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:53.606068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:53.607165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:48:53.615199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f2a0590>]}
[0m18:48:53.623439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01efbba50>]}
[0m18:48:53.623988 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:48:53.624507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01efbbe50>]}
[0m18:48:53.626392 [info ] [MainThread]: 
[0m18:48:53.628527 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:53.630570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:48:53.648378 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:48:53.648876 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:48:53.649224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:53.662505 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:48:53.664906 [debug] [ThreadPool]: On list_postgres: Close
[0m18:48:53.667253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:48:53.676047 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:48:53.676661 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:48:53.677112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:53.686506 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:48:53.686909 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:48:53.687226 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:48:53.690829 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:48:53.692288 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:48:53.692860 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:48:53.700668 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:53.701181 [debug] [MainThread]: On master: BEGIN
[0m18:48:53.701483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:53.710671 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:48:53.711100 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:53.711401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:53.716520 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m18:48:53.718427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f09f510>]}
[0m18:48:53.718917 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:53.719502 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:53.719804 [debug] [MainThread]: On master: BEGIN
[0m18:48:53.720433 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:48:53.720769 [debug] [MainThread]: On master: COMMIT
[0m18:48:53.721086 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:53.721365 [debug] [MainThread]: On master: COMMIT
[0m18:48:53.721865 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:48:53.722196 [debug] [MainThread]: On master: Close
[0m18:48:53.722965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:53.723475 [info ] [MainThread]: 
[0m18:48:53.725880 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:48:53.726420 [info ] [Thread-1  ]: 1 of 6 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:48:53.727414 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:48:53.727925 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:48:53.730091 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:48:53.730996 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:48:53.728468 => 2023-04-07 18:48:53.730876
[0m18:48:53.731396 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:48:53.784570 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:48:53.785516 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:48:53.785882 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:48:53.786145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:53.794505 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:48:53.794884 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:48:53.795199 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:48:53.809617 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:48:53.817396 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:48:53.817812 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:48:53.819675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:48:53.823299 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:48:53.823668 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:48:53.824405 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:48:53.847943 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:48:53.848359 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:48:53.848644 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:48:53.849803 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:48:53.855788 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:48:53.856148 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:48:53.858385 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:48:53.859937 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:48:53.731676 => 2023-04-07 18:48:53.859883
[0m18:48:53.860300 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:48:53.861230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f41d110>]}
[0m18:48:53.861919 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:48:53.863643 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:48:53.864194 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:48:53.864998 [info ] [Thread-1  ]: 2 of 6 START sql view model dbt.model1 ......................................... [RUN]
[0m18:48:53.866353 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:48:53.866811 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:48:53.868974 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:48:53.870078 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:48:53.867086 => 2023-04-07 18:48:53.869876
[0m18:48:53.870535 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:48:53.875822 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:48:53.876655 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:48:53.877079 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:48:53.877422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:53.888373 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:48:53.888776 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:48:53.889066 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:48:53.892442 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:48:53.896362 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:48:53.896889 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:48:53.898312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:48:53.902187 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:48:53.902721 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:48:53.903566 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:48:53.906140 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:48:53.906440 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:48:53.906700 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:48:53.908578 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:48:53.912034 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:48:53.912513 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:48:53.914989 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:48:53.916696 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:48:53.870798 => 2023-04-07 18:48:53.916636
[0m18:48:53.917054 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:48:53.917788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f41df10>]}
[0m18:48:53.918444 [info ] [Thread-1  ]: 2 of 6 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:48:53.919147 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:48:53.919681 [debug] [Thread-1  ]: Began running node model.my_project.5YCorn
[0m18:48:53.920101 [info ] [Thread-1  ]: 3 of 6 START sql view model dbt.5YCorn ......................................... [RUN]
[0m18:48:53.921073 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCorn'
[0m18:48:53.921539 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCorn
[0m18:48:53.924835 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCorn"
[0m18:48:53.925723 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (compile): 2023-04-07 18:48:53.921791 => 2023-04-07 18:48:53.925646
[0m18:48:53.926403 [debug] [Thread-1  ]: Began executing node model.my_project.5YCorn
[0m18:48:53.932729 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCorn"
[0m18:48:53.933968 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:48:53.934507 [debug] [Thread-1  ]: On model.my_project.5YCorn: BEGIN
[0m18:48:53.935060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:53.943684 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:48:53.944152 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:48:53.944613 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */

  create view "postgres"."dbt"."5YCorn__dbt_tmp" as (
    SELECT price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:48:53.948287 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:48:53.952136 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:48:53.952499 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
alter table "postgres"."dbt"."5YCorn__dbt_tmp" rename to "5YCorn"
[0m18:48:53.953266 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:48:53.955234 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:48:53.955587 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:48:53.955865 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:48:53.956902 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:48:53.961228 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:48:53.961767 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
drop view if exists "postgres"."dbt"."5YCorn__dbt_backup" cascade
[0m18:48:53.962696 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:48:53.964880 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (execute): 2023-04-07 18:48:53.926790 => 2023-04-07 18:48:53.964785
[0m18:48:53.965459 [debug] [Thread-1  ]: On model.my_project.5YCorn: Close
[0m18:48:53.966376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f4dd110>]}
[0m18:48:53.966975 [info ] [Thread-1  ]: 3 of 6 OK created sql view model dbt.5YCorn .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:48:53.967662 [debug] [Thread-1  ]: Finished running node model.my_project.5YCorn
[0m18:48:53.968297 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:48:53.969264 [info ] [Thread-1  ]: 4 of 6 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:48:53.970370 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:48:53.970747 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:48:53.973959 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:48:53.974841 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:48:53.970984 => 2023-04-07 18:48:53.974722
[0m18:48:53.975310 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:48:53.981973 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:48:53.983005 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:48:53.983542 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:48:53.984129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:53.992870 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:48:53.993565 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:48:53.993973 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Wheat'
  );
[0m18:48:53.998829 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:48:54.002731 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:48:54.003156 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:48:54.004027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:48:54.006313 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:48:54.006660 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:48:54.006929 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:48:54.008019 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:48:54.011198 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:48:54.011710 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:48:54.012581 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:48:54.014623 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:48:53.975652 => 2023-04-07 18:48:54.014555
[0m18:48:54.015221 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:48:54.016087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f4dd210>]}
[0m18:48:54.016672 [info ] [Thread-1  ]: 4 of 6 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:48:54.017291 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:48:54.017936 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:48:54.018414 [info ] [Thread-1  ]: 5 of 6 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:48:54.019927 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:48:54.020401 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:48:54.023627 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:48:54.024366 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:48:54.020725 => 2023-04-07 18:48:54.024293
[0m18:48:54.024905 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:48:54.030953 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:48:54.031782 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:48:54.032281 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:48:54.032892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:54.042590 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:48:54.043213 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:48:54.043604 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:48:54.047792 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:48:54.051665 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:48:54.052091 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:48:54.052942 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:48:54.055186 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:48:54.055489 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:48:54.055748 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:48:54.056739 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:48:54.059652 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:48:54.060025 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:48:54.060784 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:48:54.062582 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:48:54.025228 => 2023-04-07 18:48:54.062498
[0m18:48:54.063322 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:48:54.064487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f4dda10>]}
[0m18:48:54.065350 [info ] [Thread-1  ]: 5 of 6 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:48:54.066063 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:48:54.066565 [debug] [Thread-1  ]: Began running node model.my_project.CornVsWheat
[0m18:48:54.066981 [info ] [Thread-1  ]: 6 of 6 START sql view model dbt.CornVsWheat .................................... [RUN]
[0m18:48:54.068130 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CornVsWheat'
[0m18:48:54.068554 [debug] [Thread-1  ]: Began compiling node model.my_project.CornVsWheat
[0m18:48:54.073132 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CornVsWheat"
[0m18:48:54.074127 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (compile): 2023-04-07 18:48:54.068894 => 2023-04-07 18:48:54.074039
[0m18:48:54.074530 [debug] [Thread-1  ]: Began executing node model.my_project.CornVsWheat
[0m18:48:54.080756 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CornVsWheat"
[0m18:48:54.081638 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:48:54.082084 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: BEGIN
[0m18:48:54.082421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:54.092284 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:48:54.092729 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:48:54.093237 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */

  create view "postgres"."dbt"."CornVsWheat__dbt_tmp" as (
    SELECT 
    DATE_PART('year', c.month) AS year,
    DATE_PART('month', c.month) AS month,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, date FROM "postgres"."dbt"."5YCorn") AS c 
JOIN 

    (SELECT price, date FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    DATE_PART('year', c.month), 
    DATE_PART('month', c.month)
ORDER BY 
    year, month
  );
[0m18:48:54.095016 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 9:     (SELECT price, date FROM "postgres"."dbt"."5YCorn") AS c...
                           ^

[0m18:48:54.095474 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: ROLLBACK
[0m18:48:54.096588 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (execute): 2023-04-07 18:48:54.074769 => 2023-04-07 18:48:54.096455
[0m18:48:54.097395 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: Close
[0m18:48:54.109901 [debug] [Thread-1  ]: Database Error in model CornVsWheat (models/CornVsWheat.sql)
  column "date" does not exist
  LINE 9:     (SELECT price, date FROM "postgres"."dbt"."5YCorn") AS c...
                             ^
  compiled Code at target/run/my_project/models/CornVsWheat.sql
[0m18:48:54.110626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd52687-a41e-462a-b001-58a7529682e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f466d90>]}
[0m18:48:54.111367 [error] [Thread-1  ]: 6 of 6 ERROR creating sql view model dbt.CornVsWheat ........................... [[31mERROR[0m in 0.04s]
[0m18:48:54.112277 [debug] [Thread-1  ]: Finished running node model.my_project.CornVsWheat
[0m18:48:54.139823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:54.140440 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:54.140824 [debug] [MainThread]: On master: BEGIN
[0m18:48:54.141156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:54.150813 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:48:54.151402 [debug] [MainThread]: On master: COMMIT
[0m18:48:54.151768 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:54.152094 [debug] [MainThread]: On master: COMMIT
[0m18:48:54.152786 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:48:54.153266 [debug] [MainThread]: On master: Close
[0m18:48:54.154035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:54.154374 [debug] [MainThread]: Connection 'model.my_project.CornVsWheat' was properly closed.
[0m18:48:54.154759 [info ] [MainThread]: 
[0m18:48:54.155372 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m18:48:54.156427 [debug] [MainThread]: Command end result
[0m18:48:54.164127 [info ] [MainThread]: 
[0m18:48:54.165187 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:48:54.166324 [info ] [MainThread]: 
[0m18:48:54.167223 [error] [MainThread]: [33mDatabase Error in model CornVsWheat (models/CornVsWheat.sql)[0m
[0m18:48:54.168295 [error] [MainThread]:   column "date" does not exist
[0m18:48:54.168969 [error] [MainThread]:   LINE 9:     (SELECT price, date FROM "postgres"."dbt"."5YCorn") AS c...
[0m18:48:54.169586 [error] [MainThread]:                              ^
[0m18:48:54.170224 [error] [MainThread]:   compiled Code at target/run/my_project/models/CornVsWheat.sql
[0m18:48:54.171055 [info ] [MainThread]: 
[0m18:48:54.171793 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:48:54.172599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f42b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f515ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff01f48a2d0>]}
[0m18:48:54.173124 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:49:07.085711 | f6ca9253-1fff-468f-a5b2-3aa255d76005 ==============================
[0m18:49:07.085711 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:49:07.088053 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:49:07.088482 [debug] [MainThread]: Tracking: tracking
[0m18:49:07.111630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc787c7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc787c7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc787c7690>]}
[0m18:49:07.127969 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:49:07.160605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:49:07.161293 [debug] [MainThread]: Partial parsing: updated file: my_project://models/CornVsWheat.sql
[0m18:49:07.161742 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YCorn.sql
[0m18:49:07.178912 [debug] [MainThread]: 1699: static parser successfully parsed CornVsWheat.sql
[0m18:49:07.196223 [debug] [MainThread]: 1699: static parser successfully parsed 5YCorn.sql
[0m18:49:07.205805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:49:07.213215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc789196d0>]}
[0m18:49:07.227263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7878fad0>]}
[0m18:49:07.228006 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:49:07.228590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7878f510>]}
[0m18:49:07.233195 [info ] [MainThread]: 
[0m18:49:07.235819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:49:07.238230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:49:07.257050 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:49:07.257669 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:49:07.258292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:07.275754 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:49:07.277686 [debug] [ThreadPool]: On list_postgres: Close
[0m18:49:07.279666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:49:07.288015 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:49:07.288850 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:49:07.289301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:07.298476 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:49:07.298907 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:49:07.299249 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:49:07.303791 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:49:07.305623 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:49:07.306625 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:49:07.313734 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:07.314166 [debug] [MainThread]: On master: BEGIN
[0m18:49:07.314551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:07.324313 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:49:07.324780 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:07.325101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:49:07.331083 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m18:49:07.333128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc789a7790>]}
[0m18:49:07.333643 [debug] [MainThread]: On master: ROLLBACK
[0m18:49:07.334263 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:07.334621 [debug] [MainThread]: On master: BEGIN
[0m18:49:07.335295 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:49:07.335674 [debug] [MainThread]: On master: COMMIT
[0m18:49:07.335973 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:07.336279 [debug] [MainThread]: On master: COMMIT
[0m18:49:07.336772 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:49:07.337100 [debug] [MainThread]: On master: Close
[0m18:49:07.337799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:49:07.338508 [info ] [MainThread]: 
[0m18:49:07.340665 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:49:07.341277 [info ] [Thread-1  ]: 1 of 6 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:49:07.342287 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:49:07.342731 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:49:07.345236 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:49:07.346153 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:49:07.343001 => 2023-04-07 18:49:07.346009
[0m18:49:07.346596 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:49:07.400142 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:49:07.400997 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:07.401384 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:49:07.401665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:07.410087 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:07.410469 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:07.410749 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:49:07.413785 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:07.421935 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:07.422320 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:49:07.423426 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:07.426850 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:07.427179 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:49:07.427906 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:07.450677 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:49:07.451096 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:07.451418 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:49:07.455141 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:07.461664 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:07.462058 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:49:07.465208 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:07.466777 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:49:07.346857 => 2023-04-07 18:49:07.466693
[0m18:49:07.467209 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:49:07.468019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78c6d210>]}
[0m18:49:07.468582 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:49:07.470228 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:49:07.470847 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:49:07.471297 [info ] [Thread-1  ]: 2 of 6 START sql view model dbt.model1 ......................................... [RUN]
[0m18:49:07.472532 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:49:07.472976 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:49:07.474988 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:49:07.476034 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:49:07.473264 => 2023-04-07 18:49:07.475912
[0m18:49:07.476567 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:49:07.484135 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:49:07.484959 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:07.485315 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:49:07.485606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:07.496036 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:07.496522 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:07.496895 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:49:07.499727 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:07.504880 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:07.505372 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:49:07.506488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:07.510050 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:07.510467 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:49:07.511184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:07.513660 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:49:07.514019 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:07.514314 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:49:07.515400 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:07.518491 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:07.518995 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:49:07.521208 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:07.523338 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:49:07.477201 => 2023-04-07 18:49:07.523240
[0m18:49:07.523940 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:49:07.524800 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78cb3850>]}
[0m18:49:07.525414 [info ] [Thread-1  ]: 2 of 6 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:49:07.526087 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:49:07.526845 [debug] [Thread-1  ]: Began running node model.my_project.5YCorn
[0m18:49:07.527285 [info ] [Thread-1  ]: 3 of 6 START sql view model dbt.5YCorn ......................................... [RUN]
[0m18:49:07.528368 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCorn'
[0m18:49:07.528760 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCorn
[0m18:49:07.531917 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCorn"
[0m18:49:07.532717 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (compile): 2023-04-07 18:49:07.529007 => 2023-04-07 18:49:07.532640
[0m18:49:07.533217 [debug] [Thread-1  ]: Began executing node model.my_project.5YCorn
[0m18:49:07.540174 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCorn"
[0m18:49:07.541080 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:07.541687 [debug] [Thread-1  ]: On model.my_project.5YCorn: BEGIN
[0m18:49:07.542262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:07.552393 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:07.552853 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:07.553192 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */

  create view "postgres"."dbt"."5YCorn__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:49:07.556786 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:07.560598 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:07.561043 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
alter table "postgres"."dbt"."5YCorn__dbt_tmp" rename to "5YCorn"
[0m18:49:07.562028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:07.564384 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:49:07.564815 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:07.565122 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:49:07.566257 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:07.569530 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:07.570082 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
drop view if exists "postgres"."dbt"."5YCorn__dbt_backup" cascade
[0m18:49:07.571267 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:07.573303 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (execute): 2023-04-07 18:49:07.533599 => 2023-04-07 18:49:07.573236
[0m18:49:07.573704 [debug] [Thread-1  ]: On model.my_project.5YCorn: Close
[0m18:49:07.574473 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78abad90>]}
[0m18:49:07.575007 [info ] [Thread-1  ]: 3 of 6 OK created sql view model dbt.5YCorn .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:49:07.575735 [debug] [Thread-1  ]: Finished running node model.my_project.5YCorn
[0m18:49:07.576417 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:49:07.576848 [info ] [Thread-1  ]: 4 of 6 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:49:07.577787 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:49:07.578365 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:49:07.581521 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:49:07.582322 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:49:07.578680 => 2023-04-07 18:49:07.582246
[0m18:49:07.582703 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:49:07.589480 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:49:07.590294 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:07.590712 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:49:07.591159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:07.600761 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:07.601216 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:07.601493 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Wheat'
  );
[0m18:49:07.604145 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:07.608924 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:07.609402 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:49:07.610103 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:07.612365 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:49:07.612763 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:07.613034 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:49:07.614023 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:07.618360 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:07.618768 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:49:07.619539 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:07.621753 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:49:07.582940 => 2023-04-07 18:49:07.621681
[0m18:49:07.622246 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:49:07.623308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78d0abd0>]}
[0m18:49:07.623996 [info ] [Thread-1  ]: 4 of 6 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:49:07.624806 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:49:07.625612 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:49:07.626616 [info ] [Thread-1  ]: 5 of 6 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:49:07.627652 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:49:07.628012 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:49:07.631051 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:49:07.631849 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:49:07.628257 => 2023-04-07 18:49:07.631772
[0m18:49:07.632354 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:49:07.638904 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:49:07.639757 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:07.640226 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:49:07.640699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:07.650774 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:07.651234 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:07.651569 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:49:07.655766 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:07.659706 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:07.660138 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:49:07.660975 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:07.663256 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:49:07.663572 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:07.663886 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:49:07.665149 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:07.668032 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:07.668424 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:49:07.669176 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:07.671459 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:49:07.632669 => 2023-04-07 18:49:07.671367
[0m18:49:07.672004 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:49:07.673119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc787c7ed0>]}
[0m18:49:07.673812 [info ] [Thread-1  ]: 5 of 6 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:49:07.674494 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:49:07.674994 [debug] [Thread-1  ]: Began running node model.my_project.CornVsWheat
[0m18:49:07.675416 [info ] [Thread-1  ]: 6 of 6 START sql view model dbt.CornVsWheat .................................... [RUN]
[0m18:49:07.676606 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CornVsWheat'
[0m18:49:07.676968 [debug] [Thread-1  ]: Began compiling node model.my_project.CornVsWheat
[0m18:49:07.680540 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CornVsWheat"
[0m18:49:07.681404 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (compile): 2023-04-07 18:49:07.677246 => 2023-04-07 18:49:07.681326
[0m18:49:07.681756 [debug] [Thread-1  ]: Began executing node model.my_project.CornVsWheat
[0m18:49:07.688358 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CornVsWheat"
[0m18:49:07.689238 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:49:07.689642 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: BEGIN
[0m18:49:07.690117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:07.699063 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:07.699455 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:49:07.699753 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */

  create view "postgres"."dbt"."CornVsWheat__dbt_tmp" as (
    SELECT 
    DATE_PART('year', c.month) AS year,
    DATE_PART('month', c.month) AS month,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, month FROM "postgres"."dbt"."5YCorn") AS c 
JOIN 

    (SELECT price, month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    DATE_PART('year', c.month), 
    DATE_PART('month', c.month)
ORDER BY 
    year, month
  );
[0m18:49:07.701175 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "month" does not exist
LINE 12:     (SELECT price, month FROM "postgres"."dbt"."5YWheat") AS...
                            ^
HINT:  There is a column named "month" in table "c", but it cannot be referenced from this part of the query.

[0m18:49:07.701644 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: ROLLBACK
[0m18:49:07.702351 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (execute): 2023-04-07 18:49:07.682037 => 2023-04-07 18:49:07.702266
[0m18:49:07.702722 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: Close
[0m18:49:07.706200 [debug] [Thread-1  ]: Database Error in model CornVsWheat (models/CornVsWheat.sql)
  column "month" does not exist
  LINE 12:     (SELECT price, month FROM "postgres"."dbt"."5YWheat") AS...
                              ^
  HINT:  There is a column named "month" in table "c", but it cannot be referenced from this part of the query.
  compiled Code at target/run/my_project/models/CornVsWheat.sql
[0m18:49:07.707102 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ca9253-1fff-468f-a5b2-3aa255d76005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78d04c50>]}
[0m18:49:07.707758 [error] [Thread-1  ]: 6 of 6 ERROR creating sql view model dbt.CornVsWheat ........................... [[31mERROR[0m in 0.03s]
[0m18:49:07.708397 [debug] [Thread-1  ]: Finished running node model.my_project.CornVsWheat
[0m18:49:07.755792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:49:07.756370 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:07.756985 [debug] [MainThread]: On master: BEGIN
[0m18:49:07.757373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:49:07.766340 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:49:07.766783 [debug] [MainThread]: On master: COMMIT
[0m18:49:07.767136 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:07.767453 [debug] [MainThread]: On master: COMMIT
[0m18:49:07.768026 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:49:07.768554 [debug] [MainThread]: On master: Close
[0m18:49:07.769420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:07.769836 [debug] [MainThread]: Connection 'model.my_project.CornVsWheat' was properly closed.
[0m18:49:07.770242 [info ] [MainThread]: 
[0m18:49:07.771066 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m18:49:07.772286 [debug] [MainThread]: Command end result
[0m18:49:07.781498 [info ] [MainThread]: 
[0m18:49:07.783280 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:49:07.784146 [info ] [MainThread]: 
[0m18:49:07.784880 [error] [MainThread]: [33mDatabase Error in model CornVsWheat (models/CornVsWheat.sql)[0m
[0m18:49:07.785569 [error] [MainThread]:   column "month" does not exist
[0m18:49:07.786293 [error] [MainThread]:   LINE 12:     (SELECT price, month FROM "postgres"."dbt"."5YWheat") AS...
[0m18:49:07.787129 [error] [MainThread]:                               ^
[0m18:49:07.788242 [error] [MainThread]:   HINT:  There is a column named "month" in table "c", but it cannot be referenced from this part of the query.
[0m18:49:07.789004 [error] [MainThread]:   compiled Code at target/run/my_project/models/CornVsWheat.sql
[0m18:49:07.790222 [info ] [MainThread]: 
[0m18:49:07.791016 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:49:07.791896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78d04c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7895ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc78c89710>]}
[0m18:49:07.792586 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:49:30.257782 | 0d8b749a-e7c5-44de-b49d-2797304d9560 ==============================
[0m18:49:30.257782 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:49:30.260595 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:49:30.260965 [debug] [MainThread]: Tracking: tracking
[0m18:49:30.284459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0daf86790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0daf86990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0daf86510>]}
[0m18:49:30.301104 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:49:30.372057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:49:30.372879 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YWheat.sql
[0m18:49:30.393893 [debug] [MainThread]: 1699: static parser successfully parsed 5YWheat.sql
[0m18:49:30.418786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:49:30.426142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db00a150>]}
[0m18:49:30.435254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0dafeb150>]}
[0m18:49:30.435917 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:49:30.436627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0dafeb150>]}
[0m18:49:30.439028 [info ] [MainThread]: 
[0m18:49:30.441740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:49:30.443682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:49:30.458483 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:49:30.458990 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:49:30.459413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:30.514714 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:49:30.516575 [debug] [ThreadPool]: On list_postgres: Close
[0m18:49:30.518831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:49:30.526017 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:49:30.526406 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:49:30.526774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:30.536479 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:49:30.537005 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:49:30.537473 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:49:30.543209 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:49:30.544739 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:49:30.545421 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:49:30.552698 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:30.553119 [debug] [MainThread]: On master: BEGIN
[0m18:49:30.553431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:30.561800 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:49:30.562213 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:30.562528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:49:30.571884 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m18:49:30.573665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db1c3450>]}
[0m18:49:30.574213 [debug] [MainThread]: On master: ROLLBACK
[0m18:49:30.575021 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:30.575513 [debug] [MainThread]: On master: BEGIN
[0m18:49:30.576240 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:49:30.576597 [debug] [MainThread]: On master: COMMIT
[0m18:49:30.576919 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:30.577218 [debug] [MainThread]: On master: COMMIT
[0m18:49:30.577799 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:49:30.578163 [debug] [MainThread]: On master: Close
[0m18:49:30.578921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:49:30.579476 [info ] [MainThread]: 
[0m18:49:30.582424 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:49:30.583141 [info ] [Thread-1  ]: 1 of 6 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:49:30.584265 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:49:30.584748 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:49:30.586900 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:49:30.588437 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:49:30.585094 => 2023-04-07 18:49:30.588262
[0m18:49:30.589392 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:49:30.641181 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:49:30.642001 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:30.642492 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:49:30.642794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:30.651609 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:30.652264 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:30.652576 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:49:30.657208 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:30.665429 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:30.665856 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:49:30.666770 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:30.670884 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:30.671305 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:49:30.672075 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:30.694411 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:49:30.694882 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:30.695169 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:49:30.696208 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:30.702152 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:49:30.702591 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:49:30.706306 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:30.707850 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:49:30.590388 => 2023-04-07 18:49:30.707794
[0m18:49:30.708233 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:49:30.709151 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db4d9790>]}
[0m18:49:30.709772 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:49:30.711460 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:49:30.712113 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:49:30.713037 [info ] [Thread-1  ]: 2 of 6 START sql view model dbt.model1 ......................................... [RUN]
[0m18:49:30.714072 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:49:30.714440 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:49:30.716576 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:49:30.717928 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:49:30.714767 => 2023-04-07 18:49:30.717770
[0m18:49:30.718381 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:49:30.725719 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:49:30.727058 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:30.727778 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:49:30.728207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:30.736545 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:30.737004 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:30.737363 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:49:30.740894 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:30.744665 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:30.745036 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:49:30.745846 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:30.749082 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:30.749388 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:49:30.751826 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:30.755155 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:49:30.755863 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:30.756363 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:49:30.757490 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:30.760605 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:49:30.760991 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:49:30.762850 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:30.764429 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:49:30.718625 => 2023-04-07 18:49:30.764371
[0m18:49:30.764762 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:49:30.765564 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db3212d0>]}
[0m18:49:30.766170 [info ] [Thread-1  ]: 2 of 6 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:49:30.766830 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:49:30.767504 [debug] [Thread-1  ]: Began running node model.my_project.5YCorn
[0m18:49:30.768095 [info ] [Thread-1  ]: 3 of 6 START sql view model dbt.5YCorn ......................................... [RUN]
[0m18:49:30.769180 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCorn'
[0m18:49:30.769764 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCorn
[0m18:49:30.773226 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCorn"
[0m18:49:30.774124 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (compile): 2023-04-07 18:49:30.770053 => 2023-04-07 18:49:30.774033
[0m18:49:30.774639 [debug] [Thread-1  ]: Began executing node model.my_project.5YCorn
[0m18:49:30.781671 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCorn"
[0m18:49:30.782575 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:30.782972 [debug] [Thread-1  ]: On model.my_project.5YCorn: BEGIN
[0m18:49:30.783233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:30.792399 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:30.793137 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:30.793669 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */

  create view "postgres"."dbt"."5YCorn__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:49:30.797086 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:30.800762 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:30.801191 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
alter table "postgres"."dbt"."5YCorn__dbt_tmp" rename to "5YCorn"
[0m18:49:30.802102 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:30.804645 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:49:30.805147 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:30.805789 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:49:30.807105 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:30.810171 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:49:30.810683 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
drop view if exists "postgres"."dbt"."5YCorn__dbt_backup" cascade
[0m18:49:30.811539 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:30.812899 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (execute): 2023-04-07 18:49:30.775068 => 2023-04-07 18:49:30.812844
[0m18:49:30.813219 [debug] [Thread-1  ]: On model.my_project.5YCorn: Close
[0m18:49:30.814049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db517750>]}
[0m18:49:30.814567 [info ] [Thread-1  ]: 3 of 6 OK created sql view model dbt.5YCorn .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:49:30.815190 [debug] [Thread-1  ]: Finished running node model.my_project.5YCorn
[0m18:49:30.815725 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:49:30.816164 [info ] [Thread-1  ]: 4 of 6 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:49:30.817233 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:49:30.817861 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:49:30.821401 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:49:30.822256 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:49:30.818230 => 2023-04-07 18:49:30.822163
[0m18:49:30.822696 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:49:30.829945 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:49:30.830730 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:30.831041 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:49:30.831303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:30.840933 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:30.841343 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:30.841638 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:49:30.844355 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:30.848909 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:30.849288 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:49:30.850111 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:30.852455 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:49:30.852876 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:30.853202 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:49:30.854180 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:30.857966 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:49:30.858359 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:49:30.859000 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:30.860567 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:49:30.822935 => 2023-04-07 18:49:30.860507
[0m18:49:30.860921 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:49:30.861760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db55dd10>]}
[0m18:49:30.862283 [info ] [Thread-1  ]: 4 of 6 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m18:49:30.862860 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:49:30.863483 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:49:30.863974 [info ] [Thread-1  ]: 5 of 6 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:49:30.865012 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:49:30.865740 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:49:30.869089 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:49:30.870076 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:49:30.866029 => 2023-04-07 18:49:30.869934
[0m18:49:30.870577 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:49:30.877613 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:49:30.878641 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:30.879005 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:49:30.879291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:30.888384 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:30.889076 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:30.889630 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:49:30.892938 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:30.897513 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:30.898032 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:49:30.899093 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:30.902628 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:49:30.903234 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:30.903743 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:49:30.905489 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:30.909243 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:49:30.909645 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:49:30.910309 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:30.912240 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:49:30.870841 => 2023-04-07 18:49:30.912179
[0m18:49:30.912752 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:49:30.913612 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db44d410>]}
[0m18:49:30.914248 [info ] [Thread-1  ]: 5 of 6 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:49:30.915013 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:49:30.915581 [debug] [Thread-1  ]: Began running node model.my_project.CornVsWheat
[0m18:49:30.916219 [info ] [Thread-1  ]: 6 of 6 START sql view model dbt.CornVsWheat .................................... [RUN]
[0m18:49:30.917447 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CornVsWheat'
[0m18:49:30.918072 [debug] [Thread-1  ]: Began compiling node model.my_project.CornVsWheat
[0m18:49:30.922056 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CornVsWheat"
[0m18:49:30.922856 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (compile): 2023-04-07 18:49:30.918570 => 2023-04-07 18:49:30.922764
[0m18:49:30.923414 [debug] [Thread-1  ]: Began executing node model.my_project.CornVsWheat
[0m18:49:30.931882 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CornVsWheat"
[0m18:49:30.932870 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:49:30.933299 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: BEGIN
[0m18:49:30.933698 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:49:30.952957 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:49:30.953714 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:49:30.954142 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */

  create view "postgres"."dbt"."CornVsWheat__dbt_tmp" as (
    SELECT 
    DATE_PART('year', c.month) AS year,
    DATE_PART('month', c.month) AS month,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, month FROM "postgres"."dbt"."5YCorn") AS c 
JOIN 

    (SELECT price, month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    DATE_PART('year', c.month), 
    DATE_PART('month', c.month)
ORDER BY 
    year, month
  );
[0m18:49:30.965855 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:49:30.969881 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:49:30.970440 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */
alter table "postgres"."dbt"."CornVsWheat__dbt_tmp" rename to "CornVsWheat"
[0m18:49:30.971816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:49:30.975059 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: COMMIT
[0m18:49:30.975659 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:49:30.976142 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: COMMIT
[0m18:49:30.977599 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:49:30.982654 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:49:30.983106 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */
drop view if exists "postgres"."dbt"."CornVsWheat__dbt_backup" cascade
[0m18:49:30.983824 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:49:30.985361 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (execute): 2023-04-07 18:49:30.923757 => 2023-04-07 18:49:30.985290
[0m18:49:30.985817 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: Close
[0m18:49:30.986993 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8b749a-e7c5-44de-b49d-2797304d9560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db452c10>]}
[0m18:49:30.987762 [info ] [Thread-1  ]: 6 of 6 OK created sql view model dbt.CornVsWheat ............................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:49:30.988487 [debug] [Thread-1  ]: Finished running node model.my_project.CornVsWheat
[0m18:49:31.003920 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:49:31.004460 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:31.004881 [debug] [MainThread]: On master: BEGIN
[0m18:49:31.005292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:49:31.015676 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:49:31.016125 [debug] [MainThread]: On master: COMMIT
[0m18:49:31.016488 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:31.016828 [debug] [MainThread]: On master: COMMIT
[0m18:49:31.017521 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:49:31.017890 [debug] [MainThread]: On master: Close
[0m18:49:31.018595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:31.018940 [debug] [MainThread]: Connection 'model.my_project.CornVsWheat' was properly closed.
[0m18:49:31.019334 [info ] [MainThread]: 
[0m18:49:31.020120 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m18:49:31.021420 [debug] [MainThread]: Command end result
[0m18:49:31.029418 [info ] [MainThread]: 
[0m18:49:31.030179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:31.030827 [info ] [MainThread]: 
[0m18:49:31.031478 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:49:31.032233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db5752d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0da9a1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0db572410>]}
[0m18:49:31.032756 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:51:40.773824 | 06d32c72-c4a5-452b-a351-cb4b101eadbd ==============================
[0m18:51:40.773824 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:51:40.777149 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:51:40.777702 [debug] [MainThread]: Tracking: tracking
[0m18:51:40.803468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815915310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815915550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815915a50>]}
[0m18:51:40.820088 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:51:40.901686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:40.902410 [debug] [MainThread]: Partial parsing: updated file: my_project://models/CornVsWheat.sql
[0m18:51:40.929356 [debug] [MainThread]: 1699: static parser successfully parsed CornVsWheat.sql
[0m18:51:40.970054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:51:40.981714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815b26250>]}
[0m18:51:40.994168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78158e5590>]}
[0m18:51:40.994846 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:51:40.996139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78158e5d10>]}
[0m18:51:40.999933 [info ] [MainThread]: 
[0m18:51:41.006353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:41.021874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:51:41.041369 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:51:41.041788 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:51:41.042198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:41.098012 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:51:41.100154 [debug] [ThreadPool]: On list_postgres: Close
[0m18:51:41.102239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:51:41.110021 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:51:41.110580 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:51:41.110902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:41.120984 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:51:41.121421 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:51:41.121743 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:51:41.126952 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m18:51:41.128747 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:51:41.129421 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:51:41.136745 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:41.137168 [debug] [MainThread]: On master: BEGIN
[0m18:51:41.137486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:41.145789 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:51:41.146205 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:41.146515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:51:41.157477 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m18:51:41.159633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78158fb1d0>]}
[0m18:51:41.160158 [debug] [MainThread]: On master: ROLLBACK
[0m18:51:41.160688 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:41.161020 [debug] [MainThread]: On master: BEGIN
[0m18:51:41.161571 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:51:41.161942 [debug] [MainThread]: On master: COMMIT
[0m18:51:41.162270 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:41.162564 [debug] [MainThread]: On master: COMMIT
[0m18:51:41.163075 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:51:41.163459 [debug] [MainThread]: On master: Close
[0m18:51:41.164348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:41.165280 [info ] [MainThread]: 
[0m18:51:41.168397 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:51:41.169157 [info ] [Thread-1  ]: 1 of 6 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:51:41.171357 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:51:41.171971 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:51:41.174346 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:51:41.179081 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:51:41.172355 => 2023-04-07 18:51:41.177315
[0m18:51:41.179906 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:51:41.255077 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:51:41.255972 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:51:41.256591 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:51:41.257246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:41.271183 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:51:41.271660 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:51:41.272655 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:51:41.280042 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:51:41.294916 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:51:41.295327 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:51:41.296492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:51:41.301376 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:51:41.302783 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:51:41.304744 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:51:41.337669 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:51:41.338465 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:51:41.338975 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:51:41.345175 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:51:41.353351 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:51:41.353783 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:51:41.356993 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:51:41.358738 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:51:41.180392 => 2023-04-07 18:51:41.358659
[0m18:51:41.359194 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:51:41.360310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815b5eb10>]}
[0m18:51:41.361002 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.19s]
[0m18:51:41.364107 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:51:41.383993 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:51:41.385096 [info ] [Thread-1  ]: 2 of 6 START sql view model dbt.model1 ......................................... [RUN]
[0m18:51:41.386832 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:51:41.387254 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:51:41.389253 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:51:41.390328 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:51:41.387549 => 2023-04-07 18:51:41.390236
[0m18:51:41.390846 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:51:41.398095 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:51:41.399444 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:51:41.399916 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:51:41.400377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:41.408191 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:51:41.408605 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:51:41.408935 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:51:41.412458 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:51:41.417103 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:51:41.417460 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:51:41.418148 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:51:41.421524 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:51:41.421908 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:51:41.422549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:51:41.425480 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:51:41.426003 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:51:41.426353 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:51:41.427408 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:51:41.432632 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:51:41.433172 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:51:41.435145 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:51:41.437083 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:51:41.391338 => 2023-04-07 18:51:41.437017
[0m18:51:41.437575 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:51:41.438503 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815e10ed0>]}
[0m18:51:41.439168 [info ] [Thread-1  ]: 2 of 6 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:51:41.440279 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:51:41.440914 [debug] [Thread-1  ]: Began running node model.my_project.5YCorn
[0m18:51:41.441530 [info ] [Thread-1  ]: 3 of 6 START sql view model dbt.5YCorn ......................................... [RUN]
[0m18:51:41.442806 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCorn'
[0m18:51:41.443387 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCorn
[0m18:51:41.446959 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCorn"
[0m18:51:41.448650 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (compile): 2023-04-07 18:51:41.443873 => 2023-04-07 18:51:41.448370
[0m18:51:41.449337 [debug] [Thread-1  ]: Began executing node model.my_project.5YCorn
[0m18:51:41.457751 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCorn"
[0m18:51:41.459408 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:51:41.460009 [debug] [Thread-1  ]: On model.my_project.5YCorn: BEGIN
[0m18:51:41.460593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:41.470789 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:51:41.471218 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:51:41.471511 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */

  create view "postgres"."dbt"."5YCorn__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:51:41.474488 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:51:41.479455 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:51:41.479898 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
alter table "postgres"."dbt"."5YCorn__dbt_tmp" rename to "5YCorn"
[0m18:51:41.480653 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:51:41.482952 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:51:41.483290 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:51:41.483553 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:51:41.484611 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:51:41.487718 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:51:41.488071 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
drop view if exists "postgres"."dbt"."5YCorn__dbt_backup" cascade
[0m18:51:41.488711 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:51:41.490309 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (execute): 2023-04-07 18:51:41.450227 => 2023-04-07 18:51:41.490225
[0m18:51:41.490656 [debug] [Thread-1  ]: On model.my_project.5YCorn: Close
[0m18:51:41.491528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815b75ed0>]}
[0m18:51:41.492157 [info ] [Thread-1  ]: 3 of 6 OK created sql view model dbt.5YCorn .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:51:41.492843 [debug] [Thread-1  ]: Finished running node model.my_project.5YCorn
[0m18:51:41.493440 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:51:41.494021 [info ] [Thread-1  ]: 4 of 6 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:51:41.494987 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:51:41.495403 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:51:41.499470 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:51:41.501731 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:51:41.495651 => 2023-04-07 18:51:41.501612
[0m18:51:41.502156 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:51:41.508343 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:51:41.509703 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:51:41.510172 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:51:41.510643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:41.519991 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:51:41.520487 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:51:41.520804 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:51:41.523817 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:51:41.528681 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:51:41.529141 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:51:41.530233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:51:41.532596 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:51:41.532956 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:51:41.533213 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:51:41.534226 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:51:41.538290 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:51:41.538669 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:51:41.539532 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:51:41.541366 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:51:41.502577 => 2023-04-07 18:51:41.541208
[0m18:51:41.541766 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:51:41.542616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815e95e90>]}
[0m18:51:41.543259 [info ] [Thread-1  ]: 4 of 6 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:51:41.543957 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:51:41.544682 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:51:41.545129 [info ] [Thread-1  ]: 5 of 6 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:51:41.546155 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:51:41.546605 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:51:41.550765 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:51:41.552788 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:51:41.546919 => 2023-04-07 18:51:41.552668
[0m18:51:41.553221 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:51:41.559434 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:51:41.560668 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:51:41.561240 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:51:41.561675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:41.570174 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:51:41.570560 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:51:41.570829 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:51:41.574180 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:51:41.579378 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:51:41.579763 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:51:41.580641 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:51:41.583474 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:51:41.583878 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:51:41.584218 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:51:41.585333 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:51:41.588190 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:51:41.588512 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:51:41.589186 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:51:41.590481 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:51:41.553483 => 2023-04-07 18:51:41.590430
[0m18:51:41.590891 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:51:41.592189 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815b1a350>]}
[0m18:51:41.592814 [info ] [Thread-1  ]: 5 of 6 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:51:41.593448 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:51:41.594039 [debug] [Thread-1  ]: Began running node model.my_project.CornVsWheat
[0m18:51:41.594504 [info ] [Thread-1  ]: 6 of 6 START sql view model dbt.CornVsWheat .................................... [RUN]
[0m18:51:41.595582 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CornVsWheat'
[0m18:51:41.596040 [debug] [Thread-1  ]: Began compiling node model.my_project.CornVsWheat
[0m18:51:41.600792 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CornVsWheat"
[0m18:51:41.602548 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (compile): 2023-04-07 18:51:41.596349 => 2023-04-07 18:51:41.602436
[0m18:51:41.602982 [debug] [Thread-1  ]: Began executing node model.my_project.CornVsWheat
[0m18:51:41.608915 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CornVsWheat"
[0m18:51:41.610335 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:51:41.610862 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: BEGIN
[0m18:51:41.611218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:41.620500 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:51:41.620929 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:51:41.621251 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */

  create view "postgres"."dbt"."CornVsWheat__dbt_tmp" as (
    SELECT 
    CONCAT(DATE_PART('year', c.month), '-', DATE_TRUNC('quarter', c.month)) AS period,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCorn") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    period
ORDER BY 
    period
  );
[0m18:51:41.629235 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:51:41.633079 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:51:41.633451 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */
alter table "postgres"."dbt"."CornVsWheat__dbt_tmp" rename to "CornVsWheat"
[0m18:51:41.634275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:51:41.636712 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: COMMIT
[0m18:51:41.637211 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:51:41.637541 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: COMMIT
[0m18:51:41.638576 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:51:41.641595 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:51:41.642160 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */
drop view if exists "postgres"."dbt"."CornVsWheat__dbt_backup" cascade
[0m18:51:41.642969 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:51:41.644412 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (execute): 2023-04-07 18:51:41.603247 => 2023-04-07 18:51:41.644358
[0m18:51:41.644731 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: Close
[0m18:51:41.645513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d32c72-c4a5-452b-a351-cb4b101eadbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78159e62d0>]}
[0m18:51:41.646065 [info ] [Thread-1  ]: 6 of 6 OK created sql view model dbt.CornVsWheat ............................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:51:41.646716 [debug] [Thread-1  ]: Finished running node model.my_project.CornVsWheat
[0m18:51:41.688691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:41.689196 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:41.689706 [debug] [MainThread]: On master: BEGIN
[0m18:51:41.690314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:41.701859 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:51:41.702391 [debug] [MainThread]: On master: COMMIT
[0m18:51:41.702867 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:41.703281 [debug] [MainThread]: On master: COMMIT
[0m18:51:41.704170 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:51:41.704689 [debug] [MainThread]: On master: Close
[0m18:51:41.705524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:41.705966 [debug] [MainThread]: Connection 'model.my_project.CornVsWheat' was properly closed.
[0m18:51:41.706435 [info ] [MainThread]: 
[0m18:51:41.707153 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m18:51:41.708315 [debug] [MainThread]: Command end result
[0m18:51:41.720552 [info ] [MainThread]: 
[0m18:51:41.721364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:41.722239 [info ] [MainThread]: 
[0m18:51:41.722967 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:51:41.723713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815ea75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815ea7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7815ea7b90>]}
[0m18:51:41.724349 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:52:32.483862 | dca7d58d-498f-49be-a60e-02e1f428e3ae ==============================
[0m18:52:32.483862 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:52:32.486521 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:52:32.486927 [debug] [MainThread]: Tracking: tracking
[0m18:52:32.506935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5911e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5911e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5911e550>]}
[0m18:52:32.521394 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:52:32.589046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:32.589740 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YCorn.sql
[0m18:52:32.608959 [debug] [MainThread]: 1699: static parser successfully parsed 5YCorn.sql
[0m18:52:32.634234 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:52:32.642153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf593261d0>]}
[0m18:52:32.651713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf58fe7410>]}
[0m18:52:32.652475 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:52:32.653145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf58fe7f90>]}
[0m18:52:32.655156 [info ] [MainThread]: 
[0m18:52:32.657498 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:32.659635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:52:32.677973 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:32.678528 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:32.679112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:32.726217 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:52:32.728036 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:32.730305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:52:32.737763 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:52:32.738176 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:52:32.738479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:32.747496 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:52:32.747994 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:52:32.748301 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:52:32.752532 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m18:52:32.754141 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:52:32.754736 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:52:32.761459 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:32.761902 [debug] [MainThread]: On master: BEGIN
[0m18:52:32.762224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:32.770262 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:52:32.770674 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:32.771012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:52:32.777743 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m18:52:32.780125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf58fe7e50>]}
[0m18:52:32.780768 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:32.781517 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:32.781996 [debug] [MainThread]: On master: BEGIN
[0m18:52:32.782806 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:52:32.783242 [debug] [MainThread]: On master: COMMIT
[0m18:52:32.783581 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:32.783934 [debug] [MainThread]: On master: COMMIT
[0m18:52:32.784523 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:52:32.784968 [debug] [MainThread]: On master: Close
[0m18:52:32.785801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:32.786444 [info ] [MainThread]: 
[0m18:52:32.789521 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:52:32.790159 [info ] [Thread-1  ]: 1 of 6 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:52:32.792007 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:52:32.792508 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:52:32.794952 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:52:32.796729 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:52:32.792834 => 2023-04-07 18:52:32.796488
[0m18:52:32.797548 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:52:32.854172 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:52:32.855115 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:52:32.855529 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:52:32.855846 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:32.865883 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:52:32.866339 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:52:32.866710 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:52:32.870750 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:52:32.880047 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:52:32.880455 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:52:32.882099 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:52:32.886146 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:52:32.886574 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:52:32.887330 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:52:32.913388 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:52:32.913803 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:52:32.914093 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:52:32.915352 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:52:32.921512 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:52:32.921937 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:52:32.924666 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:52:32.926443 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:52:32.797901 => 2023-04-07 18:52:32.926365
[0m18:52:32.927138 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:52:32.928186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf591b2e90>]}
[0m18:52:32.928839 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:52:32.930661 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:52:32.931277 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:52:32.931773 [info ] [Thread-1  ]: 2 of 6 START sql view model dbt.model1 ......................................... [RUN]
[0m18:52:32.933153 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:52:32.933582 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:52:32.935618 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:52:32.936346 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:52:32.933841 => 2023-04-07 18:52:32.936278
[0m18:52:32.936788 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:52:32.942519 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:52:32.943368 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:52:32.943856 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:52:32.944187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:32.956266 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:52:32.956722 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:52:32.957041 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:52:32.959765 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:52:32.965756 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:52:32.966258 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:52:32.967216 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:52:32.971174 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:52:32.971607 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:52:32.972413 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:52:32.975132 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:52:32.975478 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:52:32.975768 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:52:32.976873 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:52:32.980422 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:52:32.980877 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:52:32.982757 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:52:32.984546 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:52:32.937150 => 2023-04-07 18:52:32.984475
[0m18:52:32.984998 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:52:32.985879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf594ed810>]}
[0m18:52:32.986528 [info ] [Thread-1  ]: 2 of 6 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:52:32.987336 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:52:32.987946 [debug] [Thread-1  ]: Began running node model.my_project.5YCorn
[0m18:52:32.988545 [info ] [Thread-1  ]: 3 of 6 START sql view model dbt.5YCorn ......................................... [RUN]
[0m18:52:32.989672 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCorn'
[0m18:52:32.990180 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCorn
[0m18:52:32.993753 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCorn"
[0m18:52:32.994822 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (compile): 2023-04-07 18:52:32.990481 => 2023-04-07 18:52:32.994667
[0m18:52:32.995430 [debug] [Thread-1  ]: Began executing node model.my_project.5YCorn
[0m18:52:33.001918 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCorn"
[0m18:52:33.002816 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:52:33.003127 [debug] [Thread-1  ]: On model.my_project.5YCorn: BEGIN
[0m18:52:33.003391 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:33.012404 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:52:33.013041 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:52:33.013754 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */

  create view "postgres"."dbt"."5YCorn__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Brent'
  );
[0m18:52:33.017813 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:52:33.021491 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:52:33.021940 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
alter table "postgres"."dbt"."5YCorn__dbt_tmp" rename to "5YCorn"
[0m18:52:33.022806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:52:33.025178 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:52:33.025524 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:52:33.025842 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:52:33.026884 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:52:33.030174 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:52:33.030775 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
drop view if exists "postgres"."dbt"."5YCorn__dbt_backup" cascade
[0m18:52:33.031497 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:52:33.033164 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (execute): 2023-04-07 18:52:32.995867 => 2023-04-07 18:52:33.033105
[0m18:52:33.033645 [debug] [Thread-1  ]: On model.my_project.5YCorn: Close
[0m18:52:33.034454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf592d6910>]}
[0m18:52:33.035182 [info ] [Thread-1  ]: 3 of 6 OK created sql view model dbt.5YCorn .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:52:33.035908 [debug] [Thread-1  ]: Finished running node model.my_project.5YCorn
[0m18:52:33.036503 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:52:33.037134 [info ] [Thread-1  ]: 4 of 6 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:52:33.038395 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:52:33.038870 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:52:33.042512 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:52:33.043436 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:52:33.039170 => 2023-04-07 18:52:33.043327
[0m18:52:33.043961 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:52:33.051286 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:52:33.052053 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:52:33.052514 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:52:33.052777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:33.062044 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:52:33.062605 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:52:33.063093 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:52:33.065830 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:52:33.069803 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:52:33.070271 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:52:33.071279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:52:33.073668 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:52:33.074119 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:52:33.074432 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:52:33.075723 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:52:33.080522 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:52:33.081236 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:52:33.082110 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:52:33.083608 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:52:33.044342 => 2023-04-07 18:52:33.083552
[0m18:52:33.083998 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:52:33.084763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf59564b10>]}
[0m18:52:33.085406 [info ] [Thread-1  ]: 4 of 6 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:52:33.086022 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:52:33.086599 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:52:33.087534 [info ] [Thread-1  ]: 5 of 6 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:52:33.088586 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:52:33.089102 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:52:33.092300 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:52:33.093206 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:52:33.089393 => 2023-04-07 18:52:33.093094
[0m18:52:33.093687 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:52:33.101485 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:52:33.102433 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:52:33.102823 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:52:33.103168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:33.113253 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:52:33.113923 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:52:33.114312 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:52:33.117001 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:52:33.120716 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:52:33.121114 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:52:33.121935 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:52:33.124111 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:52:33.124525 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:52:33.124809 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:52:33.125881 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:52:33.128687 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:52:33.129150 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:52:33.129924 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:52:33.131686 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:52:33.094142 => 2023-04-07 18:52:33.131618
[0m18:52:33.132092 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:52:33.132979 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf59561290>]}
[0m18:52:33.133616 [info ] [Thread-1  ]: 5 of 6 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m18:52:33.134323 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:52:33.135002 [debug] [Thread-1  ]: Began running node model.my_project.CornVsWheat
[0m18:52:33.135651 [info ] [Thread-1  ]: 6 of 6 START sql view model dbt.CornVsWheat .................................... [RUN]
[0m18:52:33.136935 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CornVsWheat'
[0m18:52:33.137382 [debug] [Thread-1  ]: Began compiling node model.my_project.CornVsWheat
[0m18:52:33.142144 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CornVsWheat"
[0m18:52:33.143017 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (compile): 2023-04-07 18:52:33.137783 => 2023-04-07 18:52:33.142908
[0m18:52:33.143562 [debug] [Thread-1  ]: Began executing node model.my_project.CornVsWheat
[0m18:52:33.151227 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CornVsWheat"
[0m18:52:33.152240 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:52:33.152836 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: BEGIN
[0m18:52:33.153220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:33.162316 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:52:33.162821 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:52:33.163238 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */

  create view "postgres"."dbt"."CornVsWheat__dbt_tmp" as (
    SELECT 
    CONCAT(DATE_PART('year', c.month), '-', DATE_TRUNC('quarter', c.month)) AS period,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCorn") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    period
ORDER BY 
    period
  );
[0m18:52:33.168729 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:52:33.172957 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:52:33.173420 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */
alter table "postgres"."dbt"."CornVsWheat__dbt_tmp" rename to "CornVsWheat"
[0m18:52:33.174421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:52:33.177238 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: COMMIT
[0m18:52:33.177706 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:52:33.178151 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: COMMIT
[0m18:52:33.179388 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:52:33.182640 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:52:33.183105 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */
drop view if exists "postgres"."dbt"."CornVsWheat__dbt_backup" cascade
[0m18:52:33.183845 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:52:33.185673 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (execute): 2023-04-07 18:52:33.144066 => 2023-04-07 18:52:33.185595
[0m18:52:33.186168 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: Close
[0m18:52:33.187143 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca7d58d-498f-49be-a60e-02e1f428e3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf59561250>]}
[0m18:52:33.187812 [info ] [Thread-1  ]: 6 of 6 OK created sql view model dbt.CornVsWheat ............................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:52:33.188712 [debug] [Thread-1  ]: Finished running node model.my_project.CornVsWheat
[0m18:52:33.205738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:33.206257 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:33.206659 [debug] [MainThread]: On master: BEGIN
[0m18:52:33.207028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:33.220531 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:52:33.221060 [debug] [MainThread]: On master: COMMIT
[0m18:52:33.221530 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:33.221901 [debug] [MainThread]: On master: COMMIT
[0m18:52:33.222754 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:52:33.223330 [debug] [MainThread]: On master: Close
[0m18:52:33.224117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:33.224580 [debug] [MainThread]: Connection 'model.my_project.CornVsWheat' was properly closed.
[0m18:52:33.225089 [info ] [MainThread]: 
[0m18:52:33.225880 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m18:52:33.226956 [debug] [MainThread]: Command end result
[0m18:52:33.237849 [info ] [MainThread]: 
[0m18:52:33.238791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:33.239731 [info ] [MainThread]: 
[0m18:52:33.240439 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:52:33.241251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf59569d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf59569e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf59569bd0>]}
[0m18:52:33.241786 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:54:34.547062 | 43c3121c-0ce3-42a8-a627-e4d6751c4dcc ==============================
[0m18:54:34.547062 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:54:34.550536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:54:34.551005 [debug] [MainThread]: Tracking: tracking
[0m18:54:34.570827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d081d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d081d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d081d710>]}
[0m18:54:34.586036 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:54:34.655578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:54:34.656266 [debug] [MainThread]: Partial parsing: updated file: my_project://models/5YCorn.sql
[0m18:54:34.674317 [debug] [MainThread]: 1699: static parser successfully parsed 5YCorn.sql
[0m18:54:34.696647 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:54:34.703824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0a26150>]}
[0m18:54:34.713009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0838490>]}
[0m18:54:34.713631 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:54:34.714349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d07e7590>]}
[0m18:54:34.716810 [info ] [MainThread]: 
[0m18:54:34.719404 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:54:34.721463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:54:34.739905 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:54:34.740372 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:54:34.740749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:34.788496 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:54:34.790316 [debug] [ThreadPool]: On list_postgres: Close
[0m18:54:34.792370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:54:34.800438 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:54:34.800896 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:54:34.801212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:34.812123 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:54:34.812760 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:54:34.813146 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:54:34.816893 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m18:54:34.818925 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:54:34.819741 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:54:34.826965 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:34.827468 [debug] [MainThread]: On master: BEGIN
[0m18:54:34.828056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:34.840671 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:54:34.841214 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:34.841662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:54:34.849396 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m18:54:34.851874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d07e73d0>]}
[0m18:54:34.852465 [debug] [MainThread]: On master: ROLLBACK
[0m18:54:34.853349 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:34.853809 [debug] [MainThread]: On master: BEGIN
[0m18:54:34.854652 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:54:34.855071 [debug] [MainThread]: On master: COMMIT
[0m18:54:34.855448 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:34.855830 [debug] [MainThread]: On master: COMMIT
[0m18:54:34.856486 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:54:34.856951 [debug] [MainThread]: On master: Close
[0m18:54:34.857790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:54:34.858498 [info ] [MainThread]: 
[0m18:54:34.861331 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:54:34.862025 [info ] [Thread-1  ]: 1 of 6 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:54:34.864003 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:54:34.864532 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:54:34.866793 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:54:34.867888 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:54:34.864908 => 2023-04-07 18:54:34.867747
[0m18:54:34.868773 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:54:34.926527 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:54:34.927450 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:54:34.927817 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:54:34.928086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:34.936825 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:54:34.937210 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:54:34.937499 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:54:34.943002 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:54:34.950898 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:54:34.951286 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:54:34.952523 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:54:34.955849 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:54:34.956159 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:54:34.956909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:54:34.978406 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:54:34.978838 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:54:34.979124 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:54:34.980240 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:54:34.986828 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:54:34.987202 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:54:34.989883 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:54:34.991364 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:54:34.869216 => 2023-04-07 18:54:34.991307
[0m18:54:34.991700 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:54:34.992488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0b95b90>]}
[0m18:54:34.993115 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:54:34.994942 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:54:34.995620 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:54:34.996336 [info ] [Thread-1  ]: 2 of 6 START sql view model dbt.model1 ......................................... [RUN]
[0m18:54:34.997497 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:54:34.998259 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:54:35.000420 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:54:35.001461 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:54:34.998632 => 2023-04-07 18:54:35.001317
[0m18:54:35.002041 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:54:35.009164 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:54:35.009913 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:54:35.010365 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:54:35.010717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:35.020621 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:54:35.021258 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:54:35.021906 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:54:35.024645 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:54:35.029591 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:54:35.030181 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:54:35.031151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:54:35.035774 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:54:35.036263 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:54:35.037010 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:54:35.039668 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:54:35.040000 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:54:35.040266 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:54:35.041148 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:54:35.044609 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:54:35.045168 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:54:35.047142 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:54:35.048641 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:54:35.002426 => 2023-04-07 18:54:35.048585
[0m18:54:35.048972 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:54:35.049682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0bf3cd0>]}
[0m18:54:35.050205 [info ] [Thread-1  ]: 2 of 6 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:54:35.050854 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:54:35.051529 [debug] [Thread-1  ]: Began running node model.my_project.5YCorn
[0m18:54:35.051978 [info ] [Thread-1  ]: 3 of 6 START sql view model dbt.5YCorn ......................................... [RUN]
[0m18:54:35.052888 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCorn'
[0m18:54:35.053325 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCorn
[0m18:54:35.056756 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCorn"
[0m18:54:35.058062 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (compile): 2023-04-07 18:54:35.053592 => 2023-04-07 18:54:35.057901
[0m18:54:35.058817 [debug] [Thread-1  ]: Began executing node model.my_project.5YCorn
[0m18:54:35.065723 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCorn"
[0m18:54:35.066972 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:54:35.067387 [debug] [Thread-1  ]: On model.my_project.5YCorn: BEGIN
[0m18:54:35.067761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:35.078620 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:54:35.079003 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:54:35.079302 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */

  create view "postgres"."dbt"."5YCorn__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Cotton'
  );
[0m18:54:35.083474 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:54:35.087756 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:54:35.088313 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
alter table "postgres"."dbt"."5YCorn__dbt_tmp" rename to "5YCorn"
[0m18:54:35.089236 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:54:35.091495 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:54:35.091910 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:54:35.092187 [debug] [Thread-1  ]: On model.my_project.5YCorn: COMMIT
[0m18:54:35.093320 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:54:35.096550 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCorn"
[0m18:54:35.097005 [debug] [Thread-1  ]: On model.my_project.5YCorn: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCorn"} */
drop view if exists "postgres"."dbt"."5YCorn__dbt_backup" cascade
[0m18:54:35.097774 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:54:35.099408 [debug] [Thread-1  ]: Timing info for model.my_project.5YCorn (execute): 2023-04-07 18:54:35.059410 => 2023-04-07 18:54:35.099317
[0m18:54:35.099882 [debug] [Thread-1  ]: On model.my_project.5YCorn: Close
[0m18:54:35.100714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d09d43d0>]}
[0m18:54:35.101300 [info ] [Thread-1  ]: 3 of 6 OK created sql view model dbt.5YCorn .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:54:35.101984 [debug] [Thread-1  ]: Finished running node model.my_project.5YCorn
[0m18:54:35.102502 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:54:35.102959 [info ] [Thread-1  ]: 4 of 6 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:54:35.103807 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:54:35.104202 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:54:35.108240 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:54:35.109281 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:54:35.104474 => 2023-04-07 18:54:35.109171
[0m18:54:35.109759 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:54:35.116260 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:54:35.117298 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:54:35.117656 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:54:35.117990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:35.126571 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:54:35.126954 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:54:35.127232 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:54:35.130572 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:54:35.134175 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:54:35.134584 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:54:35.135473 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:54:35.137799 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:54:35.138183 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:54:35.138492 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:54:35.139410 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:54:35.143716 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:54:35.144088 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:54:35.144769 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:54:35.146591 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:54:35.110041 => 2023-04-07 18:54:35.146500
[0m18:54:35.147031 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:54:35.147906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0c68a50>]}
[0m18:54:35.148457 [info ] [Thread-1  ]: 4 of 6 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m18:54:35.149081 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:54:35.149679 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:54:35.150637 [info ] [Thread-1  ]: 5 of 6 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:54:35.151619 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:54:35.152078 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:54:35.155622 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:54:35.156402 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:54:35.152352 => 2023-04-07 18:54:35.156302
[0m18:54:35.156909 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:54:35.162886 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:54:35.163623 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:54:35.164094 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:54:35.164487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:35.175580 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:54:35.176080 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:54:35.176490 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:54:35.181701 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:54:35.185902 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:54:35.186338 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:54:35.187300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:54:35.189881 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:54:35.190290 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:54:35.190797 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:54:35.191904 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:54:35.194831 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:54:35.195284 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:54:35.196109 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:54:35.197870 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:54:35.157251 => 2023-04-07 18:54:35.197808
[0m18:54:35.198294 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:54:35.199140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0c4a4d0>]}
[0m18:54:35.199741 [info ] [Thread-1  ]: 5 of 6 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:54:35.200420 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:54:35.200972 [debug] [Thread-1  ]: Began running node model.my_project.CornVsWheat
[0m18:54:35.201551 [info ] [Thread-1  ]: 6 of 6 START sql view model dbt.CornVsWheat .................................... [RUN]
[0m18:54:35.202717 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CornVsWheat'
[0m18:54:35.203143 [debug] [Thread-1  ]: Began compiling node model.my_project.CornVsWheat
[0m18:54:35.207844 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CornVsWheat"
[0m18:54:35.208617 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (compile): 2023-04-07 18:54:35.203423 => 2023-04-07 18:54:35.208525
[0m18:54:35.209041 [debug] [Thread-1  ]: Began executing node model.my_project.CornVsWheat
[0m18:54:35.215434 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CornVsWheat"
[0m18:54:35.216940 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:54:35.217431 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: BEGIN
[0m18:54:35.217858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:35.228692 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:54:35.229191 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:54:35.229619 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */

  create view "postgres"."dbt"."CornVsWheat__dbt_tmp" as (
    SELECT 
    CONCAT(DATE_PART('year', c.month), '-', DATE_TRUNC('quarter', c.month)) AS period,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCorn") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    period
ORDER BY 
    period
  );
[0m18:54:35.235731 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:54:35.239974 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:54:35.240397 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */
alter table "postgres"."dbt"."CornVsWheat__dbt_tmp" rename to "CornVsWheat"
[0m18:54:35.241274 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:54:35.243885 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: COMMIT
[0m18:54:35.244323 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:54:35.244696 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: COMMIT
[0m18:54:35.245790 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:54:35.249198 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CornVsWheat"
[0m18:54:35.249684 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CornVsWheat"} */
drop view if exists "postgres"."dbt"."CornVsWheat__dbt_backup" cascade
[0m18:54:35.250290 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:54:35.252011 [debug] [Thread-1  ]: Timing info for model.my_project.CornVsWheat (execute): 2023-04-07 18:54:35.209377 => 2023-04-07 18:54:35.251946
[0m18:54:35.252410 [debug] [Thread-1  ]: On model.my_project.CornVsWheat: Close
[0m18:54:35.253339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43c3121c-0ce3-42a8-a627-e4d6751c4dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0b6fb50>]}
[0m18:54:35.254097 [info ] [Thread-1  ]: 6 of 6 OK created sql view model dbt.CornVsWheat ............................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:54:35.254924 [debug] [Thread-1  ]: Finished running node model.my_project.CornVsWheat
[0m18:54:35.281406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:54:35.281922 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:35.282378 [debug] [MainThread]: On master: BEGIN
[0m18:54:35.282821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:35.294069 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:54:35.294539 [debug] [MainThread]: On master: COMMIT
[0m18:54:35.294911 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:35.295273 [debug] [MainThread]: On master: COMMIT
[0m18:54:35.295854 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:54:35.296313 [debug] [MainThread]: On master: Close
[0m18:54:35.297103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:35.297545 [debug] [MainThread]: Connection 'model.my_project.CornVsWheat' was properly closed.
[0m18:54:35.297977 [info ] [MainThread]: 
[0m18:54:35.298621 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m18:54:35.299777 [debug] [MainThread]: Command end result
[0m18:54:35.308697 [info ] [MainThread]: 
[0m18:54:35.309396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:35.309974 [info ] [MainThread]: 
[0m18:54:35.310518 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:54:35.311188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d090a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0c79510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d0c79f90>]}
[0m18:54:35.311678 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:55:54.090098 | 6ac814c0-ec51-4a7a-84a9-4e8080748d27 ==============================
[0m18:55:54.090098 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:55:54.095021 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:55:54.095500 [debug] [MainThread]: Tracking: tracking
[0m18:55:54.120829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6500dd650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6500dd410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6500dd850>]}
[0m18:55:54.141696 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:55:54.213816 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m18:55:54.214493 [debug] [MainThread]: Partial parsing: added file: my_project://models/5YCotton.sql
[0m18:55:54.214893 [debug] [MainThread]: Partial parsing: added file: my_project://models/CottonvsWheat.sql
[0m18:55:54.215219 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/5YCorn.sql
[0m18:55:54.215526 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/CornVsWheat.sql
[0m18:55:54.235303 [debug] [MainThread]: 1699: static parser successfully parsed 5YCotton.sql
[0m18:55:54.256367 [debug] [MainThread]: 1699: static parser successfully parsed CottonvsWheat.sql
[0m18:55:54.268446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:55:54.275996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6502e5690>]}
[0m18:55:54.284399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6500a8250>]}
[0m18:55:54.285062 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:55:54.286364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6500a84d0>]}
[0m18:55:54.289474 [info ] [MainThread]: 
[0m18:55:54.292340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:54.294566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:55:54.314381 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:55:54.315022 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:55:54.315882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:54.378976 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:55:54.380802 [debug] [ThreadPool]: On list_postgres: Close
[0m18:55:54.383116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:55:54.390586 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:55:54.391005 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:55:54.391321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:54.403715 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:55:54.404226 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:55:54.404631 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:55:54.411761 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m18:55:54.413437 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:55:54.414214 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:55:54.421395 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:54.421861 [debug] [MainThread]: On master: BEGIN
[0m18:55:54.422173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:54.435978 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:55:54.436390 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:54.436692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:54.448171 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m18:55:54.451171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff650152d10>]}
[0m18:55:54.451954 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:54.452708 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:54.453135 [debug] [MainThread]: On master: BEGIN
[0m18:55:54.453984 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:55:54.454454 [debug] [MainThread]: On master: COMMIT
[0m18:55:54.454866 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:54.455213 [debug] [MainThread]: On master: COMMIT
[0m18:55:54.456042 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:55:54.456755 [debug] [MainThread]: On master: Close
[0m18:55:54.457756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:54.458364 [info ] [MainThread]: 
[0m18:55:54.461766 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:55:54.462464 [info ] [Thread-1  ]: 1 of 6 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:55:54.464731 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:55:54.465290 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:55:54.467237 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:55:54.469312 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:55:54.465586 => 2023-04-07 18:55:54.469140
[0m18:55:54.470883 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:55:54.525641 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:55:54.526782 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:55:54.527161 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:55:54.527496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:54.539019 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:55:54.539421 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:55:54.539716 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:55:54.547438 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:55:54.555660 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:55:54.556169 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:55:54.557225 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:55:54.560565 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:55:54.560892 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:55:54.561783 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:55:54.585774 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:55:54.586184 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:55:54.586469 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:55:54.588968 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:55:54.595986 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:55:54.596453 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:55:54.602970 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:55:54.605553 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:55:54.471502 => 2023-04-07 18:55:54.605487
[0m18:55:54.605979 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:55:54.606959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff650456cd0>]}
[0m18:55:54.607564 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:55:54.609634 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:55:54.610337 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:55:54.611252 [info ] [Thread-1  ]: 2 of 6 START sql view model dbt.model1 ......................................... [RUN]
[0m18:55:54.612379 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:55:54.612999 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:55:54.615495 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:55:54.617073 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:55:54.613340 => 2023-04-07 18:55:54.616938
[0m18:55:54.617647 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:55:54.624574 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:55:54.625446 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:55:54.625788 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:55:54.626082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:54.638992 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:55:54.639393 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:55:54.639674 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:55:54.644067 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:55:54.649784 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:55:54.650256 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:55:54.651367 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:55:54.655280 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:55:54.655674 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:55:54.656581 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:55:54.659694 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:55:54.660083 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:55:54.660405 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:55:54.661518 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:55:54.664232 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:55:54.664547 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:55:54.667342 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:55:54.669102 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:55:54.618091 => 2023-04-07 18:55:54.669040
[0m18:55:54.669533 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:55:54.670310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6504b9710>]}
[0m18:55:54.670909 [info ] [Thread-1  ]: 2 of 6 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:55:54.671757 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:55:54.672420 [debug] [Thread-1  ]: Began running node model.my_project.5YCotton
[0m18:55:54.672972 [info ] [Thread-1  ]: 3 of 6 START sql view model dbt.5YCotton ....................................... [RUN]
[0m18:55:54.674103 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCotton'
[0m18:55:54.674625 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCotton
[0m18:55:54.678308 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCotton"
[0m18:55:54.680949 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (compile): 2023-04-07 18:55:54.674898 => 2023-04-07 18:55:54.680746
[0m18:55:54.681637 [debug] [Thread-1  ]: Began executing node model.my_project.5YCotton
[0m18:55:54.688659 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCotton"
[0m18:55:54.689688 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:55:54.690136 [debug] [Thread-1  ]: On model.my_project.5YCotton: BEGIN
[0m18:55:54.690445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:54.702911 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:55:54.703349 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:55:54.703767 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */

  create view "postgres"."dbt"."5YCotton__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Cotton'
  );
[0m18:55:54.707425 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:55:54.711586 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:55:54.712000 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
alter table "postgres"."dbt"."5YCotton__dbt_tmp" rename to "5YCotton"
[0m18:55:54.713019 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:55:54.715329 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m18:55:54.715753 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:55:54.716033 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m18:55:54.717126 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:55:54.720663 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:55:54.721136 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
drop view if exists "postgres"."dbt"."5YCotton__dbt_backup" cascade
[0m18:55:54.722016 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:55:54.723623 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (execute): 2023-04-07 18:55:54.681992 => 2023-04-07 18:55:54.723509
[0m18:55:54.724023 [debug] [Thread-1  ]: On model.my_project.5YCotton: Close
[0m18:55:54.724868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65029c850>]}
[0m18:55:54.725409 [info ] [Thread-1  ]: 3 of 6 OK created sql view model dbt.5YCotton .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:55:54.726124 [debug] [Thread-1  ]: Finished running node model.my_project.5YCotton
[0m18:55:54.727298 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:55:54.728343 [info ] [Thread-1  ]: 4 of 6 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:55:54.729465 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:55:54.730087 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:55:54.734570 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:55:54.736143 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:55:54.730533 => 2023-04-07 18:55:54.736040
[0m18:55:54.736552 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:55:54.743062 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:55:54.744071 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:55:54.744523 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:55:54.744899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:54.757988 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:55:54.758398 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:55:54.758745 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:55:54.762262 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:55:54.766245 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:55:54.766762 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:55:54.767961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:55:54.770380 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:55:54.770965 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:55:54.771348 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:55:54.774030 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:55:54.778267 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:55:54.778720 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:55:54.779524 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:55:54.781351 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:55:54.736816 => 2023-04-07 18:55:54.781227
[0m18:55:54.781919 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:55:54.783219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff650511490>]}
[0m18:55:54.784267 [info ] [Thread-1  ]: 4 of 6 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:55:54.785051 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:55:54.785662 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:55:54.786405 [info ] [Thread-1  ]: 5 of 6 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:55:54.787633 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:55:54.788379 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:55:54.791921 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:55:54.793578 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:55:54.788892 => 2023-04-07 18:55:54.793462
[0m18:55:54.794199 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:55:54.801105 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:55:54.801990 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:55:54.802405 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:55:54.802745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:54.814560 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:55:54.815086 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:55:54.815625 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:55:54.821120 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:55:54.824928 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:55:54.825379 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:55:54.827072 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:55:54.829825 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:55:54.830438 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:55:54.830953 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:55:54.832632 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:55:54.836831 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:55:54.837347 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:55:54.838668 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:55:54.840823 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:55:54.794601 => 2023-04-07 18:55:54.840744
[0m18:55:54.841399 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:55:54.842545 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6504f74d0>]}
[0m18:55:54.843385 [info ] [Thread-1  ]: 5 of 6 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:55:54.844628 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:55:54.845330 [debug] [Thread-1  ]: Began running node model.my_project.CottonvsWheat
[0m18:55:54.846026 [info ] [Thread-1  ]: 6 of 6 START sql view model dbt.CottonvsWheat .................................. [RUN]
[0m18:55:54.847299 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CottonvsWheat'
[0m18:55:54.847825 [debug] [Thread-1  ]: Began compiling node model.my_project.CottonvsWheat
[0m18:55:54.852524 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CottonvsWheat"
[0m18:55:54.853621 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (compile): 2023-04-07 18:55:54.848192 => 2023-04-07 18:55:54.853509
[0m18:55:54.854183 [debug] [Thread-1  ]: Began executing node model.my_project.CottonvsWheat
[0m18:55:54.860876 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CottonvsWheat"
[0m18:55:54.862073 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:55:54.862613 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: BEGIN
[0m18:55:54.862993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:54.883494 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:55:54.883949 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:55:54.884329 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */

  create view "postgres"."dbt"."CottonvsWheat__dbt_tmp" as (
    SELECT 
    CONCAT(DATE_PART('year', c.month), '-', DATE_TRUNC('quarter', c.month)) AS period,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCotton") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    period
ORDER BY 
    period
  );
[0m18:55:54.892126 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:55:54.896500 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:55:54.897230 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
alter table "postgres"."dbt"."CottonvsWheat__dbt_tmp" rename to "CottonvsWheat"
[0m18:55:54.902976 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:55:54.906285 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m18:55:54.906768 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:55:54.907189 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m18:55:54.908499 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:55:54.912145 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:55:54.912652 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
drop view if exists "postgres"."dbt"."CottonvsWheat__dbt_backup" cascade
[0m18:55:54.913425 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:55:54.915140 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (execute): 2023-04-07 18:55:54.854572 => 2023-04-07 18:55:54.915058
[0m18:55:54.915670 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: Close
[0m18:55:54.916760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ac814c0-ec51-4a7a-84a9-4e8080748d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6504f73d0>]}
[0m18:55:54.917464 [info ] [Thread-1  ]: 6 of 6 OK created sql view model dbt.CottonvsWheat ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m18:55:54.918250 [debug] [Thread-1  ]: Finished running node model.my_project.CottonvsWheat
[0m18:55:54.986531 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:54.987030 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:54.987349 [debug] [MainThread]: On master: BEGIN
[0m18:55:54.987637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:54.999817 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:55:55.000252 [debug] [MainThread]: On master: COMMIT
[0m18:55:55.000575 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:55.000959 [debug] [MainThread]: On master: COMMIT
[0m18:55:55.001586 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:55:55.001944 [debug] [MainThread]: On master: Close
[0m18:55:55.002683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:55.003012 [debug] [MainThread]: Connection 'model.my_project.CottonvsWheat' was properly closed.
[0m18:55:55.003337 [info ] [MainThread]: 
[0m18:55:55.003948 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m18:55:55.005410 [debug] [MainThread]: Command end result
[0m18:55:55.015498 [info ] [MainThread]: 
[0m18:55:55.016402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:55.017371 [info ] [MainThread]: 
[0m18:55:55.018131 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:55:55.018984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6504ba050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6504ba110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff650529c50>]}
[0m18:55:55.019456 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:58:34.403211 | 5e63a87f-69ad-45c0-b87f-c19d5c889493 ==============================
[0m18:58:34.403211 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:58:34.405590 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:58:34.405998 [debug] [MainThread]: Tracking: tracking
[0m18:58:34.428146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f8dc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f8dc990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f8dc7d0>]}
[0m18:58:34.443974 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:58:34.525901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:58:34.526834 [debug] [MainThread]: Partial parsing: added file: my_project://models/AverageCottonvsWheatCorr.sql
[0m18:58:34.544693 [debug] [MainThread]: 1699: static parser successfully parsed AverageCottonvsWheatCorr.sql
[0m18:58:34.570926 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:58:34.578785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fae5250>]}
[0m18:58:34.595496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f8bba90>]}
[0m18:58:34.596163 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:58:34.597184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f8bbdd0>]}
[0m18:58:34.599317 [info ] [MainThread]: 
[0m18:58:34.601667 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:34.606887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:58:34.662211 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:58:34.662684 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:58:34.663540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:34.721891 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:58:34.723663 [debug] [ThreadPool]: On list_postgres: Close
[0m18:58:34.725800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:58:34.734079 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:58:34.734558 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:58:34.734933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:34.745404 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:58:34.745837 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:58:34.746169 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:58:34.753033 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m18:58:34.754751 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:58:34.755490 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:58:34.763036 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:34.763481 [debug] [MainThread]: On master: BEGIN
[0m18:58:34.763814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:34.775976 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:58:34.776404 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:34.776742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:58:34.787036 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m18:58:34.789043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fad8a90>]}
[0m18:58:34.789537 [debug] [MainThread]: On master: ROLLBACK
[0m18:58:34.790527 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:34.790932 [debug] [MainThread]: On master: BEGIN
[0m18:58:34.791897 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:58:34.792289 [debug] [MainThread]: On master: COMMIT
[0m18:58:34.792639 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:34.793035 [debug] [MainThread]: On master: COMMIT
[0m18:58:34.793818 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:58:34.794354 [debug] [MainThread]: On master: Close
[0m18:58:34.795264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:34.796241 [info ] [MainThread]: 
[0m18:58:34.799226 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:58:34.799846 [info ] [Thread-1  ]: 1 of 7 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:58:34.800907 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:58:34.801363 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:58:34.803687 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:58:34.806343 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:58:34.801676 => 2023-04-07 18:58:34.806135
[0m18:58:34.806966 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:58:34.868999 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:58:34.869896 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:58:34.870415 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:58:34.871179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:34.884516 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:58:34.884924 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:58:34.885286 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:58:34.892439 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:58:34.900726 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:58:34.901212 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:58:34.902071 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:58:34.906619 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:58:34.907169 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:58:34.908467 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:58:34.935704 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:58:34.936150 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:58:34.936457 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:58:34.937683 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:58:34.944434 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:58:34.944855 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:58:34.949623 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:58:34.951333 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:58:34.807410 => 2023-04-07 18:58:34.951263
[0m18:58:34.951751 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:58:34.952629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fabb610>]}
[0m18:58:34.953323 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.15s]
[0m18:58:34.955206 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:58:34.956033 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:58:34.956602 [info ] [Thread-1  ]: 2 of 7 START sql view model dbt.model1 ......................................... [RUN]
[0m18:58:34.957920 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:58:34.958536 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:58:34.960652 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:58:34.962207 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:58:34.958958 => 2023-04-07 18:58:34.962083
[0m18:58:34.962725 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:58:34.971529 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:58:34.972452 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:58:34.972813 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:58:34.973098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:34.983532 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:58:34.983948 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:58:34.984250 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:58:34.987557 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:58:34.991752 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:58:34.992167 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:58:34.993824 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:58:34.998881 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:58:34.999275 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:58:35.000008 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:58:35.003007 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:58:35.003454 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:58:35.003862 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:58:35.005113 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:58:35.008163 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:58:35.008600 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:58:35.010462 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:58:35.012021 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:58:34.963095 => 2023-04-07 18:58:35.011958
[0m18:58:35.012400 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:58:35.013656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fabd790>]}
[0m18:58:35.014376 [info ] [Thread-1  ]: 2 of 7 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.06s]
[0m18:58:35.015156 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:58:35.015873 [debug] [Thread-1  ]: Began running node model.my_project.5YCotton
[0m18:58:35.016388 [info ] [Thread-1  ]: 3 of 7 START sql view model dbt.5YCotton ....................................... [RUN]
[0m18:58:35.017569 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCotton'
[0m18:58:35.018092 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCotton
[0m18:58:35.021818 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCotton"
[0m18:58:35.023490 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (compile): 2023-04-07 18:58:35.018446 => 2023-04-07 18:58:35.023322
[0m18:58:35.024113 [debug] [Thread-1  ]: Began executing node model.my_project.5YCotton
[0m18:58:35.031938 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCotton"
[0m18:58:35.032870 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:58:35.033403 [debug] [Thread-1  ]: On model.my_project.5YCotton: BEGIN
[0m18:58:35.033861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:35.043880 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:58:35.044461 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:58:35.044909 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */

  create view "postgres"."dbt"."5YCotton__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Cotton'
  );
[0m18:58:35.049179 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:58:35.053416 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:58:35.053813 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
alter table "postgres"."dbt"."5YCotton__dbt_tmp" rename to "5YCotton"
[0m18:58:35.054571 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:58:35.056793 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m18:58:35.057186 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:58:35.057502 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m18:58:35.058448 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:58:35.061411 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:58:35.061809 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
drop view if exists "postgres"."dbt"."5YCotton__dbt_backup" cascade
[0m18:58:35.062526 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:58:35.064394 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (execute): 2023-04-07 18:58:35.024518 => 2023-04-07 18:58:35.064324
[0m18:58:35.064832 [debug] [Thread-1  ]: On model.my_project.5YCotton: Close
[0m18:58:35.065645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fcd9f10>]}
[0m18:58:35.066216 [info ] [Thread-1  ]: 3 of 7 OK created sql view model dbt.5YCotton .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:58:35.066844 [debug] [Thread-1  ]: Finished running node model.my_project.5YCotton
[0m18:58:35.067324 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:58:35.067955 [info ] [Thread-1  ]: 4 of 7 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:58:35.068981 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:58:35.069465 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:58:35.073368 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:58:35.075383 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:58:35.069792 => 2023-04-07 18:58:35.075256
[0m18:58:35.075880 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:58:35.082936 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:58:35.083890 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:58:35.084290 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:58:35.084634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:35.094635 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:58:35.095091 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:58:35.095477 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:58:35.099352 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:58:35.104973 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:58:35.105450 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:58:35.106574 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:58:35.109055 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:58:35.109454 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:58:35.109763 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:58:35.110713 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:58:35.114067 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:58:35.114479 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:58:35.115111 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:58:35.116659 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:58:35.076243 => 2023-04-07 18:58:35.116596
[0m18:58:35.117071 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:58:35.118037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fae1ad0>]}
[0m18:58:35.118762 [info ] [Thread-1  ]: 4 of 7 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:58:35.119686 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:58:35.120424 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:58:35.121051 [info ] [Thread-1  ]: 5 of 7 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:58:35.122193 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:58:35.122725 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:58:35.126586 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:58:35.128199 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:58:35.123105 => 2023-04-07 18:58:35.128056
[0m18:58:35.128857 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:58:35.136708 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:58:35.137774 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:58:35.138301 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:58:35.138864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:35.150927 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:58:35.151438 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:58:35.152352 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:58:35.158634 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:58:35.163759 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:58:35.164200 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:58:35.165534 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:58:35.168606 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:58:35.169041 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:58:35.169393 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:58:35.170237 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:58:35.173902 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:58:35.174452 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:58:35.175633 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:58:35.177314 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:58:35.129526 => 2023-04-07 18:58:35.177245
[0m18:58:35.177757 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:58:35.178692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60f8f7850>]}
[0m18:58:35.179384 [info ] [Thread-1  ]: 5 of 7 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:58:35.180128 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:58:35.180689 [debug] [Thread-1  ]: Began running node model.my_project.CottonvsWheat
[0m18:58:35.181363 [info ] [Thread-1  ]: 6 of 7 START sql view model dbt.CottonvsWheat .................................. [RUN]
[0m18:58:35.182568 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CottonvsWheat'
[0m18:58:35.183038 [debug] [Thread-1  ]: Began compiling node model.my_project.CottonvsWheat
[0m18:58:35.186752 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CottonvsWheat"
[0m18:58:35.187648 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (compile): 2023-04-07 18:58:35.183342 => 2023-04-07 18:58:35.187532
[0m18:58:35.188111 [debug] [Thread-1  ]: Began executing node model.my_project.CottonvsWheat
[0m18:58:35.195593 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CottonvsWheat"
[0m18:58:35.196511 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:58:35.196908 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: BEGIN
[0m18:58:35.197304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:35.207411 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:58:35.207923 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:58:35.208360 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */

  create view "postgres"."dbt"."CottonvsWheat__dbt_tmp" as (
    SELECT 
    CONCAT(DATE_PART('year', c.month), '-', DATE_TRUNC('quarter', c.month)) AS period,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCotton") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    period
ORDER BY 
    period
  );
[0m18:58:35.214379 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:58:35.218693 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:58:35.219190 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
alter table "postgres"."dbt"."CottonvsWheat__dbt_tmp" rename to "CottonvsWheat"
[0m18:58:35.220199 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:58:35.222709 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m18:58:35.223133 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:58:35.223446 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m18:58:35.224669 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:58:35.227855 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:58:35.228358 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
drop view if exists "postgres"."dbt"."CottonvsWheat__dbt_backup" cascade
[0m18:58:35.229306 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:58:35.230997 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (execute): 2023-04-07 18:58:35.188402 => 2023-04-07 18:58:35.230927
[0m18:58:35.231435 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: Close
[0m18:58:35.232254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fac76d0>]}
[0m18:58:35.232971 [info ] [Thread-1  ]: 6 of 7 OK created sql view model dbt.CottonvsWheat ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:58:35.233779 [debug] [Thread-1  ]: Finished running node model.my_project.CottonvsWheat
[0m18:58:35.234654 [debug] [Thread-1  ]: Began running node model.my_project.AverageCottonvsWheatCorr
[0m18:58:35.235230 [info ] [Thread-1  ]: 7 of 7 START sql view model dbt.AverageCottonvsWheatCorr ....................... [RUN]
[0m18:58:35.238385 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.AverageCottonvsWheatCorr'
[0m18:58:35.239141 [debug] [Thread-1  ]: Began compiling node model.my_project.AverageCottonvsWheatCorr
[0m18:58:35.242954 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.AverageCottonvsWheatCorr"
[0m18:58:35.243875 [debug] [Thread-1  ]: Timing info for model.my_project.AverageCottonvsWheatCorr (compile): 2023-04-07 18:58:35.239616 => 2023-04-07 18:58:35.243748
[0m18:58:35.244945 [debug] [Thread-1  ]: Began executing node model.my_project.AverageCottonvsWheatCorr
[0m18:58:35.252695 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.AverageCottonvsWheatCorr"
[0m18:58:35.254077 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m18:58:35.254904 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: BEGIN
[0m18:58:35.255368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:58:35.266066 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:58:35.266584 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m18:58:35.267073 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.AverageCottonvsWheatCorr"} */

  create view "postgres"."dbt"."AverageCottonvsWheatCorr__dbt_tmp" as (
    SELECT AVG(CORR(c.price, w.price)) AS avg_correlation
FROM "postgres"."dbt"."CottonvsWheat"
  );
[0m18:58:35.268541 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "c"
LINE 4:     SELECT AVG(CORR(c.price, w.price)) AS avg_correlation
                            ^

[0m18:58:35.269168 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: ROLLBACK
[0m18:58:35.270266 [debug] [Thread-1  ]: Timing info for model.my_project.AverageCottonvsWheatCorr (execute): 2023-04-07 18:58:35.245568 => 2023-04-07 18:58:35.270132
[0m18:58:35.270891 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: Close
[0m18:58:35.282198 [debug] [Thread-1  ]: Database Error in model AverageCottonvsWheatCorr (models/AverageCottonvsWheatCorr.sql)
  missing FROM-clause entry for table "c"
  LINE 4:     SELECT AVG(CORR(c.price, w.price)) AS avg_correlation
                              ^
  compiled Code at target/run/my_project/models/AverageCottonvsWheatCorr.sql
[0m18:58:35.282855 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e63a87f-69ad-45c0-b87f-c19d5c889493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fccbad0>]}
[0m18:58:35.283548 [error] [Thread-1  ]: 7 of 7 ERROR creating sql view model dbt.AverageCottonvsWheatCorr .............. [[31mERROR[0m in 0.05s]
[0m18:58:35.284272 [debug] [Thread-1  ]: Finished running node model.my_project.AverageCottonvsWheatCorr
[0m18:58:35.313330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:58:35.313890 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:35.314309 [debug] [MainThread]: On master: BEGIN
[0m18:58:35.314667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:35.324486 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:58:35.325134 [debug] [MainThread]: On master: COMMIT
[0m18:58:35.325636 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:35.326013 [debug] [MainThread]: On master: COMMIT
[0m18:58:35.326843 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:58:35.327336 [debug] [MainThread]: On master: Close
[0m18:58:35.328236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:35.328596 [debug] [MainThread]: Connection 'model.my_project.AverageCottonvsWheatCorr' was properly closed.
[0m18:58:35.328979 [info ] [MainThread]: 
[0m18:58:35.330065 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m18:58:35.331267 [debug] [MainThread]: Command end result
[0m18:58:35.339932 [info ] [MainThread]: 
[0m18:58:35.340630 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:58:35.341266 [info ] [MainThread]: 
[0m18:58:35.342194 [error] [MainThread]: [33mDatabase Error in model AverageCottonvsWheatCorr (models/AverageCottonvsWheatCorr.sql)[0m
[0m18:58:35.343093 [error] [MainThread]:   missing FROM-clause entry for table "c"
[0m18:58:35.343953 [error] [MainThread]:   LINE 4:     SELECT AVG(CORR(c.price, w.price)) AS avg_correlation
[0m18:58:35.344603 [error] [MainThread]:                               ^
[0m18:58:35.345371 [error] [MainThread]:   compiled Code at target/run/my_project/models/AverageCottonvsWheatCorr.sql
[0m18:58:35.346218 [info ] [MainThread]: 
[0m18:58:35.347124 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:58:35.348167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60ce5aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fabd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60fcd3910>]}
[0m18:58:35.348753 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 18:59:50.481384 | e8463e0d-2cd8-48fb-bce2-d5e532d34b89 ==============================
[0m18:59:50.481384 [info ] [MainThread]: Running with dbt=1.4.5
[0m18:59:50.484467 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:59:50.485001 [debug] [MainThread]: Tracking: tracking
[0m18:59:50.503925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df4fd5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df4fd5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df4fd57d0>]}
[0m18:59:50.520682 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m18:59:50.591332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:59:50.592015 [debug] [MainThread]: Partial parsing: updated file: my_project://models/AverageCottonvsWheatCorr.sql
[0m18:59:50.610667 [debug] [MainThread]: 1699: static parser successfully parsed AverageCottonvsWheatCorr.sql
[0m18:59:50.633538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m18:59:50.641332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df52db210>]}
[0m18:59:50.651132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df524fd10>]}
[0m18:59:50.651801 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:59:50.652714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df4fa51d0>]}
[0m18:59:50.655241 [info ] [MainThread]: 
[0m18:59:50.657282 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:59:50.658999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:59:50.676385 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:59:50.676850 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:59:50.677212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:50.722720 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:59:50.724716 [debug] [ThreadPool]: On list_postgres: Close
[0m18:59:50.726939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m18:59:50.734064 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:59:50.734486 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m18:59:50.734830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:50.743592 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:59:50.744061 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m18:59:50.744421 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m18:59:50.748057 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m18:59:50.749698 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m18:59:50.750293 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m18:59:50.757703 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:50.758113 [debug] [MainThread]: On master: BEGIN
[0m18:59:50.758412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:50.767899 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:59:50.768379 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:50.768696 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:59:50.775225 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m18:59:50.777405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df5114a50>]}
[0m18:59:50.777877 [debug] [MainThread]: On master: ROLLBACK
[0m18:59:50.778444 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:50.778751 [debug] [MainThread]: On master: BEGIN
[0m18:59:50.779405 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:59:50.779770 [debug] [MainThread]: On master: COMMIT
[0m18:59:50.780078 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:50.780350 [debug] [MainThread]: On master: COMMIT
[0m18:59:50.780864 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:59:50.781197 [debug] [MainThread]: On master: Close
[0m18:59:50.781950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:59:50.782506 [info ] [MainThread]: 
[0m18:59:50.785667 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m18:59:50.786293 [info ] [Thread-1  ]: 1 of 7 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m18:59:50.787334 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m18:59:50.787852 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m18:59:50.790111 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m18:59:50.791037 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 18:59:50.788213 => 2023-04-07 18:59:50.790911
[0m18:59:50.791599 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m18:59:50.846286 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m18:59:50.847142 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:59:50.847561 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m18:59:50.847887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:50.856927 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:59:50.857414 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:59:50.857786 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m18:59:50.861554 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:59:50.870423 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:59:50.870911 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m18:59:50.871984 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:59:50.875382 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:59:50.875715 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m18:59:50.876459 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:59:50.905214 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:59:50.905737 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:59:50.906251 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m18:59:50.907686 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:59:50.915858 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m18:59:50.916380 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m18:59:50.920100 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:59:50.922055 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 18:59:50.792114 => 2023-04-07 18:59:50.921936
[0m18:59:50.922670 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m18:59:50.923681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df52d6fd0>]}
[0m18:59:50.924384 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:59:50.926272 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m18:59:50.926809 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m18:59:50.927455 [info ] [Thread-1  ]: 2 of 7 START sql view model dbt.model1 ......................................... [RUN]
[0m18:59:50.928707 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m18:59:50.929211 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m18:59:50.931212 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m18:59:50.931934 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 18:59:50.929468 => 2023-04-07 18:59:50.931855
[0m18:59:50.932383 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m18:59:50.940468 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m18:59:50.941403 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:59:50.941762 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m18:59:50.942030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:50.951466 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:59:50.951895 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:59:50.952378 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m18:59:50.956114 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:59:50.959745 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:59:50.960079 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m18:59:50.960870 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:59:50.964207 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:59:50.964553 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m18:59:50.965491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:59:50.968974 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:59:50.969645 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:59:50.970068 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m18:59:50.971243 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:59:50.974880 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m18:59:50.975269 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m18:59:50.976803 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:59:50.978296 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 18:59:50.932743 => 2023-04-07 18:59:50.978239
[0m18:59:50.978624 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m18:59:50.979549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df54ebc10>]}
[0m18:59:50.980183 [info ] [Thread-1  ]: 2 of 7 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:59:50.980909 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m18:59:50.981567 [debug] [Thread-1  ]: Began running node model.my_project.5YCotton
[0m18:59:50.982003 [info ] [Thread-1  ]: 3 of 7 START sql view model dbt.5YCotton ....................................... [RUN]
[0m18:59:50.982892 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCotton'
[0m18:59:50.983492 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCotton
[0m18:59:50.986675 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCotton"
[0m18:59:50.987414 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (compile): 2023-04-07 18:59:50.983771 => 2023-04-07 18:59:50.987337
[0m18:59:50.987815 [debug] [Thread-1  ]: Began executing node model.my_project.5YCotton
[0m18:59:50.993334 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCotton"
[0m18:59:50.994080 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:59:50.994418 [debug] [Thread-1  ]: On model.my_project.5YCotton: BEGIN
[0m18:59:50.994672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:51.003652 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:59:51.004057 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:59:51.004528 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */

  create view "postgres"."dbt"."5YCotton__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Cotton'
  );
[0m18:59:51.008867 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:59:51.013361 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:59:51.013966 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
alter table "postgres"."dbt"."5YCotton__dbt_tmp" rename to "5YCotton"
[0m18:59:51.014856 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:59:51.018047 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m18:59:51.018649 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:59:51.019064 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m18:59:51.020147 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:59:51.022940 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m18:59:51.023273 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
drop view if exists "postgres"."dbt"."5YCotton__dbt_backup" cascade
[0m18:59:51.024126 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:59:51.025463 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (execute): 2023-04-07 18:59:50.988043 => 2023-04-07 18:59:51.025406
[0m18:59:51.025820 [debug] [Thread-1  ]: On model.my_project.5YCotton: Close
[0m18:59:51.026816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df547e610>]}
[0m18:59:51.027599 [info ] [Thread-1  ]: 3 of 7 OK created sql view model dbt.5YCotton .................................. [[32mCREATE VIEW[0m in 0.04s]
[0m18:59:51.028355 [debug] [Thread-1  ]: Finished running node model.my_project.5YCotton
[0m18:59:51.028949 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m18:59:51.029679 [info ] [Thread-1  ]: 4 of 7 START sql view model dbt.5YWheat ........................................ [RUN]
[0m18:59:51.030971 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m18:59:51.031463 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m18:59:51.035199 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m18:59:51.036044 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 18:59:51.031801 => 2023-04-07 18:59:51.035961
[0m18:59:51.036487 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m18:59:51.044053 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m18:59:51.045066 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:59:51.045496 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m18:59:51.045900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:51.057007 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:59:51.057456 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:59:51.057809 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m18:59:51.060793 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:59:51.066396 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:59:51.066939 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m18:59:51.068209 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:59:51.070692 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:59:51.071087 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:59:51.071371 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m18:59:51.072329 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:59:51.074924 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m18:59:51.075263 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m18:59:51.075876 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:59:51.077133 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 18:59:51.036822 => 2023-04-07 18:59:51.077079
[0m18:59:51.077445 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m18:59:51.078263 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df552cf10>]}
[0m18:59:51.078795 [info ] [Thread-1  ]: 4 of 7 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:59:51.079468 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m18:59:51.080202 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m18:59:51.081093 [info ] [Thread-1  ]: 5 of 7 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m18:59:51.082187 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m18:59:51.082614 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m18:59:51.086533 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m18:59:51.087336 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 18:59:51.082924 => 2023-04-07 18:59:51.087248
[0m18:59:51.087716 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m18:59:51.093158 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m18:59:51.093946 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:59:51.094249 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m18:59:51.094518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:51.104940 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:59:51.105340 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:59:51.105643 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m18:59:51.108945 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:59:51.112482 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:59:51.112868 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m18:59:51.113948 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:59:51.116677 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:59:51.117316 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:59:51.117766 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m18:59:51.120339 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:59:51.123402 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m18:59:51.123776 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m18:59:51.124430 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:59:51.125682 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 18:59:51.087960 => 2023-04-07 18:59:51.125628
[0m18:59:51.125992 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m18:59:51.126796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df51a9590>]}
[0m18:59:51.127302 [info ] [Thread-1  ]: 5 of 7 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m18:59:51.127922 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m18:59:51.128540 [debug] [Thread-1  ]: Began running node model.my_project.CottonvsWheat
[0m18:59:51.128966 [info ] [Thread-1  ]: 6 of 7 START sql view model dbt.CottonvsWheat .................................. [RUN]
[0m18:59:51.130062 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CottonvsWheat'
[0m18:59:51.130593 [debug] [Thread-1  ]: Began compiling node model.my_project.CottonvsWheat
[0m18:59:51.134440 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CottonvsWheat"
[0m18:59:51.136030 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (compile): 2023-04-07 18:59:51.130885 => 2023-04-07 18:59:51.135903
[0m18:59:51.136663 [debug] [Thread-1  ]: Began executing node model.my_project.CottonvsWheat
[0m18:59:51.142379 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CottonvsWheat"
[0m18:59:51.143094 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:59:51.143402 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: BEGIN
[0m18:59:51.143675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:51.154183 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:59:51.154637 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:59:51.155018 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */

  create view "postgres"."dbt"."CottonvsWheat__dbt_tmp" as (
    SELECT 
    CONCAT(DATE_PART('year', c.month), '-', DATE_TRUNC('quarter', c.month)) AS period,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCotton") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    period
ORDER BY 
    period
  );
[0m18:59:51.158646 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m18:59:51.162660 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:59:51.163241 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
alter table "postgres"."dbt"."CottonvsWheat__dbt_tmp" rename to "CottonvsWheat"
[0m18:59:51.164191 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m18:59:51.166803 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m18:59:51.167241 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:59:51.167561 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m18:59:51.168629 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m18:59:51.171766 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m18:59:51.172206 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
drop view if exists "postgres"."dbt"."CottonvsWheat__dbt_backup" cascade
[0m18:59:51.172908 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m18:59:51.174953 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (execute): 2023-04-07 18:59:51.136968 => 2023-04-07 18:59:51.174884
[0m18:59:51.175395 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: Close
[0m18:59:51.176317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df52af310>]}
[0m18:59:51.176980 [info ] [Thread-1  ]: 6 of 7 OK created sql view model dbt.CottonvsWheat ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:59:51.177755 [debug] [Thread-1  ]: Finished running node model.my_project.CottonvsWheat
[0m18:59:51.178644 [debug] [Thread-1  ]: Began running node model.my_project.AverageCottonvsWheatCorr
[0m18:59:51.179160 [info ] [Thread-1  ]: 7 of 7 START sql view model dbt.AverageCottonvsWheatCorr ....................... [RUN]
[0m18:59:51.181810 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.AverageCottonvsWheatCorr'
[0m18:59:51.182374 [debug] [Thread-1  ]: Began compiling node model.my_project.AverageCottonvsWheatCorr
[0m18:59:51.186461 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.AverageCottonvsWheatCorr"
[0m18:59:51.187267 [debug] [Thread-1  ]: Timing info for model.my_project.AverageCottonvsWheatCorr (compile): 2023-04-07 18:59:51.182805 => 2023-04-07 18:59:51.187164
[0m18:59:51.187699 [debug] [Thread-1  ]: Began executing node model.my_project.AverageCottonvsWheatCorr
[0m18:59:51.193821 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.AverageCottonvsWheatCorr"
[0m18:59:51.194686 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m18:59:51.195056 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: BEGIN
[0m18:59:51.195364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:59:51.208987 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m18:59:51.209475 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m18:59:51.209851 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.AverageCottonvsWheatCorr"} */

  create view "postgres"."dbt"."AverageCottonvsWheatCorr__dbt_tmp" as (
    SELECT AVG() AS avg_correlation
FROM "postgres"."dbt"."CottonvsWheat"
  );
[0m18:59:51.212891 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function avg() does not exist
LINE 4:     SELECT AVG() AS avg_correlation
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m18:59:51.213472 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: ROLLBACK
[0m18:59:51.214403 [debug] [Thread-1  ]: Timing info for model.my_project.AverageCottonvsWheatCorr (execute): 2023-04-07 18:59:51.188014 => 2023-04-07 18:59:51.214286
[0m18:59:51.214906 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: Close
[0m18:59:51.225866 [debug] [Thread-1  ]: Database Error in model AverageCottonvsWheatCorr (models/AverageCottonvsWheatCorr.sql)
  function avg() does not exist
  LINE 4:     SELECT AVG() AS avg_correlation
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/my_project/models/AverageCottonvsWheatCorr.sql
[0m18:59:51.226474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8463e0d-2cd8-48fb-bce2-d5e532d34b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df54d3890>]}
[0m18:59:51.227127 [error] [Thread-1  ]: 7 of 7 ERROR creating sql view model dbt.AverageCottonvsWheatCorr .............. [[31mERROR[0m in 0.05s]
[0m18:59:51.227832 [debug] [Thread-1  ]: Finished running node model.my_project.AverageCottonvsWheatCorr
[0m18:59:51.308238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:59:51.308714 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:51.309044 [debug] [MainThread]: On master: BEGIN
[0m18:59:51.309367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:51.318498 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:59:51.319135 [debug] [MainThread]: On master: COMMIT
[0m18:59:51.319593 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:51.319894 [debug] [MainThread]: On master: COMMIT
[0m18:59:51.320432 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:59:51.320947 [debug] [MainThread]: On master: Close
[0m18:59:51.321697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:51.322053 [debug] [MainThread]: Connection 'model.my_project.AverageCottonvsWheatCorr' was properly closed.
[0m18:59:51.322422 [info ] [MainThread]: 
[0m18:59:51.323131 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m18:59:51.324475 [debug] [MainThread]: Command end result
[0m18:59:51.333355 [info ] [MainThread]: 
[0m18:59:51.334224 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:59:51.334957 [info ] [MainThread]: 
[0m18:59:51.335813 [error] [MainThread]: [33mDatabase Error in model AverageCottonvsWheatCorr (models/AverageCottonvsWheatCorr.sql)[0m
[0m18:59:51.336454 [error] [MainThread]:   function avg() does not exist
[0m18:59:51.336966 [error] [MainThread]:   LINE 4:     SELECT AVG() AS avg_correlation
[0m18:59:51.337526 [error] [MainThread]:                      ^
[0m18:59:51.338053 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m18:59:51.338691 [error] [MainThread]:   compiled Code at target/run/my_project/models/AverageCottonvsWheatCorr.sql
[0m18:59:51.339288 [info ] [MainThread]: 
[0m18:59:51.339888 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:59:51.340732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df54d7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df5107fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df4fb9e50>]}
[0m18:59:51.341227 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:00:20.421554 | 52d552d0-98ef-49cd-b6e6-b7f61ac83059 ==============================
[0m19:00:20.421554 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:00:20.424401 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:00:20.424821 [debug] [MainThread]: Tracking: tracking
[0m19:00:20.445271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ae80b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ae80b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ae80ba10>]}
[0m19:00:20.460941 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:00:20.530492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:20.531204 [debug] [MainThread]: Partial parsing: updated file: my_project://models/AverageCottonvsWheatCorr.sql
[0m19:00:20.552552 [debug] [MainThread]: 1699: static parser successfully parsed AverageCottonvsWheatCorr.sql
[0m19:00:20.574483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:00:20.582184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ae859850>]}
[0m19:00:20.590816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ae7e5950>]}
[0m19:00:20.591347 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:00:20.591863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ae7e5bd0>]}
[0m19:00:20.593613 [info ] [MainThread]: 
[0m19:00:20.595501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:20.597871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:00:20.613918 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:00:20.614756 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:00:20.615289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:20.671646 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m19:00:20.673705 [debug] [ThreadPool]: On list_postgres: Close
[0m19:00:20.675981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m19:00:20.684009 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m19:00:20.684493 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m19:00:20.684872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:20.694698 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:00:20.695132 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m19:00:20.695447 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m19:00:20.699078 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m19:00:20.700754 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m19:00:20.701355 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m19:00:20.708418 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:20.708888 [debug] [MainThread]: On master: BEGIN
[0m19:00:20.709203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:20.718760 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:00:20.719234 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:20.719540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:20.726010 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m19:00:20.728041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aeb5cf90>]}
[0m19:00:20.728508 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:20.729094 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:20.729405 [debug] [MainThread]: On master: BEGIN
[0m19:00:20.730021 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:00:20.730371 [debug] [MainThread]: On master: COMMIT
[0m19:00:20.730682 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:20.731010 [debug] [MainThread]: On master: COMMIT
[0m19:00:20.731438 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:00:20.731751 [debug] [MainThread]: On master: Close
[0m19:00:20.732457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:20.733004 [info ] [MainThread]: 
[0m19:00:20.736300 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m19:00:20.736965 [info ] [Thread-1  ]: 1 of 7 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m19:00:20.738062 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m19:00:20.738757 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m19:00:20.741099 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m19:00:20.742491 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 19:00:20.739095 => 2023-04-07 19:00:20.742351
[0m19:00:20.743052 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m19:00:20.793133 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m19:00:20.794199 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:00:20.794588 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m19:00:20.794859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:20.803414 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:00:20.803803 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:00:20.804086 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m19:00:20.806960 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:00:20.814039 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:00:20.814471 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m19:00:20.815407 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:00:20.819442 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:00:20.820007 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m19:00:20.820986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:00:20.844423 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m19:00:20.844895 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:00:20.845236 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m19:00:20.846354 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:00:20.852360 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:00:20.852760 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m19:00:20.855249 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:00:20.857040 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 19:00:20.743487 => 2023-04-07 19:00:20.856981
[0m19:00:20.857460 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m19:00:20.858315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aeb23750>]}
[0m19:00:20.858949 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m19:00:20.860682 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m19:00:20.861294 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m19:00:20.861811 [info ] [Thread-1  ]: 2 of 7 START sql view model dbt.model1 ......................................... [RUN]
[0m19:00:20.862881 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m19:00:20.863524 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m19:00:20.866069 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m19:00:20.867002 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 19:00:20.864166 => 2023-04-07 19:00:20.866883
[0m19:00:20.867659 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m19:00:20.875572 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m19:00:20.876484 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:00:20.876807 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m19:00:20.877071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:20.887416 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:00:20.887826 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:00:20.888230 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m19:00:20.890861 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:00:20.894732 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:00:20.895143 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m19:00:20.896086 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:00:20.900474 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:00:20.900991 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m19:00:20.901693 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:00:20.904416 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m19:00:20.904767 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:00:20.905043 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m19:00:20.906149 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:00:20.909056 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:00:20.909452 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m19:00:20.911363 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:00:20.912791 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 19:00:20.868129 => 2023-04-07 19:00:20.912738
[0m19:00:20.913182 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m19:00:20.914032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aecaf4d0>]}
[0m19:00:20.914660 [info ] [Thread-1  ]: 2 of 7 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m19:00:20.915334 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m19:00:20.915974 [debug] [Thread-1  ]: Began running node model.my_project.5YCotton
[0m19:00:20.916467 [info ] [Thread-1  ]: 3 of 7 START sql view model dbt.5YCotton ....................................... [RUN]
[0m19:00:20.917391 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCotton'
[0m19:00:20.918018 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCotton
[0m19:00:20.921625 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCotton"
[0m19:00:20.922587 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (compile): 2023-04-07 19:00:20.918363 => 2023-04-07 19:00:20.922459
[0m19:00:20.923145 [debug] [Thread-1  ]: Began executing node model.my_project.5YCotton
[0m19:00:20.929764 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCotton"
[0m19:00:20.930771 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:00:20.931227 [debug] [Thread-1  ]: On model.my_project.5YCotton: BEGIN
[0m19:00:20.931601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:20.940295 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:00:20.940915 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:00:20.941245 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */

  create view "postgres"."dbt"."5YCotton__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Cotton'
  );
[0m19:00:20.943976 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:00:20.947868 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:00:20.948592 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
alter table "postgres"."dbt"."5YCotton__dbt_tmp" rename to "5YCotton"
[0m19:00:20.949733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:00:20.952563 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m19:00:20.952971 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:00:20.953273 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m19:00:20.954637 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:00:20.957822 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:00:20.958216 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
drop view if exists "postgres"."dbt"."5YCotton__dbt_backup" cascade
[0m19:00:20.958923 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:00:20.960298 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (execute): 2023-04-07 19:00:20.923678 => 2023-04-07 19:00:20.960242
[0m19:00:20.960634 [debug] [Thread-1  ]: On model.my_project.5YCotton: Close
[0m19:00:20.961373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aeb5c210>]}
[0m19:00:20.961981 [info ] [Thread-1  ]: 3 of 7 OK created sql view model dbt.5YCotton .................................. [[32mCREATE VIEW[0m in 0.04s]
[0m19:00:20.962647 [debug] [Thread-1  ]: Finished running node model.my_project.5YCotton
[0m19:00:20.963273 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m19:00:20.963944 [info ] [Thread-1  ]: 4 of 7 START sql view model dbt.5YWheat ........................................ [RUN]
[0m19:00:20.965115 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m19:00:20.965587 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m19:00:20.969652 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m19:00:20.970502 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 19:00:20.965887 => 2023-04-07 19:00:20.970406
[0m19:00:20.970894 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m19:00:20.976889 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m19:00:20.977812 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:00:20.978196 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m19:00:20.978508 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:20.988168 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:00:20.988658 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:00:20.988974 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m19:00:20.991566 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:00:20.996333 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:00:20.996902 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m19:00:20.998115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:00:21.001235 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m19:00:21.001646 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:00:21.001941 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m19:00:21.002842 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:00:21.005789 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:00:21.006137 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m19:00:21.006868 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:00:21.008207 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 19:00:20.971153 => 2023-04-07 19:00:21.008156
[0m19:00:21.008523 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m19:00:21.009254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aed6d250>]}
[0m19:00:21.009816 [info ] [Thread-1  ]: 4 of 7 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m19:00:21.010453 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m19:00:21.010990 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m19:00:21.011420 [info ] [Thread-1  ]: 5 of 7 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m19:00:21.012603 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m19:00:21.013067 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m19:00:21.017204 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m19:00:21.018158 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 19:00:21.013484 => 2023-04-07 19:00:21.018052
[0m19:00:21.018579 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m19:00:21.024090 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m19:00:21.024850 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:00:21.025157 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m19:00:21.025421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:21.035438 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:00:21.035877 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:00:21.036193 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m19:00:21.038893 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:00:21.042286 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:00:21.042621 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m19:00:21.043507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:00:21.045746 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m19:00:21.046061 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:00:21.046366 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m19:00:21.047607 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:00:21.051385 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:00:21.051895 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m19:00:21.052928 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:00:21.054449 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 19:00:21.018841 => 2023-04-07 19:00:21.054392
[0m19:00:21.054844 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m19:00:21.055865 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ae8be3d0>]}
[0m19:00:21.056469 [info ] [Thread-1  ]: 5 of 7 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m19:00:21.057130 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m19:00:21.057753 [debug] [Thread-1  ]: Began running node model.my_project.AverageCottonvsWheatCorr
[0m19:00:21.058170 [info ] [Thread-1  ]: 6 of 7 START sql view model dbt.AverageCottonvsWheatCorr ....................... [RUN]
[0m19:00:21.059276 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.AverageCottonvsWheatCorr'
[0m19:00:21.059987 [debug] [Thread-1  ]: Began compiling node model.my_project.AverageCottonvsWheatCorr
[0m19:00:21.063796 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.AverageCottonvsWheatCorr"
[0m19:00:21.064954 [debug] [Thread-1  ]: Timing info for model.my_project.AverageCottonvsWheatCorr (compile): 2023-04-07 19:00:21.060322 => 2023-04-07 19:00:21.064792
[0m19:00:21.065539 [debug] [Thread-1  ]: Began executing node model.my_project.AverageCottonvsWheatCorr
[0m19:00:21.071810 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.AverageCottonvsWheatCorr"
[0m19:00:21.072745 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m19:00:21.073120 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: BEGIN
[0m19:00:21.073388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:21.082923 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:00:21.083372 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m19:00:21.083754 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.AverageCottonvsWheatCorr"} */

  create view "postgres"."dbt"."AverageCottonvsWheatCorr__dbt_tmp" as (
    SELECT 
    DATE_PART('year', c.month) AS year,
    AVG(CORR(c.price, w.price)) AS avg_correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCotton") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    DATE_PART('year', c.month)
ORDER BY 
    year
  );
[0m19:00:21.086364 [debug] [Thread-1  ]: Postgres adapter: Postgres error: aggregate function calls cannot be nested
LINE 6:     AVG(CORR(c.price, w.price)) AS avg_correlation
                ^

[0m19:00:21.086852 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: ROLLBACK
[0m19:00:21.087645 [debug] [Thread-1  ]: Timing info for model.my_project.AverageCottonvsWheatCorr (execute): 2023-04-07 19:00:21.066123 => 2023-04-07 19:00:21.087567
[0m19:00:21.088064 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: Close
[0m19:00:21.099211 [debug] [Thread-1  ]: Database Error in model AverageCottonvsWheatCorr (models/AverageCottonvsWheatCorr.sql)
  aggregate function calls cannot be nested
  LINE 6:     AVG(CORR(c.price, w.price)) AS avg_correlation
                  ^
  compiled Code at target/run/my_project/models/AverageCottonvsWheatCorr.sql
[0m19:00:21.099841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ae8be3d0>]}
[0m19:00:21.100499 [error] [Thread-1  ]: 6 of 7 ERROR creating sql view model dbt.AverageCottonvsWheatCorr .............. [[31mERROR[0m in 0.04s]
[0m19:00:21.101087 [debug] [Thread-1  ]: Finished running node model.my_project.AverageCottonvsWheatCorr
[0m19:00:21.101570 [debug] [Thread-1  ]: Began running node model.my_project.CottonvsWheat
[0m19:00:21.102117 [info ] [Thread-1  ]: 7 of 7 START sql view model dbt.CottonvsWheat .................................. [RUN]
[0m19:00:21.103337 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CottonvsWheat'
[0m19:00:21.103880 [debug] [Thread-1  ]: Began compiling node model.my_project.CottonvsWheat
[0m19:00:21.108568 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CottonvsWheat"
[0m19:00:21.109343 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (compile): 2023-04-07 19:00:21.104209 => 2023-04-07 19:00:21.109256
[0m19:00:21.109785 [debug] [Thread-1  ]: Began executing node model.my_project.CottonvsWheat
[0m19:00:21.118526 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CottonvsWheat"
[0m19:00:21.119478 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:00:21.119899 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: BEGIN
[0m19:00:21.120364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:00:21.129645 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:00:21.130190 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:00:21.130642 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */

  create view "postgres"."dbt"."CottonvsWheat__dbt_tmp" as (
    SELECT 
    CONCAT(DATE_PART('year', c.month), '-', DATE_TRUNC('quarter', c.month)) AS period,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCotton") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    period
ORDER BY 
    period
  );
[0m19:00:21.135613 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:00:21.139500 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:00:21.139898 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
alter table "postgres"."dbt"."CottonvsWheat__dbt_tmp" rename to "CottonvsWheat"
[0m19:00:21.140818 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:00:21.143273 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m19:00:21.143709 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:00:21.144042 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m19:00:21.145058 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:00:21.148517 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:00:21.148947 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
drop view if exists "postgres"."dbt"."CottonvsWheat__dbt_backup" cascade
[0m19:00:21.149686 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:00:21.151270 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (execute): 2023-04-07 19:00:21.110132 => 2023-04-07 19:00:21.151184
[0m19:00:21.151727 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: Close
[0m19:00:21.152655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52d552d0-98ef-49cd-b6e6-b7f61ac83059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aee257d0>]}
[0m19:00:21.153350 [info ] [Thread-1  ]: 7 of 7 OK created sql view model dbt.CottonvsWheat ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m19:00:21.154152 [debug] [Thread-1  ]: Finished running node model.my_project.CottonvsWheat
[0m19:00:21.157483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:21.158051 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:21.158641 [debug] [MainThread]: On master: BEGIN
[0m19:00:21.159297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:21.170227 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:00:21.170774 [debug] [MainThread]: On master: COMMIT
[0m19:00:21.171130 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:21.171441 [debug] [MainThread]: On master: COMMIT
[0m19:00:21.171979 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:00:21.172389 [debug] [MainThread]: On master: Close
[0m19:00:21.173085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:21.173420 [debug] [MainThread]: Connection 'model.my_project.CottonvsWheat' was properly closed.
[0m19:00:21.173803 [info ] [MainThread]: 
[0m19:00:21.174423 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m19:00:21.175458 [debug] [MainThread]: Command end result
[0m19:00:21.183178 [info ] [MainThread]: 
[0m19:00:21.184480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:00:21.185311 [info ] [MainThread]: 
[0m19:00:21.186249 [error] [MainThread]: [33mDatabase Error in model AverageCottonvsWheatCorr (models/AverageCottonvsWheatCorr.sql)[0m
[0m19:00:21.187190 [error] [MainThread]:   aggregate function calls cannot be nested
[0m19:00:21.187966 [error] [MainThread]:   LINE 6:     AVG(CORR(c.price, w.price)) AS avg_correlation
[0m19:00:21.188644 [error] [MainThread]:                   ^
[0m19:00:21.189342 [error] [MainThread]:   compiled Code at target/run/my_project/models/AverageCottonvsWheatCorr.sql
[0m19:00:21.190295 [info ] [MainThread]: 
[0m19:00:21.191009 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m19:00:21.191876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aed674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aec95bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9aeb2f910>]}
[0m19:00:21.192567 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:01:05.142603 | 563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd ==============================
[0m19:01:05.142603 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:01:05.145295 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:01:05.145670 [debug] [MainThread]: Tracking: tracking
[0m19:01:05.165316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc761f97650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc761eba850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc761f97850>]}
[0m19:01:05.181125 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:01:05.257589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:05.258347 [debug] [MainThread]: Partial parsing: updated file: my_project://models/AverageCottonvsWheatCorr.sql
[0m19:01:05.277612 [debug] [MainThread]: 1699: static parser successfully parsed AverageCottonvsWheatCorr.sql
[0m19:01:05.300888 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:01:05.308673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc762007cd0>]}
[0m19:01:05.317953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc761feba90>]}
[0m19:01:05.318721 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:01:05.319498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc761febb90>]}
[0m19:01:05.322106 [info ] [MainThread]: 
[0m19:01:05.324182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:01:05.325912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:01:05.340621 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:01:05.341251 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:01:05.341677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:05.392894 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m19:01:05.394993 [debug] [ThreadPool]: On list_postgres: Close
[0m19:01:05.397938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m19:01:05.406479 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m19:01:05.407015 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m19:01:05.407412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:05.416639 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:01:05.417228 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m19:01:05.417687 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m19:01:05.422101 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m19:01:05.424937 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m19:01:05.425699 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m19:01:05.432725 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:05.433139 [debug] [MainThread]: On master: BEGIN
[0m19:01:05.433443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:05.442877 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:01:05.443292 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:05.443621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:01:05.452307 [debug] [MainThread]: SQL status: SELECT 7 in 0 seconds
[0m19:01:05.454439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7619a5790>]}
[0m19:01:05.455107 [debug] [MainThread]: On master: ROLLBACK
[0m19:01:05.455879 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:05.456417 [debug] [MainThread]: On master: BEGIN
[0m19:01:05.457287 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:01:05.457717 [debug] [MainThread]: On master: COMMIT
[0m19:01:05.458126 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:05.458553 [debug] [MainThread]: On master: COMMIT
[0m19:01:05.459206 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:01:05.459641 [debug] [MainThread]: On master: Close
[0m19:01:05.460512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:05.461144 [info ] [MainThread]: 
[0m19:01:05.463899 [debug] [Thread-1  ]: Began running node model.my_project.5yearmodel
[0m19:01:05.464575 [info ] [Thread-1  ]: 1 of 7 START sql view model dbt.5yearmodel ..................................... [RUN]
[0m19:01:05.465945 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5yearmodel'
[0m19:01:05.466505 [debug] [Thread-1  ]: Began compiling node model.my_project.5yearmodel
[0m19:01:05.468711 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5yearmodel"
[0m19:01:05.469616 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (compile): 2023-04-07 19:01:05.466887 => 2023-04-07 19:01:05.469440
[0m19:01:05.470257 [debug] [Thread-1  ]: Began executing node model.my_project.5yearmodel
[0m19:01:05.524559 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5yearmodel"
[0m19:01:05.525684 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:01:05.526013 [debug] [Thread-1  ]: On model.my_project.5yearmodel: BEGIN
[0m19:01:05.526285 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:05.536075 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:01:05.536491 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:01:05.536779 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */

  create view "postgres"."dbt"."5yearmodel__dbt_tmp" as (
    SELECT * FROM commodities2 WHERE month >= TO_DATE('2018-01-01', 'YYYY-MM-DD')
ORDER BY month DESC
  );
[0m19:01:05.546821 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:01:05.554026 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:01:05.554396 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel" rename to "5yearmodel__dbt_backup"
[0m19:01:05.555141 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.558434 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:01:05.558754 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
alter table "postgres"."dbt"."5yearmodel__dbt_tmp" rename to "5yearmodel"
[0m19:01:05.559532 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.581337 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m19:01:05.581748 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:01:05.582047 [debug] [Thread-1  ]: On model.my_project.5yearmodel: COMMIT
[0m19:01:05.583368 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:01:05.589521 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5yearmodel"
[0m19:01:05.589913 [debug] [Thread-1  ]: On model.my_project.5yearmodel: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5yearmodel"} */
drop view if exists "postgres"."dbt"."5yearmodel__dbt_backup" cascade
[0m19:01:05.592653 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:01:05.594426 [debug] [Thread-1  ]: Timing info for model.my_project.5yearmodel (execute): 2023-04-07 19:01:05.470873 => 2023-04-07 19:01:05.594368
[0m19:01:05.594779 [debug] [Thread-1  ]: On model.my_project.5yearmodel: Close
[0m19:01:05.595763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc762195b10>]}
[0m19:01:05.596348 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dbt.5yearmodel ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m19:01:05.598138 [debug] [Thread-1  ]: Finished running node model.my_project.5yearmodel
[0m19:01:05.598656 [debug] [Thread-1  ]: Began running node model.my_project.model1
[0m19:01:05.599078 [info ] [Thread-1  ]: 2 of 7 START sql view model dbt.model1 ......................................... [RUN]
[0m19:01:05.600353 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.model1'
[0m19:01:05.600819 [debug] [Thread-1  ]: Began compiling node model.my_project.model1
[0m19:01:05.603358 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.model1"
[0m19:01:05.604170 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (compile): 2023-04-07 19:01:05.601198 => 2023-04-07 19:01:05.604085
[0m19:01:05.604689 [debug] [Thread-1  ]: Began executing node model.my_project.model1
[0m19:01:05.612554 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.model1"
[0m19:01:05.613447 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:01:05.613820 [debug] [Thread-1  ]: On model.my_project.model1: BEGIN
[0m19:01:05.614078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:05.623304 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:01:05.623899 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:01:05.624379 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */

  create view "postgres"."dbt"."model1__dbt_tmp" as (
    SELECT * FROM commodities2
  );
[0m19:01:05.627386 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:01:05.631248 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:01:05.631691 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1" rename to "model1__dbt_backup"
[0m19:01:05.632518 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.636207 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:01:05.636724 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
alter table "postgres"."dbt"."model1__dbt_tmp" rename to "model1"
[0m19:01:05.637929 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.641275 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m19:01:05.641693 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:01:05.641985 [debug] [Thread-1  ]: On model.my_project.model1: COMMIT
[0m19:01:05.642899 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:01:05.645561 [debug] [Thread-1  ]: Using postgres connection "model.my_project.model1"
[0m19:01:05.645931 [debug] [Thread-1  ]: On model.my_project.model1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.model1"} */
drop view if exists "postgres"."dbt"."model1__dbt_backup" cascade
[0m19:01:05.647653 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:01:05.649282 [debug] [Thread-1  ]: Timing info for model.my_project.model1 (execute): 2023-04-07 19:01:05.605129 => 2023-04-07 19:01:05.649197
[0m19:01:05.649717 [debug] [Thread-1  ]: On model.my_project.model1: Close
[0m19:01:05.650675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7624573d0>]}
[0m19:01:05.651383 [info ] [Thread-1  ]: 2 of 7 OK created sql view model dbt.model1 .................................... [[32mCREATE VIEW[0m in 0.05s]
[0m19:01:05.652157 [debug] [Thread-1  ]: Finished running node model.my_project.model1
[0m19:01:05.652689 [debug] [Thread-1  ]: Began running node model.my_project.5YCotton
[0m19:01:05.653091 [info ] [Thread-1  ]: 3 of 7 START sql view model dbt.5YCotton ....................................... [RUN]
[0m19:01:05.654233 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YCotton'
[0m19:01:05.654952 [debug] [Thread-1  ]: Began compiling node model.my_project.5YCotton
[0m19:01:05.658538 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YCotton"
[0m19:01:05.659554 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (compile): 2023-04-07 19:01:05.655346 => 2023-04-07 19:01:05.659391
[0m19:01:05.660496 [debug] [Thread-1  ]: Began executing node model.my_project.5YCotton
[0m19:01:05.667807 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YCotton"
[0m19:01:05.668760 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:01:05.669230 [debug] [Thread-1  ]: On model.my_project.5YCotton: BEGIN
[0m19:01:05.669652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:05.679586 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:01:05.679987 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:01:05.680293 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */

  create view "postgres"."dbt"."5YCotton__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Cotton'
  );
[0m19:01:05.682847 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:01:05.687858 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:01:05.688319 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
alter table "postgres"."dbt"."5YCotton__dbt_tmp" rename to "5YCotton"
[0m19:01:05.690173 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.693139 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m19:01:05.693574 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:01:05.693856 [debug] [Thread-1  ]: On model.my_project.5YCotton: COMMIT
[0m19:01:05.695943 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:01:05.698929 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YCotton"
[0m19:01:05.699261 [debug] [Thread-1  ]: On model.my_project.5YCotton: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YCotton"} */
drop view if exists "postgres"."dbt"."5YCotton__dbt_backup" cascade
[0m19:01:05.699891 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:01:05.701921 [debug] [Thread-1  ]: Timing info for model.my_project.5YCotton (execute): 2023-04-07 19:01:05.661133 => 2023-04-07 19:01:05.701831
[0m19:01:05.702296 [debug] [Thread-1  ]: On model.my_project.5YCotton: Close
[0m19:01:05.703281 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc762468110>]}
[0m19:01:05.703890 [info ] [Thread-1  ]: 3 of 7 OK created sql view model dbt.5YCotton .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m19:01:05.704561 [debug] [Thread-1  ]: Finished running node model.my_project.5YCotton
[0m19:01:05.705170 [debug] [Thread-1  ]: Began running node model.my_project.5YWheat
[0m19:01:05.705689 [info ] [Thread-1  ]: 4 of 7 START sql view model dbt.5YWheat ........................................ [RUN]
[0m19:01:05.706826 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5YWheat'
[0m19:01:05.707283 [debug] [Thread-1  ]: Began compiling node model.my_project.5YWheat
[0m19:01:05.711400 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5YWheat"
[0m19:01:05.712327 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (compile): 2023-04-07 19:01:05.707641 => 2023-04-07 19:01:05.712228
[0m19:01:05.712733 [debug] [Thread-1  ]: Began executing node model.my_project.5YWheat
[0m19:01:05.721049 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5YWheat"
[0m19:01:05.722081 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:01:05.722480 [debug] [Thread-1  ]: On model.my_project.5YWheat: BEGIN
[0m19:01:05.722777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:05.731431 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:01:05.731851 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:01:05.732128 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */

  create view "postgres"."dbt"."5YWheat__dbt_tmp" as (
    SELECT month, price FROM "postgres"."dbt"."5yearmodel"
WHERE commodity = 'Corn'
  );
[0m19:01:05.736253 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:01:05.740215 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:01:05.740724 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
alter table "postgres"."dbt"."5YWheat__dbt_tmp" rename to "5YWheat"
[0m19:01:05.741492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.743851 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m19:01:05.744251 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:01:05.744575 [debug] [Thread-1  ]: On model.my_project.5YWheat: COMMIT
[0m19:01:05.745680 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:01:05.749257 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5YWheat"
[0m19:01:05.749767 [debug] [Thread-1  ]: On model.my_project.5YWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5YWheat"} */
drop view if exists "postgres"."dbt"."5YWheat__dbt_backup" cascade
[0m19:01:05.750645 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:01:05.752363 [debug] [Thread-1  ]: Timing info for model.my_project.5YWheat (execute): 2023-04-07 19:01:05.712979 => 2023-04-07 19:01:05.752305
[0m19:01:05.752723 [debug] [Thread-1  ]: On model.my_project.5YWheat: Close
[0m19:01:05.753613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc761f72550>]}
[0m19:01:05.754191 [info ] [Thread-1  ]: 4 of 7 OK created sql view model dbt.5YWheat ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m19:01:05.754897 [debug] [Thread-1  ]: Finished running node model.my_project.5YWheat
[0m19:01:05.755457 [debug] [Thread-1  ]: Began running node model.my_project.5Ycorrelation
[0m19:01:05.755876 [info ] [Thread-1  ]: 5 of 7 START sql view model dbt.5Ycorrelation .................................. [RUN]
[0m19:01:05.756825 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.5Ycorrelation'
[0m19:01:05.757257 [debug] [Thread-1  ]: Began compiling node model.my_project.5Ycorrelation
[0m19:01:05.760644 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.5Ycorrelation"
[0m19:01:05.761914 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (compile): 2023-04-07 19:01:05.757506 => 2023-04-07 19:01:05.761826
[0m19:01:05.762422 [debug] [Thread-1  ]: Began executing node model.my_project.5Ycorrelation
[0m19:01:05.768501 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.5Ycorrelation"
[0m19:01:05.769863 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:01:05.770402 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: BEGIN
[0m19:01:05.770833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:05.779573 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:01:05.780004 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:01:05.780349 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */

  create view "postgres"."dbt"."5Ycorrelation__dbt_tmp" as (
    SELECT corr(CAST(price AS numeric), EXTRACT(epoch FROM month)::numeric) as correlation
FROM "postgres"."dbt"."5yearmodel"

-- https://www.geeksforgeeks.org/sql-query-to-convert-datetime-to-epoch/
-- https://stackoverflow.com/questions/43845138/ms-sql-server-cast-int-to-price-format
  );
[0m19:01:05.783331 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:01:05.787698 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:01:05.788222 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
alter table "postgres"."dbt"."5Ycorrelation__dbt_tmp" rename to "5Ycorrelation"
[0m19:01:05.789173 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.791232 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m19:01:05.791633 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:01:05.791891 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: COMMIT
[0m19:01:05.793114 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:01:05.795913 [debug] [Thread-1  ]: Using postgres connection "model.my_project.5Ycorrelation"
[0m19:01:05.796212 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.5Ycorrelation"} */
drop view if exists "postgres"."dbt"."5Ycorrelation__dbt_backup" cascade
[0m19:01:05.796914 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:01:05.798411 [debug] [Thread-1  ]: Timing info for model.my_project.5Ycorrelation (execute): 2023-04-07 19:01:05.762798 => 2023-04-07 19:01:05.798357
[0m19:01:05.798768 [debug] [Thread-1  ]: On model.my_project.5Ycorrelation: Close
[0m19:01:05.799657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc762315210>]}
[0m19:01:05.800225 [info ] [Thread-1  ]: 5 of 7 OK created sql view model dbt.5Ycorrelation ............................. [[32mCREATE VIEW[0m in 0.04s]
[0m19:01:05.800950 [debug] [Thread-1  ]: Finished running node model.my_project.5Ycorrelation
[0m19:01:05.801594 [debug] [Thread-1  ]: Began running node model.my_project.AverageCottonvsWheatCorr
[0m19:01:05.802071 [info ] [Thread-1  ]: 6 of 7 START sql view model dbt.AverageCottonvsWheatCorr ....................... [RUN]
[0m19:01:05.803009 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.AverageCottonvsWheatCorr'
[0m19:01:05.803480 [debug] [Thread-1  ]: Began compiling node model.my_project.AverageCottonvsWheatCorr
[0m19:01:05.808162 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.AverageCottonvsWheatCorr"
[0m19:01:05.809110 [debug] [Thread-1  ]: Timing info for model.my_project.AverageCottonvsWheatCorr (compile): 2023-04-07 19:01:05.803763 => 2023-04-07 19:01:05.809007
[0m19:01:05.809526 [debug] [Thread-1  ]: Began executing node model.my_project.AverageCottonvsWheatCorr
[0m19:01:05.815794 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.AverageCottonvsWheatCorr"
[0m19:01:05.816629 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m19:01:05.816998 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: BEGIN
[0m19:01:05.817288 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:05.827148 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:01:05.827598 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m19:01:05.827970 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.AverageCottonvsWheatCorr"} */

  create view "postgres"."dbt"."AverageCottonvsWheatCorr__dbt_tmp" as (
    SELECT 
    DATE_PART('year', subquery.month) AS year,
    AVG(subquery.correlation) AS avg_correlation
FROM (
    SELECT 
        DATE_TRUNC('month', c.month) AS month,
        CORR(c.price, w.price) AS correlation
    FROM 
        (SELECT price, month FROM "postgres"."dbt"."5YCotton") AS c 
    JOIN 
        (SELECT price, month FROM "postgres"."dbt"."5YWheat") AS w 
    ON 
        DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
        DATE_PART('month', c.month) = DATE_PART('month', w.month)
    GROUP BY 
        DATE_TRUNC('month', c.month)
) AS subquery
GROUP BY 
    DATE_PART('year', subquery.month)
ORDER BY 
    year
  );
[0m19:01:05.832817 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:01:05.837131 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m19:01:05.837653 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.AverageCottonvsWheatCorr"} */
alter table "postgres"."dbt"."AverageCottonvsWheatCorr__dbt_tmp" rename to "AverageCottonvsWheatCorr"
[0m19:01:05.838636 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.840952 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: COMMIT
[0m19:01:05.841293 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m19:01:05.841565 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: COMMIT
[0m19:01:05.842528 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:01:05.846805 [debug] [Thread-1  ]: Using postgres connection "model.my_project.AverageCottonvsWheatCorr"
[0m19:01:05.847169 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.AverageCottonvsWheatCorr"} */
drop view if exists "postgres"."dbt"."AverageCottonvsWheatCorr__dbt_backup" cascade
[0m19:01:05.847798 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:01:05.849047 [debug] [Thread-1  ]: Timing info for model.my_project.AverageCottonvsWheatCorr (execute): 2023-04-07 19:01:05.809781 => 2023-04-07 19:01:05.848995
[0m19:01:05.849359 [debug] [Thread-1  ]: On model.my_project.AverageCottonvsWheatCorr: Close
[0m19:01:05.850165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76257fd50>]}
[0m19:01:05.850773 [info ] [Thread-1  ]: 6 of 7 OK created sql view model dbt.AverageCottonvsWheatCorr .................. [[32mCREATE VIEW[0m in 0.05s]
[0m19:01:05.851476 [debug] [Thread-1  ]: Finished running node model.my_project.AverageCottonvsWheatCorr
[0m19:01:05.852070 [debug] [Thread-1  ]: Began running node model.my_project.CottonvsWheat
[0m19:01:05.852546 [info ] [Thread-1  ]: 7 of 7 START sql view model dbt.CottonvsWheat .................................. [RUN]
[0m19:01:05.853455 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.my_project.CottonvsWheat'
[0m19:01:05.854065 [debug] [Thread-1  ]: Began compiling node model.my_project.CottonvsWheat
[0m19:01:05.858791 [debug] [Thread-1  ]: Writing injected SQL for node "model.my_project.CottonvsWheat"
[0m19:01:05.859575 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (compile): 2023-04-07 19:01:05.854375 => 2023-04-07 19:01:05.859491
[0m19:01:05.860011 [debug] [Thread-1  ]: Began executing node model.my_project.CottonvsWheat
[0m19:01:05.866169 [debug] [Thread-1  ]: Writing runtime sql for node "model.my_project.CottonvsWheat"
[0m19:01:05.866943 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:01:05.867331 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: BEGIN
[0m19:01:05.867670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:05.876743 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m19:01:05.877198 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:01:05.877592 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */

  create view "postgres"."dbt"."CottonvsWheat__dbt_tmp" as (
    SELECT 
    CONCAT(DATE_PART('year', c.month), '-', DATE_TRUNC('quarter', c.month)) AS period,
    CORR(c.price, w.price) AS correlation
FROM 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YCotton") AS c 
JOIN 
    (SELECT price, DATE_TRUNC('month', month) AS month FROM "postgres"."dbt"."5YWheat") AS w 
ON 
    DATE_PART('year', c.month) = DATE_PART('year', w.month) AND 
    DATE_PART('month', c.month) = DATE_PART('month', w.month)
GROUP BY 
    period
ORDER BY 
    period
  );
[0m19:01:05.881594 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m19:01:05.885737 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:01:05.886381 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
alter table "postgres"."dbt"."CottonvsWheat__dbt_tmp" rename to "CottonvsWheat"
[0m19:01:05.887804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m19:01:05.890454 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m19:01:05.890921 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:01:05.891411 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: COMMIT
[0m19:01:05.892425 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m19:01:05.895382 [debug] [Thread-1  ]: Using postgres connection "model.my_project.CottonvsWheat"
[0m19:01:05.895759 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "node_id": "model.my_project.CottonvsWheat"} */
drop view if exists "postgres"."dbt"."CottonvsWheat__dbt_backup" cascade
[0m19:01:05.896564 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m19:01:05.898169 [debug] [Thread-1  ]: Timing info for model.my_project.CottonvsWheat (execute): 2023-04-07 19:01:05.860294 => 2023-04-07 19:01:05.898105
[0m19:01:05.898563 [debug] [Thread-1  ]: On model.my_project.CottonvsWheat: Close
[0m19:01:05.899494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '563ddc31-0f3e-48ae-b5c7-1d37ecb7bdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc762566d50>]}
[0m19:01:05.900246 [info ] [Thread-1  ]: 7 of 7 OK created sql view model dbt.CottonvsWheat ............................. [[32mCREATE VIEW[0m in 0.05s]
[0m19:01:05.901069 [debug] [Thread-1  ]: Finished running node model.my_project.CottonvsWheat
[0m19:01:05.980915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:01:05.981402 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:05.981691 [debug] [MainThread]: On master: BEGIN
[0m19:01:05.981977 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:05.991540 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:01:05.992051 [debug] [MainThread]: On master: COMMIT
[0m19:01:05.992462 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:05.992801 [debug] [MainThread]: On master: COMMIT
[0m19:01:05.993385 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:01:05.993821 [debug] [MainThread]: On master: Close
[0m19:01:05.994536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:05.994891 [debug] [MainThread]: Connection 'model.my_project.CottonvsWheat' was properly closed.
[0m19:01:05.995297 [info ] [MainThread]: 
[0m19:01:05.995963 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m19:01:05.997324 [debug] [MainThread]: Command end result
[0m19:01:06.005901 [info ] [MainThread]: 
[0m19:01:06.006970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:06.007868 [info ] [MainThread]: 
[0m19:01:06.008819 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:01:06.009909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc762530390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc762181b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76246b150>]}
[0m19:01:06.010513 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:05:35.732206 | 74ef1709-cd8a-4f92-827b-f2ac92b9d8bd ==============================
[0m19:05:35.732206 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:05:35.735855 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:05:35.736309 [debug] [MainThread]: Tracking: tracking
[0m19:05:35.774999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927e91d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927e91d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927e91d690>]}
[0m19:05:35.791072 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:05:35.868262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m19:05:35.868930 [debug] [MainThread]: Partial parsing: added file: my_project://models/AverageCottonvsWheatCorr.yml
[0m19:05:35.869349 [debug] [MainThread]: Partial parsing: updated file: my_project://models/test_commodities.yml
[0m19:05:35.869758 [debug] [MainThread]: Partial parsing: updated file: my_project://models/AverageCottonvsWheatCorr.sql
[0m19:05:35.894653 [debug] [MainThread]: 1699: static parser successfully parsed AverageCottonvsWheatCorr.sql
[0m19:05:35.925547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:05:35.933103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74ef1709-cd8a-4f92-827b-f2ac92b9d8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927e945850>]}
[0m19:05:35.944894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74ef1709-cd8a-4f92-827b-f2ac92b9d8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927e79aa10>]}
[0m19:05:35.945573 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:05:35.946313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ef1709-cd8a-4f92-827b-f2ac92b9d8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927e7cf810>]}
[0m19:05:35.948880 [info ] [MainThread]: 
[0m19:05:35.949780 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:05:35.950384 [debug] [MainThread]: Command end result
[0m19:05:35.958919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927eac7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927eac7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f927eac7210>]}
[0m19:05:35.959388 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:06:19.371924 | 0203fba4-dc7a-45b0-9322-1ed6b0623afc ==============================
[0m19:06:19.371924 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:06:19.374877 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:06:19.375332 [debug] [MainThread]: Tracking: tracking
[0m19:06:19.396957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b2fcd150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b2fcd7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b2fcda50>]}
[0m19:06:19.414881 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:06:19.471800 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m19:06:19.472501 [debug] [MainThread]: Partial parsing: added file: my_project://models/test_AverageCottonvsWheatCorr.yml
[0m19:06:19.485663 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:06:19.494308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0203fba4-dc7a-45b0-9322-1ed6b0623afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b2b3d510>]}
[0m19:06:19.504673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0203fba4-dc7a-45b0-9322-1ed6b0623afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b3151750>]}
[0m19:06:19.505209 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:06:19.505812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0203fba4-dc7a-45b0-9322-1ed6b0623afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b3151410>]}
[0m19:06:19.507602 [info ] [MainThread]: 
[0m19:06:19.508450 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:06:19.509163 [debug] [MainThread]: Command end result
[0m19:06:19.516620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b324ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b2fc2290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b3151a50>]}
[0m19:06:19.517706 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:06:30.082812 | 4a6420b1-1aaf-47ff-8329-140095599d0f ==============================
[0m19:06:30.082812 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:06:30.085104 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:06:30.085548 [debug] [MainThread]: Tracking: tracking
[0m19:06:30.104130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eb8e2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eb8e2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eb8e27d0>]}
[0m19:06:30.118587 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:06:30.133856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eb9dc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eb9e1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eb9c6910>]}
[0m19:06:30.134308 [debug] [MainThread]: Flushing usage events
[0m19:06:30.308135 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_AverageCottonvsWheatCorr.yml - Runtime Error
    Syntax error near line 6
    ------------------------------
    3  | # Test the correlation between cotton and wheat prices by year
    4  | # Ensure that the average correlation is between -1 and 1
    5  | 
    6  | - name: test_cotton_wheat_correlation
    7  |   description: Test the correlation between cotton and wheat prices by year
    8  |   severity: ERROR
    9  |   tags: [cotton, wheat, correlation]
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 6, column 1


============================== 2023-04-07 19:07:26.222157 | b68da859-21f8-49b3-89d4-c34ec31c9e78 ==============================
[0m19:07:26.222157 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:07:26.224840 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:07:26.225298 [debug] [MainThread]: Tracking: tracking
[0m19:07:26.244029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09110b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa090ed5ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa09110b5d0>]}
[0m19:07:26.261393 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:07:26.283952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa091206050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0911f50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0911f5d10>]}
[0m19:07:26.284432 [debug] [MainThread]: Flushing usage events
[0m19:07:26.492868 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_AverageCottonvsWheatCorr.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  | # Test the correlation between cotton and wheat prices by year
    7  | # Ensure that the average correlation is between -1 and 1
    8  | 
    9  | - name: test_cotton_wheat_correlation
    10 |   description: Test the correlation between cotton and wheat prices by year
    11 |   severity: ERROR
    12 |   tags: [cotton, wheat, correlation]
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 9, column 1


============================== 2023-04-07 19:08:33.088924 | f7830941-6a4a-4557-9d33-4b95eef53a06 ==============================
[0m19:08:33.088924 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:08:33.091696 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:08:33.092103 [debug] [MainThread]: Tracking: tracking
[0m19:08:33.111614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9208fdc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9208f795d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9208fdc4d0>]}
[0m19:08:33.127565 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:08:33.149869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92091c68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92091cc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92091b05d0>]}
[0m19:08:33.150363 [debug] [MainThread]: Flushing usage events
[0m19:08:33.394204 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_AverageCottonvsWheatCorr.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | 
    3  | 
    4  | - name: test_cotton_wheat_correlation
    5  |   description: Test the correlation between cotton and wheat prices by year
    6  |   severity: ERROR
    7  |   tags: [cotton, wheat, correlation]
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 4, column 1


============================== 2023-04-07 19:08:58.260746 | 02ccb791-a827-46d2-8e9a-3dee3bddabdf ==============================
[0m19:08:58.260746 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:08:58.263434 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:08:58.263840 [debug] [MainThread]: Tracking: tracking
[0m19:08:58.283091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4686cc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff468668550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4686cc510>]}
[0m19:08:58.297874 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:08:58.312624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4688c6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4688d0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4688b1ad0>]}
[0m19:08:58.313081 [debug] [MainThread]: Flushing usage events
[0m19:08:58.488792 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_AverageCottonvsWheatCorr.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | 
    3  | 
    4  | - name: test_cotton_wheat_correlation
    5  |   description: Test the correlation between cotton and wheat prices by year
    6  |   severity: ERROR
    7  |   tags: [cotton, wheat, correlation]
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 4, column 1


============================== 2023-04-07 19:09:55.872384 | 8db65c08-e09e-4fbd-ab9d-f289837ab7e4 ==============================
[0m19:09:55.872384 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:09:55.875251 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:09:55.875659 [debug] [MainThread]: Tracking: tracking
[0m19:09:55.896285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb576016390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb576016b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5760166d0>]}
[0m19:09:55.911260 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:09:55.976424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:09:55.977136 [debug] [MainThread]: Partial parsing: updated file: my_project://models/test_AverageCottonvsWheatCorr.yml
[0m19:09:55.977652 [debug] [MainThread]: Partial parsing: updated file: my_project://models/test_commodities.yml
[0m19:09:55.992003 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'commodities' in the 'models' section of file 'models/test_commodities.yml'
[0m19:09:56.095219 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.unique_commodities_id.3439e8d9fc' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.096095 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_month.19f23d5543' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.096886 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_month__01_01_2021.4c744c2095' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.097635 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_commodityName.85dad39fda' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.098336 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_commodityName__Corn__Wheat__Rice__Soybeans.1d22aeed5f' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.099607 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_price.b51bd58eed' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.101326 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_price__10_0__20_0__30_0__40_0__50_0__60_0__70_0__80_0__90_0__100_0__110_0__120_0.a40d2114fe' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.102160 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_currency.4fb3ef9271' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.102971 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_currency__USD__CAD__EUR.32efde9753' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.104161 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_commodities_symbol.c2ed5d4843' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.105452 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.accepted_values_commodities_symbol__CO__WH__RI__SB.63bb4bc120' (models/test_commodities.yml) depends on a node named 'commodities' in package '' which was not found
[0m19:09:56.113694 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:09:56.123902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8db65c08-e09e-4fbd-ab9d-f289837ab7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5763f9610>]}
[0m19:09:56.135840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8db65c08-e09e-4fbd-ab9d-f289837ab7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb576014390>]}
[0m19:09:56.136529 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:09:56.137138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db65c08-e09e-4fbd-ab9d-f289837ab7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5760b2290>]}
[0m19:09:56.139180 [info ] [MainThread]: 
[0m19:09:56.140018 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:09:56.140718 [debug] [MainThread]: Command end result
[0m19:09:56.148156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5760560d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5760567d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb576056c90>]}
[0m19:09:56.148734 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:10:09.847816 | 6478c23f-0162-447b-bf3e-a9300e6e6708 ==============================
[0m19:10:09.847816 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:10:09.850436 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:10:09.850856 [debug] [MainThread]: Tracking: tracking
[0m19:10:09.875188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3478dd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3477ba850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3478dd6d0>]}
[0m19:10:09.890395 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:10:09.964006 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m19:10:09.971829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:10:09.983424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6478c23f-0162-447b-bf3e-a9300e6e6708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34792e090>]}
[0m19:10:09.991887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6478c23f-0162-447b-bf3e-a9300e6e6708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd347a00610>]}
[0m19:10:09.992571 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:10:09.993232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6478c23f-0162-447b-bf3e-a9300e6e6708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd347a00450>]}
[0m19:10:09.995013 [info ] [MainThread]: 
[0m19:10:09.996016 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:10:09.996719 [debug] [MainThread]: Command end result
[0m19:10:10.004122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34787ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd347873190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34788e7d0>]}
[0m19:10:10.004615 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:13:06.512862 | a0033d7e-60bb-4bd7-899d-ad3e2e648d34 ==============================
[0m19:13:06.512862 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:13:06.515632 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:13:06.516050 [debug] [MainThread]: Tracking: tracking
[0m19:13:06.534826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb257822850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb254e5f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb257822450>]}
[0m19:13:06.550949 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:13:06.620443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:06.620865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:06.621958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:13:06.632419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0033d7e-60bb-4bd7-899d-ad3e2e648d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2579a85d0>]}
[0m19:13:06.641450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0033d7e-60bb-4bd7-899d-ad3e2e648d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb257895d90>]}
[0m19:13:06.641998 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:13:06.642589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0033d7e-60bb-4bd7-899d-ad3e2e648d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2578955d0>]}
[0m19:13:06.644270 [info ] [MainThread]: 
[0m19:13:06.645259 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:13:06.646041 [debug] [MainThread]: Command end result
[0m19:13:06.653191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2578d0ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2578d0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2578d0210>]}
[0m19:13:06.653796 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:13:19.021532 | 66dfeb63-0b0d-4ce9-b0eb-3ae67ca7c84f ==============================
[0m19:13:19.021532 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:13:19.024126 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:13:19.024667 [debug] [MainThread]: Tracking: tracking
[0m19:13:19.047364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51801d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51801d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51801d950>]}
[0m19:13:19.067357 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:13:19.087277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51823b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe518227e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe518227d90>]}
[0m19:13:19.094585 [debug] [MainThread]: Flushing usage events
[0m19:13:19.262202 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading my_project: test_corn.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  | - name: test_corn_prices
    4  |   description: Test that all prices for corn in the 5 year model are positive
    5  |   severity: WARNING
    6  |   meta:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 3, column 1


============================== 2023-04-07 19:14:45.426406 | 207c9921-33b9-47d3-8f6f-f6877379e370 ==============================
[0m19:14:45.426406 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:14:45.430074 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:14:45.430734 [debug] [MainThread]: Tracking: tracking
[0m19:14:45.451537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3de81b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3de6d5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3de81b4d0>]}
[0m19:14:45.467482 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:14:45.489790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dea2c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dea41190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3dea41a90>]}
[0m19:14:45.490272 [debug] [MainThread]: Flushing usage events
[0m19:14:45.750396 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/test_AverageCottonvsWheatCorr.yml is invalid because a list element for 'models' is not a dictionary


============================== 2023-04-07 19:16:48.396972 | 0ad28159-6da0-4060-9187-64543581c8b2 ==============================
[0m19:16:48.396972 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:16:48.399687 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:16:48.400138 [debug] [MainThread]: Tracking: tracking
[0m19:16:48.421906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8027821590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80278217d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80278216d0>]}
[0m19:16:48.438712 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:16:48.522482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:16:48.523124 [debug] [MainThread]: Partial parsing: added file: my_project://models/test_corn.yml
[0m19:16:48.523569 [debug] [MainThread]: Partial parsing: updated file: my_project://models/test_AverageCottonvsWheatCorr.yml
[0m19:16:48.576481 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:16:48.583795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ad28159-6da0-4060-9187-64543581c8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802786b390>]}
[0m19:16:48.593219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ad28159-6da0-4060-9187-64543581c8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80278b3650>]}
[0m19:16:48.593721 [info ] [MainThread]: Found 7 models, 1 test, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:16:48.594196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ad28159-6da0-4060-9187-64543581c8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80278b3d10>]}
[0m19:16:48.596111 [info ] [MainThread]: 
[0m19:16:48.598543 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:16:48.601024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m19:16:48.615405 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m19:16:48.616151 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m19:16:48.616529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:48.685408 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:16:48.685995 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m19:16:48.686336 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m19:16:48.698971 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m19:16:48.701098 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m19:16:48.701776 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m19:16:48.709159 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:48.709714 [debug] [MainThread]: On master: BEGIN
[0m19:16:48.710046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:48.718762 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:16:48.719275 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:48.719576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:16:48.737112 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m19:16:48.739491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ad28159-6da0-4060-9187-64543581c8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80277fb490>]}
[0m19:16:48.739995 [debug] [MainThread]: On master: ROLLBACK
[0m19:16:48.740632 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:48.740929 [debug] [MainThread]: On master: BEGIN
[0m19:16:48.741652 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:16:48.742005 [debug] [MainThread]: On master: COMMIT
[0m19:16:48.742360 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:48.742657 [debug] [MainThread]: On master: COMMIT
[0m19:16:48.743070 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:16:48.743371 [debug] [MainThread]: On master: Close
[0m19:16:48.744039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:48.744541 [info ] [MainThread]: 
[0m19:16:48.747419 [debug] [Thread-1  ]: Began running node test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f
[0m19:16:48.747944 [info ] [Thread-1  ]: 1 of 1 START test not_between_AverageCottonvsWheatCorr_avg_correlation___1__1 .. [RUN]
[0m19:16:48.749046 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f'
[0m19:16:48.749518 [debug] [Thread-1  ]: Began compiling node test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f
[0m19:16:48.758075 [debug] [Thread-1  ]: Timing info for test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f (compile): 2023-04-07 19:16:48.749851 => 2023-04-07 19:16:48.757951
[0m19:16:48.770341 [debug] [Thread-1  ]: Compilation Error in test not_between_AverageCottonvsWheatCorr_avg_correlation___1__1 (models/test_AverageCottonvsWheatCorr.yml)
  'test_not_between' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:16:48.771048 [error] [Thread-1  ]: 1 of 1 ERROR not_between_AverageCottonvsWheatCorr_avg_correlation___1__1 ....... [[31mERROR[0m in 0.02s]
[0m19:16:48.773057 [debug] [Thread-1  ]: Finished running node test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f
[0m19:16:48.849487 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:16:48.850747 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:48.851593 [debug] [MainThread]: On master: BEGIN
[0m19:16:48.852346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:16:48.869362 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:16:48.870232 [debug] [MainThread]: On master: COMMIT
[0m19:16:48.870838 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:48.871369 [debug] [MainThread]: On master: COMMIT
[0m19:16:48.872100 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:16:48.872720 [debug] [MainThread]: On master: Close
[0m19:16:48.873846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:48.874372 [debug] [MainThread]: Connection 'test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f' was properly closed.
[0m19:16:48.874878 [info ] [MainThread]: 
[0m19:16:48.875958 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m19:16:48.877074 [debug] [MainThread]: Command end result
[0m19:16:48.887163 [info ] [MainThread]: 
[0m19:16:48.888106 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:16:48.888972 [info ] [MainThread]: 
[0m19:16:48.889665 [error] [MainThread]: [33mCompilation Error in test not_between_AverageCottonvsWheatCorr_avg_correlation___1__1 (models/test_AverageCottonvsWheatCorr.yml)[0m
[0m19:16:48.890239 [error] [MainThread]:   'test_not_between' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:16:48.890801 [info ] [MainThread]: 
[0m19:16:48.891555 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:16:48.892458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80276f6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80279c4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8027d3cc10>]}
[0m19:16:48.892968 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:16:58.332616 | 988ad7d5-21dc-4d18-9a69-5e6d002de419 ==============================
[0m19:16:58.332616 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:16:58.334784 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:16:58.335186 [debug] [MainThread]: Tracking: tracking
[0m19:16:58.354698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd827b2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd827b28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd827b2850>]}
[0m19:16:58.369204 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:16:58.400301 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m19:16:58.420202 [debug] [MainThread]: 1699: static parser successfully parsed AverageCottonvsWheatCorr.sql
[0m19:16:58.442547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:16:58.449495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '988ad7d5-21dc-4d18-9a69-5e6d002de419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd82ae7310>]}
[0m19:16:58.458055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '988ad7d5-21dc-4d18-9a69-5e6d002de419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8279f350>]}
[0m19:16:58.458668 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:16:58.459299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '988ad7d5-21dc-4d18-9a69-5e6d002de419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8279fc50>]}
[0m19:16:58.461300 [info ] [MainThread]: 
[0m19:16:58.462557 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:16:58.463411 [debug] [MainThread]: Command end result
[0m19:16:58.470198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd829d5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd80d82590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd82a58190>]}
[0m19:16:58.470711 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:17:30.389400 | 4c24fe74-4af8-41e8-ab0b-9aae0ae0935e ==============================
[0m19:17:30.389400 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:17:30.391554 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:17:30.391913 [debug] [MainThread]: Tracking: tracking
[0m19:17:30.411740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0f81c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0f81c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0f81c810>]}
[0m19:17:30.426852 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:17:30.458621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:17:30.459307 [debug] [MainThread]: Partial parsing: updated file: my_project://models/test_corn.yml
[0m19:17:30.471677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:17:30.480062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c24fe74-4af8-41e8-ab0b-9aae0ae0935e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0faec510>]}
[0m19:17:30.489504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c24fe74-4af8-41e8-ab0b-9aae0ae0935e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0f891f50>]}
[0m19:17:30.490070 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:17:30.490602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c24fe74-4af8-41e8-ab0b-9aae0ae0935e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0f891790>]}
[0m19:17:30.492380 [info ] [MainThread]: 
[0m19:17:30.493297 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:17:30.494120 [debug] [MainThread]: Command end result
[0m19:17:30.501090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0f8beb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0f8bee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0f8be190>]}
[0m19:17:30.501596 [debug] [MainThread]: Flushing usage events


============================== 2023-04-07 19:17:40.888371 | 0f0ea1ac-bf07-4dcf-a854-e0cee586e0ac ==============================
[0m19:17:40.888371 [info ] [MainThread]: Running with dbt=1.4.5
[0m19:17:40.890657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/jonnywerthman/Documents/GitHub/489856-489214-487404/main/my_project', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m19:17:40.891085 [debug] [MainThread]: Tracking: tracking
[0m19:17:40.910304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2087cd690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2087cd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2087cd8d0>]}
[0m19:17:40.925171 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m19:17:40.955949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:17:40.956576 [debug] [MainThread]: Partial parsing: added file: my_project://models/test_AverageCottonvsWheatCorr.yml
[0m19:17:41.005123 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.example
[0m19:17:41.011885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f0ea1ac-bf07-4dcf-a854-e0cee586e0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20832e590>]}
[0m19:17:41.021203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f0ea1ac-bf07-4dcf-a854-e0cee586e0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2089510d0>]}
[0m19:17:41.021808 [info ] [MainThread]: Found 7 models, 1 test, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m19:17:41.022309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0ea1ac-bf07-4dcf-a854-e0cee586e0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2089510d0>]}
[0m19:17:41.024581 [info ] [MainThread]: 
[0m19:17:41.026878 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:41.028883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m19:17:41.044341 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m19:17:41.044907 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m19:17:41.045455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:41.069560 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m19:17:41.069987 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m19:17:41.070312 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m19:17:41.074456 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m19:17:41.076468 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m19:17:41.077282 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m19:17:41.084812 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:41.085219 [debug] [MainThread]: On master: BEGIN
[0m19:17:41.085522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:41.095116 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:17:41.095572 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:41.095874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "my_postgres_db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:41.101542 [debug] [MainThread]: SQL status: SELECT 9 in 0 seconds
[0m19:17:41.104011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0ea1ac-bf07-4dcf-a854-e0cee586e0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe208968650>]}
[0m19:17:41.104594 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:41.105199 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:41.105499 [debug] [MainThread]: On master: BEGIN
[0m19:17:41.106061 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:17:41.106449 [debug] [MainThread]: On master: COMMIT
[0m19:17:41.106748 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:41.107021 [debug] [MainThread]: On master: COMMIT
[0m19:17:41.107487 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:17:41.107844 [debug] [MainThread]: On master: Close
[0m19:17:41.108595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:41.109183 [info ] [MainThread]: 
[0m19:17:41.111583 [debug] [Thread-1  ]: Began running node test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f
[0m19:17:41.112090 [info ] [Thread-1  ]: 1 of 1 START test not_between_AverageCottonvsWheatCorr_avg_correlation___1__1 .. [RUN]
[0m19:17:41.113210 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f'
[0m19:17:41.113723 [debug] [Thread-1  ]: Began compiling node test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f
[0m19:17:41.121591 [debug] [Thread-1  ]: Timing info for test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f (compile): 2023-04-07 19:17:41.114018 => 2023-04-07 19:17:41.121481
[0m19:17:41.124454 [debug] [Thread-1  ]: Compilation Error in test not_between_AverageCottonvsWheatCorr_avg_correlation___1__1 (models/test_AverageCottonvsWheatCorr.yml)
  'test_not_between' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:17:41.125093 [error] [Thread-1  ]: 1 of 1 ERROR not_between_AverageCottonvsWheatCorr_avg_correlation___1__1 ....... [[31mERROR[0m in 0.01s]
[0m19:17:41.126740 [debug] [Thread-1  ]: Finished running node test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f
[0m19:17:41.218311 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:41.219886 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:41.220707 [debug] [MainThread]: On master: BEGIN
[0m19:17:41.221507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:41.238220 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m19:17:41.239063 [debug] [MainThread]: On master: COMMIT
[0m19:17:41.239775 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:41.240289 [debug] [MainThread]: On master: COMMIT
[0m19:17:41.240999 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m19:17:41.241578 [debug] [MainThread]: On master: Close
[0m19:17:41.242686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:41.243198 [debug] [MainThread]: Connection 'test.my_project.not_between_AverageCottonvsWheatCorr_avg_correlation___1__1.7674b10f4f' was properly closed.
[0m19:17:41.243723 [info ] [MainThread]: 
[0m19:17:41.244613 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m19:17:41.245700 [debug] [MainThread]: Command end result
[0m19:17:41.255983 [info ] [MainThread]: 
[0m19:17:41.257046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:17:41.257870 [info ] [MainThread]: 
[0m19:17:41.258754 [error] [MainThread]: [33mCompilation Error in test not_between_AverageCottonvsWheatCorr_avg_correlation___1__1 (models/test_AverageCottonvsWheatCorr.yml)[0m
[0m19:17:41.259384 [error] [MainThread]:   'test_not_between' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:17:41.259962 [info ] [MainThread]: 
[0m19:17:41.260611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:17:41.261519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe208c269d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe208905ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20892e050>]}
[0m19:17:41.262076 [debug] [MainThread]: Flushing usage events
